/**
 * locator - In browser locator map generator
 * @version v0.0.1
 * @link https://github.com/datanews/locator#readme
 * @license MIT
 * @notes External libraries may be bundled here and their respective, original license applies.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Ractive=e()}(this,function(){"use strict";function t(t){var e;if(t&&"boolean"!=typeof t)return"undefined"!=typeof window&&document&&t?t.nodeType?t:"string"==typeof t&&(e=document.getElementById(t),!e&&document.querySelector&&(e=document.querySelector(t)),e&&e.nodeType)?e:t[0]&&t[0].nodeType?t[0]:null:null}function e(t){return t&&"unknown"!=typeof t.parentNode&&t.parentNode&&t.parentNode.removeChild(t),t}function i(t){return null!=t&&t.toString?t:""}function n(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;e>n;n++)i[n-1]=arguments[n];for(var o,r;r=i.shift();)for(o in r)Ca.call(r,o)&&(t[o]=r[o]);return t}function o(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;e>n;n++)i[n-1]=arguments[n];return i.forEach(function(e){for(var i in e)!e.hasOwnProperty(i)||i in t||(t[i]=e[i])}),t}function r(t){return"[object Array]"===Ta.call(t)}function s(t){return Sa.test(Ta.call(t))}function a(t,e){return null===t&&null===e?!0:"object"==typeof t||"object"==typeof e?!1:t===e}function h(t){return!isNaN(parseFloat(t))&&isFinite(t)}function l(t){return t&&"[object Object]"===Ta.call(t)}function u(t,e){return t.replace(/%s/g,function(){return e.shift()})}function c(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;e>n;n++)i[n-1]=arguments[n];throw t=u(t,i),new Error(t)}function d(){Gy.DEBUG&&Ea.apply(null,arguments)}function p(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;e>n;n++)i[n-1]=arguments[n];t=u(t,i),Pa(t,i)}function f(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;e>n;n++)i[n-1]=arguments[n];t=u(t,i),Oa[t]||(Oa[t]=!0,Pa(t,i))}function m(){Gy.DEBUG&&p.apply(null,arguments)}function g(){Gy.DEBUG&&f.apply(null,arguments)}function v(t,e,i){var n=_(t,e,i);return n?n[t][i]:null}function _(t,e,i){for(;e;){if(i in e[t])return e;if(e.isolated)return null;e=e.parent}}function y(t){return function(){return t}}function w(t){var e,i,n,o,r,s;for(e=t.split("."),(i=ja[e.length])||(i=b(e.length)),r=[],n=function(t,i){return t?"*":e[i]},o=i.length;o--;)s=i[o].map(n).join("."),r.hasOwnProperty(s)||(r.push(s),r[s]=!0);return r}function b(t){var e,i,n,o,r,s,a,h,l="";if(!ja[t]){for(n=[];l.length<t;)l+=1;for(e=parseInt(l,2),o=function(t){return"1"===t},r=0;e>=r;r+=1){for(i=r.toString(2);i.length<t;)i="0"+i;for(h=[],a=i.length,s=0;a>s;s++)h.push(o(i[s]));n[r]=h}ja[t]=n}return ja[t]}function L(t,e,i,n){var o=t[e];if(!o||!o.equalsOrStartsWith(n)&&o.equalsOrStartsWith(i))return t[e]=o?o.replace(i,n):n,!0}function x(t){var e=t.slice(2);return"i"===t[1]&&h(e)?+e:e}function k(t){return null==t?t:(Va.hasOwnProperty(t)||(Va[t]=new Wa(t)),Va[t])}function E(t,e){function i(e,i){var n,o,s;return i.isRoot?s=[].concat(Object.keys(t.viewmodel.data),Object.keys(t.viewmodel.mappings),Object.keys(t.viewmodel.computations)):(n=t.viewmodel.wrapped[i.str],o=n?n.get():t.viewmodel.get(i),s=o?Object.keys(o):null),s&&s.forEach(function(t){"_ractive"===t&&r(o)||e.push(i.join(t))}),e}var n,o,s;for(n=e.str.split("."),s=[qa];o=n.shift();)"*"===o?s=s.reduce(i,[]):s[0]===qa?s[0]=k(o):s=s.map(P(o));return s}function P(t){return function(e){return e.join(t)}}function M(t){return t?t.replace(Za,".$1"):""}function C(t,e,i){if("string"!=typeof e||!h(i))throw new Error("Bad arguments");var n=void 0,o=void 0;if(/\*/.test(e))return o={},E(t,k(M(e))).forEach(function(e){var n=t.viewmodel.get(e);if(!h(n))throw new Error(Ja);o[e.str]=n+i}),t.set(o);if(n=t.get(e),!h(n))throw new Error(Ja);return t.set(e,+n+i)}function T(t,e){return Ya(this,t,void 0===e?1:+e)}function S(t){this.event=t,this.method="on"+t,this.deprecate=th[t]}function D(t,e){var i=t.indexOf(e);-1===i&&t.push(e)}function O(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]==e)return!0;return!1}function A(t,e){var i;if(!r(t)||!r(e))return!1;if(t.length!==e.length)return!1;for(i=t.length;i--;)if(t[i]!==e[i])return!1;return!0}function I(t){return"string"==typeof t?[t]:void 0===t?[]:t}function R(t){return t[t.length-1]}function z(t,e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}function U(t){for(var e=[],i=t.length;i--;)e[i]=t[i];return e}function B(t){setTimeout(t,0)}function N(t,e){return function(){for(var i;i=t.shift();)i(e)}}function F(t,e,i,n){var o;if(e===t)throw new TypeError("A promise's fulfillment handler cannot return the same promise");if(e instanceof eh)e.then(i,n);else if(!e||"object"!=typeof e&&"function"!=typeof e)i(e);else{try{o=e.then}catch(r){return void n(r)}if("function"==typeof o){var s,a,h;a=function(e){s||(s=!0,F(t,e,i,n))},h=function(t){s||(s=!0,n(t))};try{o.call(e,a,h)}catch(r){if(!s)return n(r),void(s=!0)}}else i(e)}}function j(t,e,i){var n;return e=M(e),"~/"===e.substr(0,2)?(n=k(e.substring(2)),V(t,n.firstKey,i)):"."===e[0]?(n=Z(ah(i),e),n&&V(t,n.firstKey,i)):n=H(t,k(e),i),n}function Z(t,e){var i;if(void 0!=t&&"string"!=typeof t&&(t=t.str),"."===e)return k(t);if(i=t?t.split("."):[],"../"===e.substr(0,3)){for(;"../"===e.substr(0,3);){if(!i.length)throw new Error('Could not resolve reference - too many "../" prefixes');i.pop(),e=e.substring(3)}return i.push(e),k(i.join("."))}return k(t?t+e.replace(/^\.\//,"."):e.replace(/^\.\/?/,""))}function H(t,e,i,n){var o,r,s,a,h;if(e.isRoot)return e;for(r=e.firstKey;i;)if(o=i.context,i=i.parent,o&&(a=!0,s=t.viewmodel.get(o),s&&("object"==typeof s||"function"==typeof s)&&r in s))return o.join(e.str);return W(t.viewmodel,r)?e:t.parent&&!t.isolated&&(a=!0,i=t.component.parentFragment,r=k(r),h=H(t.parent,r,i,!0))?(t.viewmodel.map(r,{origin:t.parent.viewmodel,keypath:h}),e):n||a?void 0:(t.viewmodel.set(e,void 0),e)}function V(t,e){var i;!t.parent||t.isolated||W(t.viewmodel,e)||(e=k(e),(i=H(t.parent,e,t.component.parentFragment,!0))&&t.viewmodel.map(e,{origin:t.parent.viewmodel,keypath:i}))}function W(t,e){return""===e||e in t.data||e in t.computations||e in t.mappings}function G(t){t.teardown()}function q(t){t.unbind()}function Y(t){t.unrender()}function J(t){t.cancel()}function $(t){t.detach()}function K(t){t.detachNodes()}function Q(t){!t.ready||t.outros.length||t.outroChildren||(t.outrosComplete||(t.parent?t.parent.decrementOutros(t):t.detachNodes(),t.outrosComplete=!0),t.intros.length||t.totalChildren||("function"==typeof t.callback&&t.callback(),t.parent&&t.parent.decrementTotal()))}function X(){for(var t,e,i;uh.ractives.length;)e=uh.ractives.pop(),i=e.viewmodel.applyChanges(),i&&fh.fire(e,i);for(tt(),t=0;t<uh.views.length;t+=1)uh.views[t].update();for(uh.views.length=0,t=0;t<uh.tasks.length;t+=1)uh.tasks[t]();return uh.tasks.length=0,uh.ractives.length?X():void 0}function tt(){var t,e,i,n;for(t=ph.length;t--;)e=ph[t],e.keypath?ph.splice(t,1):(i=hh(e.root,e.ref,e.parentFragment))&&((n||(n=[])).push({item:e,keypath:i}),ph.splice(t,1));n&&n.forEach(et)}function et(t){t.item.resolve(t.keypath)}function it(t,e,i){var n,o,r,s,a,h,l,u,c,d,p,f,m,g;if(n=new sh(function(t){return o=t}),"object"==typeof t){i=e||{},h=i.easing,l=i.duration,a=[],u=i.step,c=i.complete,(u||c)&&(p={},i.step=null,i.complete=null,d=function(t){return function(e,i){p[t]=i}});for(r in t)t.hasOwnProperty(r)&&((u||c)&&(f=d(r),i={easing:h,duration:l},u&&(i.step=f)),i.complete=c?f:Da,a.push(nt(this,r,t[r],i)));return g={easing:h,duration:l},u&&(g.step=function(t){return u(t,p)}),c&&n.then(function(t){return c(t,p)}),g.complete=o,m=nt(this,null,null,g),a.push(m),n.stop=function(){for(var t;t=a.pop();)t.stop();m&&m.stop()},n}return i=i||{},i.complete&&n.then(i.complete),i.complete=o,s=nt(this,t,e,i),n.stop=function(){return s.stop()},n}function nt(t,e,i,n){var o,r,s,h;return e&&(e=k(M(e))),null!==e&&(h=t.viewmodel.get(e)),_h.abort(e,t),a(h,i)?(n.complete&&n.complete(n.to),Lh):(n.easing&&(o="function"==typeof n.easing?n.easing:t.easing[n.easing],"function"!=typeof o&&(o=null)),r=void 0===n.duration?400:n.duration,s=new wh({keypath:e,from:h,to:i,root:t,duration:r,easing:o,interpolator:n.interpolator,step:n.step,complete:n.complete}),_h.add(s),t._animations.push(s),s)}function ot(){return this.detached?this.detached:(this.el&&z(this.el.__ractive_instances__,this),this.detached=this.fragment.detach(),kh.fire(this),this.detached)}function rt(t){return this.el?this.fragment.find(t):null}function st(t,e){var i;return i=this._isComponentQuery?!this.selector||t.name===this.selector:t.node?da(t.node,this.selector):null,i?(this.push(t.node||t.instance),e||this._makeDirty(),!0):void 0}function at(t){var e;return(e=t.parentFragment)?e.owner:t.component&&(e=t.component.parentFragment)?e.owner:void 0}function ht(t){var e,i;for(e=[t],i=at(t);i;)e.push(i),i=at(i);return e}function lt(t,e,i,n){var o=[];return La(o,{selector:{value:e},live:{value:i},_isComponentQuery:{value:n},_test:{value:Ph}}),i?(La(o,{cancel:{value:Mh},_root:{value:t},_sort:{value:Sh},_makeDirty:{value:Dh},_remove:{value:Oh},_dirty:{value:!1,writable:!0}}),o):o}function ut(t,e){var i,n;return this.el?(e=e||{},i=this._liveQueries,(n=i[t])?e&&e.live?n:n.slice():(n=Ah(this,t,!!e.live,!1),n.live&&(i.push(t),i["_"+t]=n),this.fragment.findAll(t,n),n)):[]}function ct(t,e){var i,n;return e=e||{},i=this._liveComponentQueries,(n=i[t])?e&&e.live?n:n.slice():(n=Ah(this,t,!!e.live,!0),n.live&&(i.push(t),i["_"+t]=n),this.fragment.findAllComponents(t,n),n)}function dt(t){return this.fragment.findComponent(t)}function pt(t){return this.container?this.container.component&&this.container.component.name===t?this.container:this.container.findContainer(t):null}function ft(t){return this.parent?this.parent.component&&this.parent.component.name===t?this.parent:this.parent.findParent(t):null}function mt(t,e){var i=void 0===arguments[2]?{}:arguments[2];if(e){i.event?i.event.name=e:i.event={name:e,_noArg:!0};var n=k(e).wildcardMatches();gt(t,n,i.event,i.args,!0)}}function gt(t,e,i,n){var o,r,s=void 0===arguments[4]?!1:arguments[4],a=!0;for(Fh.enqueue(t,i),r=e.length;r>=0;r--)o=t._subs[e[r]],o&&(a=vt(t,o,i,n)&&a);if(Fh.dequeue(t),t.parent&&a){if(s&&t.component){var h=t.component.name+"."+e[e.length-1];e=k(h).wildcardMatches(),i&&(i.component=t)}gt(t.parent,e,i,n)}}function vt(t,e,i,n){var o=null,r=!1;i&&!i._noArg&&(n=[i].concat(n)),e=e.slice();for(var s=0,a=e.length;a>s;s+=1)e[s].apply(t,n)===!1&&(r=!0);return i&&!i._noArg&&r&&(o=i.original)&&(o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()),!r}function _t(t){var e={args:Array.prototype.slice.call(arguments,1)};jh(this,t,e)}function yt(t){var e;return t=k(M(t)),e=this.viewmodel.get(t,Vh),void 0===e&&this.parent&&!this.isolated&&hh(this,t.str,this.component.parentFragment)&&(e=this.viewmodel.get(t)),e}function wt(e,i){if(!this.fragment.rendered)throw new Error("The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.");if(e=t(e),i=t(i)||null,!e)throw new Error("You must specify a valid target to insert into");e.insertBefore(this.detach(),i),this.el=e,(e.__ractive_instances__||(e.__ractive_instances__=[])).push(this),this.detached=null,bt(this)}function bt(t){Gh.fire(t),t.findAllComponents("*").forEach(function(t){bt(t.instance)})}function Lt(t,e,i){var n,o;return t=k(M(t)),n=this.viewmodel.get(t),r(n)&&r(e)?(o=mh.start(this,!0),this.viewmodel.merge(t,n,e,i),mh.end(),o):this.set(t,e,i&&i.complete)}function xt(t,e){var i,n;return i=E(t,e),n={},i.forEach(function(e){n[e.str]=t.get(e.str)}),n}function kt(t,e,i,n){var o,r,s;e=k(M(e)),n=n||al,e.isPattern?(o=new rl(t,e,i,n),t.viewmodel.patternObservers.push(o),r=!0):o=new $h(t,e,i,n),o.init(n.init),t.viewmodel.register(e,o,r?"patternObservers":"observers"),o.ready=!0;var a={cancel:function(){var i;s||(r?(i=t.viewmodel.patternObservers.indexOf(o),t.viewmodel.patternObservers.splice(i,1),t.viewmodel.unregister(e,o,"patternObservers")):t.viewmodel.unregister(e,o,"observers"),s=!0)}};return t._observers.push(a),a}function Et(t,e,i){var n,o,r,s;if(l(t)){i=e,o=t,n=[];for(t in o)o.hasOwnProperty(t)&&(e=o[t],n.push(this.observe(t,e,i)));return{cancel:function(){for(;n.length;)n.pop().cancel()}}}if("function"==typeof t)return i=e,e=t,t="",sl(this,t,e,i);if(r=t.split(" "),1===r.length)return sl(this,t,e,i);for(n=[],s=r.length;s--;)t=r[s],t&&n.push(sl(this,t,e,i));return{cancel:function(){for(;n.length;)n.pop().cancel()}}}function Pt(t,e,i){var n=this.observe(t,function(){e.apply(this,arguments),n.cancel()},{init:!1,defer:i&&i.defer});return n}function Mt(t,e){var i,n=this;if(t)i=t.split(" ").map(ul).filter(cl),i.forEach(function(t){var i,o;(i=n._subs[t])&&(e?(o=i.indexOf(e),-1!==o&&i.splice(o,1)):n._subs[t]=[])});else for(t in this._subs)delete this._subs[t];return this}function Ct(t,e){var i,n,o,r=this;if("object"==typeof t){i=[];for(n in t)t.hasOwnProperty(n)&&i.push(this.on(n,t[n]));return{cancel:function(){for(var t;t=i.pop();)t.cancel()}}}return o=t.split(" ").map(ul).filter(cl),o.forEach(function(t){(r._subs[t]||(r._subs[t]=[])).push(e)}),{cancel:function(){return r.off(t,e)}}}function Tt(t,e){var i=this.on(t,function(){e.apply(this,arguments),i.cancel()});return i}function St(t,e,i){var n,o,r,s,a,h,l=[];if(n=Dt(t,e,i),!n)return null;for(o=t.length,a=n.length-2-n[1],r=Math.min(o,n[0]),s=r+n[1],h=0;r>h;h+=1)l.push(h);for(;s>h;h+=1)l.push(-1);for(;o>h;h+=1)l.push(h+a);return 0!==a?l.touchedFrom=n[0]:l.touchedFrom=t.length,l}function Dt(t,e,i){switch(e){case"splice":for(void 0!==i[0]&&i[0]<0&&(i[0]=t.length+Math.max(i[0],-t.length));i.length<2;)i.push(0);return i[1]=Math.min(i[1],t.length-i[0]),i;case"sort":case"reverse":return null;case"pop":return t.length?[t.length-1,1]:[0,0];case"push":return[t.length,0].concat(i);case"shift":return[0,t.length?1:0];case"unshift":return[0,0].concat(i)}}function Ot(e,i){var n,o,r,s=this;if(r=this.transitionsEnabled,this.noIntro&&(this.transitionsEnabled=!1),n=mh.start(this,!0),mh.scheduleTask(function(){return Ml.fire(s)},!0),this.fragment.rendered)throw new Error("You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first");if(e=t(e)||this.el,i=t(i)||this.anchor,this.el=e,this.anchor=i,!this.append&&e){var a=e.__ractive_instances__;a&&a.length&&At(a),e.innerHTML=""}return this.cssId&&El.apply(),e&&((o=e.__ractive_instances__)?o.push(this):e.__ractive_instances__=[this],i?e.insertBefore(this.fragment.render(),i):e.appendChild(this.fragment.render())),mh.end(),this.transitionsEnabled=r,n.then(function(){return Cl.fire(s)})}function At(t){t.splice(0,t.length).forEach(G)}function It(t,e){for(var i=t.slice(),n=e.length;n--;)~i.indexOf(e[n])||i.push(e[n]);return i}function Rt(t,e){var i,n,o;return n='[data-ractive-css~="{'+e+'}"]',o=function(t){var e,i,o,r,s,a,h,l=[];for(e=[];i=Il.exec(t);)e.push({str:i[0],base:i[1],modifiers:i[2]});for(r=e.map(Ut),h=e.length;h--;)a=r.slice(),o=e[h],a[h]=o.base+n+o.modifiers||"",s=r.slice(),s[h]=n+" "+s[h],l.push(a.join(" "),s.join(" "));return l.join(", ")},i=zl.test(t)?t.replace(zl,n):t.replace(Al,"").replace(Ol,function(t,e){var i,n;return Rl.test(e)?t:(i=e.split(",").map(zt),n=i.map(o).join(", ")+" ",t.replace(e,n))})}function zt(t){return t.trim?t.trim():t.replace(/^\s+/,"").replace(/\s+$/,"")}function Ut(t){return t.str}function Bt(t){t&&t.constructor!==Object&&("function"==typeof t||("object"!=typeof t?c("data option must be an object or a function, `"+t+"` is not valid"):m("If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged")))}function Nt(t,e){Bt(e);var i="function"==typeof t,n="function"==typeof e;return e||i||(e={}),i||n?function(){var o=n?Ft(e,this):e,r=i?Ft(t,this):t;return jt(o,r)}:jt(e,t)}function Ft(t,e){var i=t.call(e);if(i)return"object"!=typeof i&&c("Data function must return an object"),i.constructor!==Object&&g("Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged"),i}function jt(t,e){if(t&&e){for(var i in e)i in t||(t[i]=e[i]);return t}return t||e}function Zt(t){var e,i,n;return t.matchString("=")?(e=t.pos,t.allowWhitespace(),(i=t.matchPattern(Au))?t.matchPattern(Iu)?(n=t.matchPattern(Au))?(t.allowWhitespace(),t.matchString("=")?[i,n]:(t.pos=e,null)):(t.pos=e,null):null:(t.pos=e,null)):null}function Ht(t){var e;return(e=t.matchPattern(zu))?{t:fu,v:e}:null}function Vt(t){var e,i;if(t.interpolate[t.inside]===!1)return null;for(i=0;i<t.tags.length;i+=1)if(e=Wt(t,t.tags[i]))return e}function Wt(t,e){var i,n,o,r;if(i=t.pos,t.matchString("\\"+e.open)){if(0===i||"\\"!==t.str[i-1])return e.open}else if(!t.matchString(e.open))return null;if(n=Ou(t))return t.matchString(e.close)?(e.open=n[0],e.close=n[1],t.sortMustacheTags(),Bu):null;if(t.allowWhitespace(),t.matchString("/")){t.pos-=1;var s=t.pos;Ru(t)?t.pos=s:(t.pos=s-e.close.length,t.error("Attempted to close a section that wasn't open"))}for(r=0;r<e.readers.length;r+=1)if(o=e.readers[r],n=o(t,e))return e.isStatic&&(n.s=!0),t.includeLinePositions&&(n.p=t.getLinePos(i)),n;return t.pos=i,null}function Gt(t){var e;return(e=t.matchPattern(Zu))?{t:lu,v:e}:null}function qt(t){var e=t.remaining();return"true"===e.substr(0,4)?(t.pos+=4,{t:pu,v:"true"}):"false"===e.substr(0,5)?(t.pos+=5,{t:pu,v:"false"}):null}function Yt(t){var e;return(e=Ju(t))?Qu.test(e.v)?e.v:'"'+e.v.replace(/"/g,'\\"')+'"':(e=ju(t))?e.v:(e=t.matchPattern($u))?e:void 0}function Jt(t){var e,i,n;return e=t.pos,t.allowWhitespace(),i=Ku(t),null===i?(t.pos=e,null):(t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),n=Cc(t),null===n?(t.pos=e,null):{t:gu,k:i,v:n}):(t.pos=e,null))}function $t(t){var e,i,n,o;return e=t.pos,n=Xu(t),null===n?null:(i=[n],t.matchString(",")?(o=$t(t),o?i.concat(o):(t.pos=e,null)):i)}function Kt(t){function e(t){n.push(t)}var i,n,o,r;return i=t.pos,t.allowWhitespace(),o=Cc(t),null===o?null:(n=[o],t.allowWhitespace(),t.matchString(",")&&(r=Kt(t),null===r&&t.error(Nu),r.forEach(e)),n)}function Qt(t){return ju(t)||Hu(t)||Ju(t)||ec(t)||nc(t)||Ru(t)}function Xt(t){var e,i,n,o,r,s;return e=t.pos,n=t.matchPattern(/^@(?:keypath|index|key)/),n||(i=t.matchPattern(sc)||"",n=!i&&t.relaxedNames&&t.matchPattern(uc)||t.matchPattern(lc),n||"."!==i||(i="",n=".")),n?i||t.relaxedNames||!Wu.test(n)?!i&&Vu.test(n)?(o=Vu.exec(n)[0],t.pos=e+o.length,{t:mu,v:o}):(r=(i||"")+M(n),t.matchString("(")&&(s=r.lastIndexOf("."),-1!==s?(r=r.substr(0,s),t.pos=e+r.length):t.pos-=1),{t:vu,n:r.replace(/^this\./,"./").replace(/^this$/,".")}):(t.pos=e,null):null}function te(t){var e,i;return e=t.pos,t.matchString("(")?(t.allowWhitespace(),i=Cc(t),i||t.error(Nu),t.allowWhitespace(),t.matchString(")")||t.error(Fu),{t:bu,x:i}):null}function ee(t){var e,i,n;if(e=t.pos,t.allowWhitespace(),t.matchString(".")){if(t.allowWhitespace(),i=t.matchPattern($u))return{t:_u,n:i};t.error("Expected a property name")}return t.matchString("[")?(t.allowWhitespace(),n=Cc(t),n||t.error(Nu),t.allowWhitespace(),t.matchString("]")||t.error("Expected ']'"),{t:_u,x:n}):null}function ie(t){var e,i,n,o;return(i=Pc(t))?(e=t.pos,t.allowWhitespace(),t.matchString("?")?(t.allowWhitespace(),n=Cc(t),n||t.error(Nu),t.allowWhitespace(),t.matchString(":")||t.error('Expected ":"'),t.allowWhitespace(),o=Cc(t),o||t.error(Nu),{t:Lu,o:[i,n,o]}):(t.pos=e,i)):null}function ne(t){return Mc(t)}function oe(t){function e(t){switch(t.t){case pu:case mu:case lu:case fu:return t.v;case uu:return JSON.stringify(String(t.v));case cu:return"["+(t.m?t.m.map(e).join(","):"")+"]";case du:return"{"+(t.m?t.m.map(e).join(","):"")+"}";case gu:return t.k+":"+e(t.v);case wu:return("typeof"===t.s?"typeof ":t.s)+e(t.o);case xu:return e(t.o[0])+("in"===t.s.substr(0,2)?" "+t.s+" ":t.s)+e(t.o[1]);case ku:return e(t.x)+"("+(t.o?t.o.map(e).join(","):"")+")";case bu:return"("+e(t.x)+")";case yu:return e(t.x)+e(t.r);case _u:return t.n?"."+t.n:"["+e(t.x)+"]";case Lu:return e(t.o[0])+"?"+e(t.o[1])+":"+e(t.o[2]);case vu:return"_"+i.indexOf(t.n);default:throw new Error("Expected legal JavaScript")}}var i;return re(t,i=[]),{r:i,s:e(t)}}function re(t,e){var i,n;if(t.t===vu&&-1===e.indexOf(t.n)&&e.unshift(t.n),n=t.o||t.m)if(l(n))re(n,e);else for(i=n.length;i--;)re(n[i],e);t.x&&re(t.x,e),t.r&&re(t.r,e),t.v&&re(t.v,e)}function se(t,e){var i;if(t){for(;t.t===bu&&t.x;)t=t.x;return t.t===vu?e.r=t.n:t.t===lu&&Dc.test(t.v)?e.r=t.v:(i=ae(t))?e.rx=i:e.x=Tc(t),e}}function ae(t){for(var e,i=[];t.t===yu&&t.r.t===_u;)e=t.r,e.x?e.x.t===vu?i.unshift(e.x):i.unshift(Tc(e.x)):i.unshift(e.n),t=t.x;return t.t!==vu?null:{r:t.n,m:i}}function he(t,e){var i,n=Cc(t);return n?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),i={t:Jl},Sc(n,i),i):null}function le(t,e){var i,n;return t.matchString("&")?(t.allowWhitespace(),(i=Cc(t))?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),n={t:Jl},Sc(i,n),n):null):null}function ue(t,e){var i,n,o,r,s;return i=t.pos,t.matchString(">")?(t.allowWhitespace(),n=t.pos,t.relaxedNames=!0,o=Cc(t),t.relaxedNames=!1,t.allowWhitespace(),r=Cc(t),t.allowWhitespace(),o?(s={t:tu},Sc(o,s),t.allowWhitespace(),r&&(s={t:$l,n:Cu,f:[s]},Sc(r,s)),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),s):null):null}function ce(t,e){var i;return t.matchString("!")?(i=t.remaining().indexOf(e.close),-1!==i?(t.pos+=i+e.close.length,{t:eu}):void 0):null}function de(t,e){var i,n,o;if(i=t.pos,n=Cc(t),!n)return null;for(o=0;o<e.length;o+=1)if(t.remaining().substr(0,e[o].length)===e[o])return n;return t.pos=i,rc(t)}function pe(t,e){var i,n,o,r;i=t.pos;try{n=zc(t,[e.close])}catch(s){r=s}if(!n){if("!"===t.str.charAt(i))return t.pos=i,null;if(r)throw r}if(!t.matchString(e.close)&&(t.error("Expected closing delimiter '"+e.close+"' after reference"),!n)){if("!"===t.nextChar())return null;t.error("Expected expression or legal reference")}return o={t:Yl},Sc(n,o),o}function fe(t,e){var i,n,o;return t.matchPattern(Nc)?(i=t.pos,n=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-]*/),t.allowWhitespace(),t.matchString(e.close)||t.error("expected legal partial name"),o={t:su},n&&(o.n=n),o):null}function me(t,e){var i,n,o,r;return i=t.pos,t.matchString(e.open)?(t.allowWhitespace(),t.matchString("/")?(t.allowWhitespace(),n=t.remaining(),o=n.indexOf(e.close),-1!==o?(r={t:Ql,r:n.substr(0,o).split(" ")[0]},t.pos+=o,t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),r):(t.pos=i,null)):(t.pos=i,null)):null}function ge(t,e){var i=t.pos;return t.matchString(e.open)?t.matchPattern(Zc)?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),{t:Su}):(t.pos=i,null):null}function ve(t,e){var i,n=t.pos;return t.matchString(e.open)?t.matchPattern(Vc)?(i=Cc(t),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),{t:Du,x:i}):(t.pos=n,null):null}function _e(t,e){var i,n,o,r,s,a,h,l,u,c,d,p;if(i=t.pos,t.matchString("^"))o={t:$l,f:[],n:Pu};else{if(!t.matchString("#"))return null;o={t:$l,f:[]},t.matchString("partial")&&(t.pos=i-t.standardDelimiters[0].length,t.error("Partial definitions can only be at the top level of the template, or immediately inside components")),(h=t.matchPattern(Jc))&&(p=h,o.n=Wc[h])}if(t.allowWhitespace(),n=Cc(t),n||t.error("Expected expression"),d=t.matchPattern(qc)){var f=void 0;(f=t.matchPattern(Yc))?o.i=d+","+f:o.i=d}t.allowWhitespace(),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),t.sectionDepth+=1,s=o.f,u=[];do if(r=Fc(t,e))p&&r.r!==p&&t.error("Expected "+e.open+"/"+p+e.close),t.sectionDepth-=1,c=!0;else if(r=Hc(t,e))o.n===Pu&&t.error("{{else}} not allowed in {{#unless}}"),a&&t.error("illegal {{elseif...}} after {{else}}"),l||(l=ye(n,o.n)),l.f.push({t:$l,n:Eu,x:Tc(be(u.concat(r.x))),f:s=[]}),u.push(we(r.x));else if(r=jc(t,e))o.n===Pu&&t.error("{{else}} not allowed in {{#unless}}"),a&&t.error("there can only be one {{else}} block, at the end of a section"),a=!0,l?l.f.push({t:$l,n:Eu,x:Tc(be(u)),f:s=[]}):(l=ye(n,o.n),s=l.f);else{if(r=t.read(Xd),!r)break;s.push(r)}while(!c);return l&&(o.n===Cu&&(o.n=Tu),o.l=l),Sc(n,o),o.f.length||delete o.f,o}function ye(t,e){var i;return e===Cu?(i={t:$l,n:Eu,f:[]},Sc(we(t),i)):(i={t:$l,n:Pu,f:[]},Sc(t,i)),i}function we(t){return t.t===wu&&"!"===t.s?t.o:{t:wu,s:"!",o:Le(t)}}function be(t){return 1===t.length?t[0]:{t:xu,s:"&&",o:[Le(t[0]),Le(be(t.slice(1)))]}}function Le(t){return{t:bu,x:t}}function xe(t){var e,i,n,o,r;return e=t.pos,t.matchString(Kc)?(n=t.remaining(),o=n.indexOf(Qc),-1===o&&t.error("Illegal HTML - expected closing comment sequence ('-->')"),i=n.substr(0,o),t.pos+=o+3,r={t:eu,c:i},t.includeLinePositions&&(r.p=t.getLinePos(e)),r):null}function ke(t){return t.replace(Lc,function(t,e){var i;return i="#"!==e[0]?wc[e]:"x"===e[1]?parseInt(e.substring(2),16):parseInt(e.substring(1),10),i?String.fromCharCode(Ee(i)):t})}function Ee(t){return t?10===t?32:128>t?t:159>=t?bc[t-128]:55296>t?t:57343>=t?65533:65535>=t?t:65533:65533}function Pe(t){return t.replace(Ec,"&amp;").replace(xc,"&lt;").replace(kc,"&gt;")}function Me(t){return"string"==typeof t}function Ce(t){return t.t===eu||t.t===iu}function Te(t){return(t.t===$l||t.t===Kl)&&t.f}function Se(t,e,i,n,o){var s,a,h,l,u,c,d,p;for(hd(t),s=t.length;s--;)a=t[s],a.exclude?t.splice(s,1):e&&a.t===eu&&t.splice(s,1);for(ld(t,n?pd:null,o?fd:null),s=t.length;s--;){if(a=t[s],a.f){var f=a.t===Xl&&dd.test(a.e);u=i||f,!i&&f&&ld(a.f,md,gd),u||(h=t[s-1],l=t[s+1],(!h||"string"==typeof h&&fd.test(h))&&(c=!0),(!l||"string"==typeof l&&pd.test(l))&&(d=!0)),Se(a.f,e,u,c,d)}if(a.l&&(Se(a.l.f,e,i,c,d),t.splice(s+1,0,a.l),delete a.l),a.a)for(p in a.a)a.a.hasOwnProperty(p)&&"string"!=typeof a.a[p]&&Se(a.a[p],e,i,c,d);if(a.m&&Se(a.m,e,i,c,d),a.v)for(p in a.v)a.v.hasOwnProperty(p)&&(r(a.v[p].n)&&Se(a.v[p].n,e,i,c,d),r(a.v[p].d)&&Se(a.v[p].d,e,i,c,d))}for(s=t.length;s--;)"string"==typeof t[s]&&("string"==typeof t[s+1]&&(t[s]=t[s]+t[s+1],t.splice(s+1,1)),i||(t[s]=t[s].replace(cd," ")),""===t[s]&&t.splice(s,1))}function De(t){var e,i;return e=t.pos,t.matchString("</")?(i=t.matchPattern(_d))?t.inside&&i!==t.inside?(t.pos=e,null):{t:ou,e:i}:(t.pos-=2,void t.error("Illegal closing tag")):null}function Oe(t){var e,i,n;return t.allowWhitespace(),(i=t.matchPattern(bd))?(e={name:i},n=Ae(t),null!=n&&(e.value=n),e):null}function Ae(t){var e,i,n,o;return e=t.pos,/[=\/>\s]/.test(t.nextChar())||t.error("Expected `=`, `/`, `>` or whitespace"),t.allowWhitespace(),t.matchString("=")?(t.allowWhitespace(),i=t.pos,n=t.sectionDepth,o=ze(t,"'")||ze(t,'"')||Re(t),null===o&&t.error("Expected valid attribute value"),t.sectionDepth!==n&&(t.pos=i,t.error("An attribute value must contain as many opening section tags as closing section tags")),o.length?1===o.length&&"string"==typeof o[0]?ke(o[0]):o:""):(t.pos=e,null)}function Ie(t){var e,i,n,o,r;return e=t.pos,(i=t.matchPattern(Ld))?(n=i,o=t.tags.map(function(t){return t.open}),-1!==(r=yd(n,o))&&(i=i.substr(0,r),t.pos=e+i.length),i):null}function Re(t){var e,i;for(t.inAttribute=!0,e=[],i=Uu(t)||Ie(t);null!==i;)e.push(i),i=Uu(t)||Ie(t);return e.length?(t.inAttribute=!1,e):null}function ze(t,e){var i,n,o;if(i=t.pos,!t.matchString(e))return null;for(t.inAttribute=e,n=[],o=Uu(t)||Ue(t,e);null!==o;)n.push(o),o=Uu(t)||Ue(t,e);return t.matchString(e)?(t.inAttribute=!1,n):(t.pos=i,null)}function Ue(t,e){var i,n,o,r;return i=t.pos,o=t.remaining(),r=t.tags.map(function(t){return t.open}),r.push(e),n=yd(o,r),-1===n&&t.error("Quoted attribute value must have a closing quote"),n?(t.pos+=n,o.substr(0,n)):null}function Be(t){var e,i,n;return t.allowWhitespace(),(e=Ku(t))?(n={key:e},t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),(i=t.read())?(n.value=i.v,n):null):null):null}function Ne(t,e){var i,n,o,r,s,a,h,l,u;if("string"==typeof t){if(n=Pd.exec(t)){var c=t.lastIndexOf(")");return Md.test(t)||e.error("Invalid input after method call expression '"+t.slice(c+1)+"'"),i={m:n[1]},r="["+t.slice(i.m.length+1,c)+"]",o=new xd(r),i.a=Tc(o.result[0]),i}if(-1===t.indexOf(":"))return t.trim();t=[t]}if(i={},h=[],l=[],t){for(;t.length;)if(s=t.shift(),"string"==typeof s){if(a=s.indexOf(":"),-1!==a){a&&h.push(s.substr(0,a)),s.length>a+1&&(l[0]=s.substring(a+1));break}h.push(s)}else h.push(s);l=l.concat(t)}return h.length?l.length||"string"!=typeof h?(i={n:1===h.length&&"string"==typeof h[0]?h[0]:h},1===l.length&&"string"==typeof l[0]?(u=kd("["+l[0]+"]"),i.a=u?u.value:l[0].trim()):i.d=l):i=h:i="",i}function Fe(t){var e,i,n,o,r,s,a,h,l,u,c,d,p,f,m,g;if(e=t.pos,t.inside||t.inAttribute)return null;if(!t.matchString("<"))return null;if("/"===t.nextChar())return null;if(i={},t.includeLinePositions&&(i.p=t.getLinePos(e)),t.matchString("!"))return i.t=hu,t.matchPattern(/^doctype/i)||t.error("Expected DOCTYPE declaration"),i.a=t.matchPattern(/^(.+?)>/),i;if(i.t=Xl,i.e=t.matchPattern(Td),!i.e)return null;for(Sd.test(t.nextChar())||t.error("Illegal tag name"),r=function(e,n){var o=n.n||n;Ad.test(o)&&(t.pos-=o.length,t.error("Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, detach, insert)")),i.v[e]=n},t.allowWhitespace();s=Uu(t)||wd(t);)s.name?(n=Id[s.name])?i[n]=Ed(s.value,t):(o=Od.exec(s.name))?(i.v||(i.v={}),a=Ed(s.value,t),r(o[1],a)):t.sanitizeEventAttributes&&Dd.test(s.name)||(i.a||(i.a={}),i.a[s.name]=s.value||(""===s.value?"":0)):(i.m||(i.m=[]),i.m.push(s)),t.allowWhitespace();if(t.allowWhitespace(),t.matchString("/")&&(h=!0),!t.matchString(">"))return null;var v=i.e.toLowerCase(),_=t.preserveWhitespace;if(!h&&!yc.test(i.e)){t.elementStack.push(v),("script"===v||"style"===v)&&(t.inside=v),l=[],u=wa(null);do if(f=t.pos,m=t.remaining(),je(v,m))if(g=vd(t)){p=!0;var y=g.e.toLowerCase();if(y!==v&&(t.pos=f,!~t.elementStack.indexOf(y))){var w="Unexpected closing tag";yc.test(y)&&(w+=" (<"+y+"> is a void element - it cannot contain children)"),t.error(w)}}else(d=Fc(t,{open:t.standardDelimiters[0],close:t.standardDelimiters[1]}))?(p=!0,t.pos=f):(d=t.read(tp))?(u[d.n]&&(t.pos=f,t.error("Duplicate partial definition")),ud(d.f,t.stripComments,_,!_,!_),u[d.n]=d.f,c=!0):(d=t.read(Xd))?l.push(d):p=!0;else p=!0;while(!p);l.length&&(i.f=l),c&&(i.p=u),t.elementStack.pop()}return t.inside=null,t.sanitizeElements&&-1!==t.sanitizeElements.indexOf(v)?Rd:i}function je(t,e){var i,n;return i=/^<([a-zA-Z][a-zA-Z0-9]*)/.exec(e),n=Cd[t],i&&n?!~n.indexOf(i[1].toLowerCase()):!0}function Ze(t){var e,i,n,o;return i=t.remaining(),o=t.inside?"</"+t.inside:"<",t.inside&&!t.interpolate[t.inside]?e=i.indexOf(o):(n=t.tags.map(function(t){return t.open}),n=n.concat(t.tags.map(function(t){return"\\"+t.open})),t.inAttribute===!0?n.push('"',"'","=","<",">","`"):t.inAttribute?n.push(t.inAttribute):n.push(o),e=yd(i,n)),e?(-1===e&&(e=i.length),t.pos+=e,t.inside?i.substr(0,e):ke(i.substr(0,e))):null}function He(t){return t.replace(Fd,"\\$&")}function Ve(t){var e=t.pos,i=t.standardDelimiters[0],n=t.standardDelimiters[1],o=void 0,r=void 0;if(!t.matchPattern(Zd)||!t.matchString(i))return t.pos=e,null;var s=t.matchPattern(Hd);if(g("Inline partial comments are deprecated.\nUse this...\n  {{#partial "+s+"}} ... {{/partial}}\n\n...instead of this:\n  <!-- {{>"+s+"}} --> ... <!-- {{/"+s+"}} -->'"),!t.matchString(n)||!t.matchPattern(Vd))return t.pos=e,null;o=[];var a=new RegExp("^<!--\\s*"+Nd(i)+"\\s*\\/\\s*"+s+"\\s*"+Nd(n)+"\\s*-->");do t.matchPattern(a)?r=!0:(zd=t.read(Xd),zd||t.error("expected closing comment ('<!-- "+i+"/"+s+n+" -->')"),o.push(zd));while(!r);return{t:au,f:o,n:s}}function We(t){var e,i,n,o,r;e=t.pos;var s=t.standardDelimiters;if(!t.matchString(s[0]))return null;if(!t.matchPattern(Gd))return t.pos=e,null;i=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-]*/),i||t.error("expected legal partial name"),t.matchString(s[1])||t.error("Expected closing delimiter '"+s[1]+"'"),n=[];do(o=Fc(t,{open:t.standardDelimiters[0],close:t.standardDelimiters[1]}))?("partial"===!o.r&&t.error("Expected "+s[0]+"/partial"+s[1]),r=!0):(o=t.read(Xd),o||t.error("Expected "+s[0]+"/partial"+s[1]),n.push(o));while(!r);return{t:au,n:i,f:n}}function Ge(t){for(var e=[],i=wa(null),n=!1,o=t.preserveWhitespace;t.pos<t.str.length;){var r=t.pos,s=void 0,a=void 0;(a=t.read(tp))?(i[a.n]&&(t.pos=r,t.error("Duplicated partial definition")),ud(a.f,t.stripComments,o,!o,!o),
i[a.n]=a.f,n=!0):(s=t.read(Xd))?e.push(s):t.error("Unexpected template content")}var h={v:sa,t:e};return n&&(h.p=i),h}function qe(t,e){return new Qd(t,e||{}).result}function Ye(t){var e=wa(rp);return e.parse=function(e,i){return Je(e,i||t)},e}function Je(t,e){if(!Yd)throw new Error("Missing Ractive.parse - cannot parse template. Either preparse or use the version that includes the parser");return Yd(t,e||this.options)}function $e(t,e){var i;if(!Xs){if(e&&e.noThrow)return;throw new Error("Cannot retrieve template #"+t+" as Ractive is not running in a browser.")}if(Ke(t)&&(t=t.substring(1)),!(i=document.getElementById(t))){if(e&&e.noThrow)return;throw new Error("Could not find template element with id #"+t)}if("SCRIPT"!==i.tagName.toUpperCase()){if(e&&e.noThrow)return;throw new Error("Template element with id #"+t+", must be a <script> element")}return"textContent"in i?i.textContent:i.innerHTML}function Ke(t){return t&&"#"===t[0]}function Qe(t){return!("string"==typeof t)}function Xe(t){return t.defaults&&(t=t.defaults),op.reduce(function(e,i){return e[i]=t[i],e},{})}function ti(t){var e,i=t._config.template;if(i&&i.fn)return e=ei(t,i.fn),e!==i.result?(i.result=e,e=ni(e,t)):void 0}function ei(t,e){var i=ii(sp.getParseOptions(t));return e.call(t,i)}function ii(t){var e=wa(sp);return e.parse=function(e,i){return sp.parse(e,i||t)},e}function ni(t,e){if("string"==typeof t)"#"===t[0]&&(t=sp.fromId(t)),t=Yd(t,sp.getParseOptions(e));else{if(void 0==t)throw new Error("The template cannot be "+t+".");if("number"!=typeof t.v)throw new Error("The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.");if(t.v!==sa)throw new Error("Mismatched template version (expected "+sa+", got "+t.v+") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app")}return t}function oi(t,e,i){if(e)for(var n in e)(i||!t.hasOwnProperty(n))&&(t[n]=e[n])}function ri(t,e,i){if(!/_super/.test(i))return i;var n=function(){var t,o=si(n._parent,e),r="_super"in this,s=this._super;return this._super=o,t=i.apply(this,arguments),r?this._super=s:delete this._super,t};return n._parent=t,n._method=i,n}function si(t,e){var i,n;return e in t?(i=t[e],n="function"==typeof i?i:function(){return i}):n=Da,n}function ai(t,e,i){return"options."+t+" has been deprecated in favour of options."+e+"."+(i?" You cannot specify both options, please use options."+e+".":"")}function hi(t,e,i){if(e in t){if(i in t)throw new Error(ai(e,i,!0));m(ai(e,i)),t[i]=t[e]}}function li(t){hi(t,"beforeInit","onconstruct"),hi(t,"init","onrender"),hi(t,"complete","oncomplete"),hi(t,"eventDefinitions","events"),r(t.adaptors)&&hi(t,"adaptors","adapt")}function ui(t,e,i,n){vp(n);for(var o in n)if(fp.hasOwnProperty(o)){var r=n[o];"el"!==o&&"function"==typeof r?m(""+o+" is a Ractive option that does not expect a function and will be ignored","init"===t?i:null):i[o]=r}mp.forEach(function(o){o[t](e,i,n)}),Sl[t](e,i,n),hp[t](e,i,n),Nl[t](e,i,n),ci(e.prototype,i,n)}function ci(t,e,i){for(var n in i)if(!pp[n]&&i.hasOwnProperty(n)){var o=i[n];"function"==typeof o&&(o=gp(t,n,o)),e[n]=o}}function di(t){var e={};return t.forEach(function(t){return e[t]=!0}),e}function pi(){this.dirtyValue=this.dirtyArgs=!0,this.bound&&"function"==typeof this.owner.bubble&&this.owner.bubble()}function fi(){var t;return 1===this.items.length?this.items[0].detach():(t=document.createDocumentFragment(),this.items.forEach(function(e){var i=e.detach();i&&t.appendChild(i)}),t)}function mi(t){var e,i,n,o;if(this.items){for(i=this.items.length,e=0;i>e;e+=1)if(n=this.items[e],n.find&&(o=n.find(t)))return o;return null}}function gi(t,e){var i,n,o;if(this.items)for(n=this.items.length,i=0;n>i;i+=1)o=this.items[i],o.findAll&&o.findAll(t,e);return e}function vi(t,e){var i,n,o;if(this.items)for(n=this.items.length,i=0;n>i;i+=1)o=this.items[i],o.findAllComponents&&o.findAllComponents(t,e);return e}function _i(t){var e,i,n,o;if(this.items){for(e=this.items.length,i=0;e>i;i+=1)if(n=this.items[i],n.findComponent&&(o=n.findComponent(t)))return o;return null}}function yi(t){var e,i=t.index;return e=this.items[i+1]?this.items[i+1].firstNode():this.owner===this.root?this.owner.component?this.owner.component.findNextNode():null:this.owner.findNextNode(this)}function wi(){return this.items&&this.items[0]?this.items[0].firstNode():null}function bi(t,e,i,n){return n=n||0,t.map(function(t){var o,r,s;return t.text?t.text:t.fragments?t.fragments.map(function(t){return bi(t.items,e,i,n)}).join(""):(o=i+"-"+n++,s=t.keypath&&(r=t.root.viewmodel.wrapped[t.keypath.str])?r.value:t.getValue(),e[o]=s,"${"+o+"}")}).join("")}function Li(){var t,e,i,n;return this.dirtyArgs&&(e=Mp(this.items,t={},this.root._guid),i=kd("["+e+"]",t),n=i?i.value:[this.toString()],this.argsList=n,this.dirtyArgs=!1),this.argsList}function xi(){var t=this;do if(t.pElement)return t.pElement.node;while(t=t.parent);return this.root.detached||this.root.el}function ki(){var t,e,i,n;return this.dirtyValue&&(e=Mp(this.items,t={},this.root._guid),i=kd(e,t),n=i?i.value:this.toString(),this.value=n,this.dirtyValue=!1),this.value}function Ei(){this.registered&&this.root.viewmodel.unregister(this.keypath,this),this.resolver&&this.resolver.unbind()}function Pi(){return this.value}function Mi(t,e){for(var i,n=0;n<e.prop.length;n++)if(void 0!==(i=t[e.prop[n]]))return i}function Ci(t,e){var i,n,o,r,s,a={},h=!1;for(e||(a.refs=i={});t;){if((s=t.owner)&&(n=s.indexRefs)){if(e&&(o=s.getIndexRef(e)))return a.ref={fragment:t,ref:o},a;if(!e)for(r in n)o=n[r],i[o.n]||(h=!0,i[o.n]={fragment:t,ref:o})}!t.parent&&t.owner&&t.owner.component&&t.owner.component.parentFragment&&!t.owner.component.instance.isolated?(a.componentBoundary=!0,t=t.owner.component.parentFragment):t=t.parent}return h?a:void 0}function Ti(t,e,i){var n;return"@"===e.charAt(0)?new Fp(t,e,i):(n=Hp(t.parentFragment,e))?new Zp(t,n,i):new Up(t,e,i)}function Si(t,e){var i,n;if(qp[t])return qp[t];for(n=[];e--;)n[e]="_"+e;return i=new Function(n.join(","),"return("+t+")"),qp[t]=i,i}function Di(t){return t.call()}function Oi(t,e){return t.replace(/_([0-9]+)/g,function(t,i){var n,o;return+i>=e.length?"_"+i:(n=e[i],void 0===n?"undefined":n.isSpecial?(o=n.value,"number"==typeof o?o:'"'+o+'"'):n.str)})}function Ai(t){return k("${"+t.replace(/[\.\[\]]/g,"-").replace(/\*/,"#MUL#")+"}")}function Ii(t){return void 0!==t&&"@"!==t[0]}function Ri(t,e){var i,n,o;if(t.__ractive_nowrap)return t;if(n="__ractive_"+e._guid,i=t[n])return i;if(/this/.test(t.toString())){ba(t,n,{value:Yp.call(t,e),configurable:!0});for(o in t)t.hasOwnProperty(o)&&(t[n][o]=t[o]);return e._boundFunctions.push({fn:t,prop:n}),t[n]}return ba(t,"__ractive_nowrap",{value:t}),t.__ractive_nowrap}function zi(t){return t.value}function Ui(t){return void 0!=t}function Bi(t){t.forceResolution()}function Ni(t,e){function i(e){t.resolve(e)}function n(e){var i=t.keypath;e!=i&&(t.resolve(e),void 0!==i&&t.fragments&&t.fragments.forEach(function(t){t.rebind(i,e)}))}var o,r,s;r=e.parentFragment,s=e.template,t.root=r.root,t.parentFragment=r,t.pElement=r.pElement,t.template=e.template,t.index=e.index||0,t.isStatic=e.template.s,t.type=e.template.t,t.registered=!1,(o=s.r)&&(t.resolver=Wp(t,o,i)),e.template.x&&(t.resolver=new Jp(t,r,e.template.x,n)),e.template.rx&&(t.resolver=new Xp(t,e.template.rx,n)),t.template.n!==Pu||t.hasOwnProperty("value")||t.setValue(void 0)}function Fi(t){var e,i,n;return t&&t.isSpecial?(this.keypath=t,void this.setValue(t.value)):(this.registered&&(this.root.viewmodel.unregister(this.keypath,this),this.registered=!1,e=!0),this.keypath=t,void 0!=t&&(i=this.root.viewmodel.get(t),this.root.viewmodel.register(t,this),this.registered=!0),this.setValue(i),void(e&&(n=this.twowayBinding)&&n.rebound()))}function ji(t,e){this.fragments&&this.fragments.forEach(function(i){return i.rebind(t,e)}),this.resolver&&this.resolver.rebind(t,e)}function Zi(){this.parentFragment.bubble()}function Hi(){var t;return 1===this.fragments.length?this.fragments[0].detach():(t=document.createDocumentFragment(),this.fragments.forEach(function(e){t.appendChild(e.detach())}),t)}function Vi(t){var e,i,n;for(i=this.fragments.length,e=0;i>e;e+=1)if(n=this.fragments[e].find(t))return n;return null}function Wi(t,e){var i,n;for(n=this.fragments.length,i=0;n>i;i+=1)this.fragments[i].findAll(t,e)}function Gi(t,e){var i,n;for(n=this.fragments.length,i=0;n>i;i+=1)this.fragments[i].findAllComponents(t,e)}function qi(t){var e,i,n;for(i=this.fragments.length,e=0;i>e;e+=1)if(n=this.fragments[e].findComponent(t))return n;return null}function Yi(t){return this.fragments[t.index+1]?this.fragments[t.index+1].firstNode():this.parentFragment.findNextNode(this)}function Ji(){var t,e,i;if(t=this.fragments.length)for(e=0;t>e;e+=1)if(i=this.fragments[e].firstNode())return i;return this.parentFragment.findNextNode(this)}function $i(t){var e,i,n,o,r,s,a,h=this;if(!this.shuffling&&!this.unbound&&this.currentSubtype===Mu){if(this.shuffling=!0,mh.scheduleTask(function(){return h.shuffling=!1}),e=this.parentFragment,r=[],t.forEach(function(t,e){var n,o,s,a,l;return t===e?void(r[t]=h.fragments[e]):(n=h.fragments[e],void 0===i&&(i=e),-1===t?(h.fragmentsToUnrender.push(n),void n.unbind()):(o=t-e,s=h.keypath.join(e),a=h.keypath.join(t),n.index=t,(l=n.registeredIndexRefs)&&l.forEach(Ki),n.rebind(s,a),void(r[t]=n)))}),o=this.root.viewmodel.get(this.keypath).length,void 0===i){if(this.length===o)return;i=this.length}for(this.length=this.fragments.length=o,this.rendered&&mh.addView(this),s={template:this.template.f,root:this.root,owner:this},n=i;o>n;n+=1)a=r[n],a||this.fragmentsToCreate.push(n),this.fragments[n]=a}}function Ki(t){t.rebind("","")}function Qi(){var t=this;return this.docFrag=document.createDocumentFragment(),this.fragments.forEach(function(e){return t.docFrag.appendChild(e.render())}),this.renderedFragments=this.fragments.slice(),this.fragmentsToRender=[],this.rendered=!0,this.docFrag}function Xi(t){var e,i,n=this;this.updating||(this.updating=!0,this.keypath&&(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),this.fragmentsToCreate.length?(i={template:this.template.f||[],root:this.root,pElement:this.pElement,owner:this},this.fragmentsToCreate.forEach(function(t){var e;i.context=n.keypath.join(t),i.index=t,e=new _y(i),n.fragmentsToRender.push(n.fragments[t]=e)}),this.fragmentsToCreate.length=0):en(this,t)&&(this.bubble(),this.rendered&&mh.addView(this)),this.value=t,this.updating=!1)}function tn(t,e,i){if(e===Mu&&t.indexRefs&&t.indexRefs[0]){var n=t.indexRefs[0];(i&&"i"===n.t||!i&&"k"===n.t)&&(i||(t.length=0,t.fragmentsToUnrender=t.fragments.slice(0),t.fragmentsToUnrender.forEach(function(t){return t.unbind()}))),n.t=i?"k":"i"}t.currentSubtype=e}function en(t,e){var i={template:t.template.f||[],root:t.root,pElement:t.parentFragment.pElement,owner:t};if(t.hasContext=!0,t.subtype)switch(t.subtype){case Eu:return t.hasContext=!1,an(t,e,!1,i);case Pu:return t.hasContext=!1,an(t,e,!0,i);case Cu:return sn(t,i);case Tu:return rn(t,e,i);case Mu:if(l(e))return tn(t,t.subtype,!0),on(t,e,i)}return t.ordered=!!s(e),t.ordered?(tn(t,Mu,!1),nn(t,e,i)):l(e)||"function"==typeof e?t.template.i?(tn(t,Mu,!0),on(t,e,i)):(tn(t,Cu,!1),sn(t,i)):(tn(t,Eu,!1),t.hasContext=!1,an(t,e,!1,i))}function nn(t,e,i){var n,o,r;if(o=e.length,o===t.length)return!1;if(o<t.length)t.fragmentsToUnrender=t.fragments.splice(o,t.length-o),t.fragmentsToUnrender.forEach(q);else if(o>t.length)for(n=t.length;o>n;n+=1)i.context=t.keypath.join(n),i.index=n,r=new _y(i),t.fragmentsToRender.push(t.fragments[n]=r);return t.length=o,!0}function on(t,e,i){var n,o,r,s,a,h;for(r=t.hasKey||(t.hasKey={}),o=t.fragments.length;o--;)s=t.fragments[o],s.key in e||(a=!0,s.unbind(),t.fragmentsToUnrender.push(s),t.fragments.splice(o,1),r[s.key]=!1);for(o=t.fragments.length;o--;)s=t.fragments[o],s.index!==o&&(s.index=o,(h=s.registeredIndexRefs)&&h.forEach(un));o=t.fragments.length;for(n in e)r[n]||(a=!0,i.context=t.keypath.join(n),i.key=n,i.index=o++,s=new _y(i),t.fragmentsToRender.push(s),t.fragments.push(s),r[n]=!0);return t.length=t.fragments.length,a}function rn(t,e,i){return e?sn(t,i):hn(t)}function sn(t,e){var i;return t.length?void 0:(e.context=t.keypath,e.index=0,i=new _y(e),t.fragmentsToRender.push(t.fragments[0]=i),t.length=1,!0)}function an(t,e,i,n){var o,r,a,h,u;if(r=s(e)&&0===e.length,a=!1,!s(e)&&l(e)){a=!0;for(u in e){a=!1;break}}return o=i?r||a||!e:e&&!r&&!a,o?t.length?t.length>1?(t.fragmentsToUnrender=t.fragments.splice(1),t.fragmentsToUnrender.forEach(q),!0):void 0:(n.index=0,h=new _y(n),t.fragmentsToRender.push(t.fragments[0]=h),t.length=1,!0):hn(t)}function hn(t){return t.length?(t.fragmentsToUnrender=t.fragments.splice(0,t.fragments.length).filter(ln),t.fragmentsToUnrender.forEach(q),t.length=t.fragmentsToRender.length=0,!0):void 0}function ln(t){return t.rendered}function un(t){t.rebind("","")}function cn(t){var e,i,n;for(e="",i=0,n=this.length,i=0;n>i;i+=1)e+=this.fragments[i].toString(t);return e}function dn(){var t=this;this.fragments.forEach(q),this.fragmentsToRender.forEach(function(e){return z(t.fragments,e)}),this.fragmentsToRender=[],Ip.call(this),this.length=0,this.unbound=!0}function pn(t){this.fragments.forEach(t?fn:mn),this.renderedFragments=[],this.rendered=!1}function fn(t){t.unrender(!0)}function mn(t){t.unrender(!1)}function gn(){var t,e,i,n,o,r,s;for(i=this.renderedFragments;t=this.fragmentsToUnrender.pop();)t.unrender(!0),i.splice(i.indexOf(t),1);for(;t=this.fragmentsToRender.shift();)t.render();for(this.rendered&&(o=this.parentFragment.getNode()),s=this.fragments.length,r=0;s>r;r+=1)t=this.fragments[r],e=i.indexOf(t,r),e!==r?(this.docFrag.appendChild(t.detach()),-1!==e&&i.splice(e,1),i.splice(r,0,t)):this.docFrag.childNodes.length&&(n=t.firstNode(),o.insertBefore(this.docFrag,n));this.rendered&&this.docFrag.childNodes.length&&(n=this.parentFragment.findNextNode(this),o.insertBefore(this.docFrag,n)),this.renderedFragments=this.fragments.slice()}function vn(){var t,e;if(this.docFrag){for(t=this.nodes.length,e=0;t>e;e+=1)this.docFrag.appendChild(this.nodes[e]);return this.docFrag}}function _n(t){var e,i,n,o;for(i=this.nodes.length,e=0;i>e;e+=1)if(n=this.nodes[e],1===n.nodeType){if(da(n,t))return n;if(o=n.querySelector(t))return o}return null}function yn(t,e){var i,n,o,r,s,a;for(n=this.nodes.length,i=0;n>i;i+=1)if(o=this.nodes[i],1===o.nodeType&&(da(o,t)&&e.push(o),r=o.querySelectorAll(t)))for(s=r.length,a=0;s>a;a+=1)e.push(r[a])}function wn(){return this.rendered&&this.nodes[0]?this.nodes[0]:this.parentFragment.findNextNode(this)}function bn(t){return Df[t]||(Df[t]=ca(t))}function Ln(t){var e,i,n;t&&"select"===t.name&&t.binding&&(e=U(t.node.options).filter(xn),t.getAttribute("multiple")?n=e.map(function(t){return t.value}):(i=e[0])&&(n=i.value),void 0!==n&&t.binding.setValue(n),t.bubble())}function xn(t){return t.selected}function kn(){if(this.rendered)throw new Error("Attempted to render an item that was already rendered");return this.docFrag=document.createDocumentFragment(),this.nodes=Of(this.value,this.parentFragment.getNode(),this.docFrag),Af(this.pElement),this.rendered=!0,this.docFrag}function En(t){var e;(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),t!==this.value&&(this.value=t,this.parentFragment.bubble(),this.rendered&&mh.addView(this))}function Pn(){return void 0!=this.value?ke(""+this.value):""}function Mn(t){this.rendered&&t&&(this.nodes.forEach(e),this.rendered=!1)}function Cn(){var t,e;if(this.rendered){for(;this.nodes&&this.nodes.length;)t=this.nodes.pop(),t.parentNode.removeChild(t);e=this.parentFragment.getNode(),this.nodes=Of(this.value,e,this.docFrag),e.insertBefore(this.docFrag,this.parentFragment.findNextNode(this)),Af(this.pElement)}}function Tn(){var t,e=this.node;return e?((t=e.parentNode)&&t.removeChild(e),e):void 0}function Sn(){return null}function Dn(){return this.node}function On(t){return this.attributes&&this.attributes[t]?this.attributes[t].value:void 0}function An(){var t=this.useProperty||!this.rendered?this.fragment.getValue():this.fragment.toString();a(t,this.value)||("id"===this.name&&this.value&&delete this.root.nodes[this.value],this.value=t,"value"===this.name&&this.node&&(this.node._ractive.value=t),this.rendered&&mh.addView(this))}function In(t){var e=t.fragment.items;if(1===e.length)return e[0].type===Yl?e[0]:void 0}function Rn(t){return this.type=nu,this.element=t.element,this.root=t.root,rm(this,t.name),this.isBoolean=_c.test(this.name),t.value&&"string"!=typeof t.value?(this.parentFragment=this.element.parentFragment,this.fragment=new _y({template:t.value,root:this.root,owner:this}),this.value=this.fragment.getValue(),this.interpolator=sm(this),this.isBindable=!!this.interpolator&&!this.interpolator.isStatic,void(this.ready=!0)):void(this.value=this.isBoolean?!0:t.value||"")}function zn(t,e){this.fragment&&this.fragment.rebind(t,e)}function Un(t){var e;this.node=t,t.namespaceURI&&t.namespaceURI!==na.html||(e=um[this.name]||this.name,void 0!==t[e]&&(this.propertyName=e),(this.isBoolean||this.isTwoway)&&(this.useProperty=!0),"value"===e&&(t._ractive.value=this.value)),this.rendered=!0,this.update()}function Bn(){var t=this,e=t.name,i=t.namespacePrefix,n=t.value,o=t.interpolator,r=t.fragment;if(("value"!==e||"select"!==this.element.name&&"textarea"!==this.element.name)&&("value"!==e||void 0===this.element.getAttribute("contenteditable"))){if("name"===e&&"input"===this.element.name&&o)return"name={{"+(o.keypath.str||o.ref)+"}}";if(this.isBoolean)return n?e:"";if(r){if(1===r.items.length&&null==r.items[0].value)return"";n=r.toString()}return i&&(e=i+":"+e),n?e+'="'+Nn(n)+'"':e}}function Nn(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Fn(){this.fragment&&this.fragment.unbind(),"id"===this.name&&delete this.root.nodes[this.value]}function jn(){var t,e,i,n,o=this.value;if(!this.locked)for(this.node._ractive.value=o,t=this.node.options,n=t.length;n--;)if(e=t[n],i=e._ractive?e._ractive.value:e.value,i==o){e.selected=!0;break}}function Zn(){var t,e,i,n,o=this.value;for(r(o)||(o=[o]),t=this.node.options,e=t.length;e--;)i=t[e],n=i._ractive?i._ractive.value:i.value,i.selected=O(o,n)}function Hn(){var t=this,e=t.node,i=t.value;e.checked=i==e._ractive.value}function Vn(){var t,e,i,n,o=this.node;if(t=o.checked,o.value=this.element.getAttribute("value"),o.checked=this.element.getAttribute("value")===this.element.getAttribute("name"),t&&!o.checked&&this.element.binding&&(i=this.element.binding.siblings,n=i.length)){for(;n--;){if(e=i[n],!e.element.node)return;if(e.element.node.checked)return mh.addRactive(e.root),e.handleChange()}this.root.viewmodel.set(e.keypath,void 0)}}function Wn(){var t,e,i=this,n=i.element,o=i.node,s=i.value,a=n.binding;if(t=n.getAttribute("value"),r(s)){for(e=s.length;e--;)if(t==s[e])return void(a.isChecked=o.checked=!0);a.isChecked=o.checked=!1}else a.isChecked=o.checked=s==t}function Gn(){this.node.className=i(this.value)}function qn(){var t=this,e=t.node,i=t.value;this.root.nodes[i]=e,e.id=i}function Yn(){var t,e;t=this.node,e=this.value,void 0===e&&(e=""),t.style.setAttribute("cssText",e)}function Jn(){var t=this.value;void 0===t&&(t=""),this.locked||(this.node.innerHTML=t)}function $n(){var t=this,e=t.node,i=t.value;e._ractive.value=i,this.locked||(e.value=void 0==i?"":i)}function Kn(){this.locked||(this.node[this.propertyName]=this.value)}function Qn(){var t=this,e=t.node,i=t.namespace,n=t.name,o=t.value,r=t.fragment;i?e.setAttributeNS(i,n,(r||o).toString()):this.isBoolean?o?e.setAttribute(n,""):e.removeAttribute(n):null==o?e.removeAttribute(n):e.setAttribute(n,(r||o).toString())}function Xn(){var t,e,i=this,n=i.name,o=i.element,r=i.node;"id"===n?e=ym:"value"===n?"select"===o.name&&"value"===n?e=o.getAttribute("multiple")?fm:pm:"textarea"===o.name?e=Lm:null!=o.getAttribute("contenteditable")?e=bm:"input"===o.name&&(t=o.getAttribute("type"),e="file"===t?Da:"radio"===t&&o.binding&&"name"===o.binding.name?gm:Lm):this.isTwoway&&"name"===n?"radio"===r.type?e=mm:"checkbox"===r.type&&(e=vm):"style"===n&&r.style.setAttribute?e=wm:"class"!==n||r.namespaceURI&&r.namespaceURI!==na.html?this.useProperty&&(e=xm):e=_m,e||(e=km),this.update=e,this.update()}function to(t,e){var i=e?"svg":"div";return Mm.innerHTML="<"+i+" "+t+"></"+i+">",U(Mm.childNodes[0].attributes)}function eo(t,e){for(var i=t.length;i--;)if(t[i].name===e.name)return!1;return!0}function io(t){for(;t=t.parent;)if("form"===t.name)return t}function no(){this._ractive.binding.handleChange()}function oo(){var t;zm.call(this),t=this._ractive.root.viewmodel.get(this._ractive.binding.keypath),this.value=void 0==t?"":t}function ro(){var t=this._ractive.binding,e=this;t._timeout&&clearTimeout(t._timeout),t._timeout=setTimeout(function(){t.rendered&&zm.call(e),t._timeout=void 0},t.element.lazy)}function so(t,e,i){var n=t+e+i;return jm[n]||(jm[n]=[])}function ao(t){return t.isChecked}function ho(t){return t.element.getAttribute("value")}function lo(t){var e,i,n,o,r,s=t.attributes;return t.binding&&(t.binding.teardown(),t.binding=null),(t.getAttribute("contenteditable")||s.contenteditable&&uo(s.contenteditable))&&uo(s.value)?i=Nm:"input"===t.name?(e=t.getAttribute("type"),"radio"===e||"checkbox"===e?(n=uo(s.name),o=uo(s.checked),n&&o&&m("A radio input can have two-way binding on its name attribute, or its checked attribute - not both",{ractive:t.root}),n?i="radio"===e?Wm:qm:o&&(i="radio"===e?Hm:Jm)):"file"===e&&uo(s.value)?i=eg:uo(s.value)&&(i="number"===e||"range"===e?ig:Um)):"select"===t.name&&uo(s.value)?i=t.getAttribute("multiple")?Xm:Km:"textarea"===t.name&&uo(s.value)&&(i=Um),i&&(r=new i(t))&&r.keypath?r:void 0}function uo(t){return t&&t.isBindable}function co(){var t=this.getAction();t&&!this.hasListener?this.listen():!t&&this.hasListener&&this.unrender()}function po(t){jh(this.root,this.getAction(),{event:t})}function fo(){return this.action.toString().trim()}function mo(t,e,i){var n,o,r,s=this;this.element=t,this.root=t.root,this.parentFragment=t.parentFragment,this.name=e,-1!==e.indexOf("*")&&(c('Only component proxy-events may contain "*" wildcards, <%s on-%s="..."/> is not valid',t.name,e),this.invalid=!0),i.m?(o=i.a.r,this.method=i.m,this.keypaths=[],this.fn=Gp(i.a.s,o.length),this.parentFragment=t.parentFragment,r=this.root,this.refResolvers=[],o.forEach(function(t,e){var i=void 0;(i=hg.exec(t))?s.keypaths[e]={eventObject:!0,refinements:i[1]?i[1].split("."):[]}:s.refResolvers.push(Wp(s,t,function(t){return s.resolve(e,t)}))}),this.fire=go):(n=i.n||i,"string"!=typeof n&&(n=new _y({template:n,root:this.root,owner:this})),this.action=n,i.d?(this.dynamicParams=new _y({template:i.d,root:this.root,owner:this.element}),this.fire=_o):i.a&&(this.params=i.a,this.fire=vo))}function go(t){var e,i,n;if(e=this.root,"function"!=typeof e[this.method])throw new Error('Attempted to call a non-existent method ("'+this.method+'")');i=this.keypaths.map(function(i){var n,o,r;if(void 0!==i){if(i.eventObject){if(n=t,o=i.refinements.length)for(r=0;o>r;r+=1)n=n[i.refinements[r]]}else n=e.viewmodel.get(i);return n}}),Fh.enqueue(e,t),n=this.fn.apply(null,i),e[this.method].apply(e,n),Fh.dequeue(e)}function vo(t){jh(this.root,this.getAction(),{event:t,args:this.params})}function _o(t){var e=this.dynamicParams.getArgsList();"string"==typeof e&&(e=e.substr(1,e.length-2)),jh(this.root,this.getAction(),{event:t,args:e})}function yo(t){var e,i,n,o={};e=this._ractive,i=e.events[t.type],(n=Hp(i.element.parentFragment))&&(o=Hp.resolve(n)),i.fire({node:this,original:t,index:o,keypath:e.keypath.str,context:e.root.viewmodel.get(e.keypath)})}function wo(){var t,e=this.name;if(!this.invalid){if(t=v("events",this.root,e))this.custom=t(this.node,bo(e));else{if(!("on"+e in this.node||window&&"on"+e in window||ta))return void(dg[e]||g(Ra(e,"event"),{node:this.node}));this.node.addEventListener(e,lg,!1)}this.hasListener=!0}}function bo(t){return cg[t]||(cg[t]=function(e){var i=e.node._ractive;e.index=i.index,e.keypath=i.keypath.str,e.context=i.root.viewmodel.get(i.keypath),i.events[t].fire(e)}),cg[t]}function Lo(t,e){function i(i){i&&i.rebind(t,e)}var n;return this.method?(n=this.element.parentFragment,void this.refResolvers.forEach(i)):("string"!=typeof this.action&&i(this.action),void(this.dynamicParams&&i(this.dynamicParams)))}function xo(){this.node=this.element.node,this.node._ractive.events[this.name]=this,(this.method||this.getAction())&&this.listen()}function ko(t,e){this.keypaths[t]=e}function Eo(){return this.method?void this.refResolvers.forEach(q):("string"!=typeof this.action&&this.action.unbind(),void(this.dynamicParams&&this.dynamicParams.unbind()))}function Po(){this.custom?this.custom.teardown():this.node.removeEventListener(this.name,lg,!1),this.hasListener=!1}function Mo(){var t=this;this.dirty||(this.dirty=!0,mh.scheduleTask(function(){Co(t),t.dirty=!1})),this.parentFragment.bubble()}function Co(t){var e,i,n,o,r;e=t.node,e&&(o=U(e.options),i=t.getAttribute("value"),n=t.getAttribute("multiple"),void 0!==i?(o.forEach(function(t){var e,o;e=t._ractive?t._ractive.value:t.value,o=n?To(i,e):i==e,o&&(r=!0),t.selected=o}),r||(o[0]&&(o[0].selected=!0),t.binding&&t.binding.forceUpdate())):t.binding&&t.binding.forceUpdate())}function To(t,e){for(var i=t.length;i--;)if(t[i]==e)return!0}function So(t,e){t.select=Oo(t.parent),t.select&&(t.select.options.push(t),e.a||(e.a={}),void 0!==e.a.value||e.a.hasOwnProperty("disabled")||(e.a.value=e.f),"selected"in e.a&&void 0!==t.select.getAttribute("value")&&delete e.a.selected)}function Do(t){t.select&&z(t.select.options,t)}function Oo(t){if(t)do if("select"===t.name)return t;while(t=t.parent)}function Ao(t){var e,i,n,o,r,s,a;this.type=Xl,e=this.parentFragment=t.parentFragment,i=this.template=t.template,this.parent=t.pElement||e.pElement,this.root=n=e.root,this.index=t.index,this.key=t.key,this.name=om(i.e),"option"===this.name&&So(this,i),"select"===this.name&&(this.options=[],this.bubble=Mo),"form"===this.name&&(this.formBindings=[]),a=im(this,i),this.attributes=Tm(this,i.a),this.conditionalAttributes=Om(this,i.m),i.f&&(this.fragment=new _y({template:i.f,root:n,owner:this,pElement:this,cssIds:null})),s=n.twoway,a.twoway===!1?s=!1:a.twoway===!0&&(s=!0),this.twoway=s,this.lazy=a.lazy,s&&(o=ng(this,i.a))&&(this.binding=o,r=this.root._twowayBindings[o.keypath.str]||(this.root._twowayBindings[o.keypath.str]=[]),r.push(o)),i.v&&(this.eventHandlers=wg(this,i.v)),i.o&&(this.decorator=new Eg(this,i.o)),this.intro=i.t0||i.t1,this.outro=i.t0||i.t2}function Io(t,e){function i(i){i.rebind(t,e)}var n,o,r,s;if(this.attributes&&this.attributes.forEach(i),this.conditionalAttributes&&this.conditionalAttributes.forEach(i),this.eventHandlers&&this.eventHandlers.forEach(i),this.decorator&&i(this.decorator),this.fragment&&i(this.fragment),r=this.liveQueries)for(s=this.root,n=r.length;n--;)r[n]._makeDirty();this.node&&(o=this.node._ractive)&&L(o,"keypath",t,e)}function Ro(t){var e;(t.attributes.width||t.attributes.height)&&t.node.addEventListener("load",e=function(){var i=t.getAttribute("width"),n=t.getAttribute("height");void 0!==i&&t.node.setAttribute("width",i),void 0!==n&&t.node.setAttribute("height",n),t.node.removeEventListener("load",e,!1)},!1)}function zo(t){t.node.addEventListener("reset",Bo,!1)}function Uo(t){t.node.removeEventListener("reset",Bo,!1)}function Bo(){var t=this._ractive.proxy;mh.start(),t.formBindings.forEach(No),mh.end()}function No(t){t.root.viewmodel.set(t.keypath,t.resetValue)}function Fo(t,e,i){var n,o,r;this.element=t,this.root=n=t.root,this.isIntro=i,o=e.n||e,("string"==typeof o||(r=new _y({template:o,root:n,owner:t}),o=r.toString(),r.unbind(),""!==o))&&(this.name=o,e.a?this.params=e.a:e.d&&(r=new _y({template:e.d,root:n,owner:t}),this.params=r.getArgsList(),r.unbind()),this._fn=v("transitions",n,o),this._fn||g(Ra(o,"transition"),{ractive:this.root}))}function jo(t){return t}function Zo(){ev.hidden=document[Kg]}function Ho(){ev.hidden=!0}function Vo(){ev.hidden=!1}function Wo(){var t,e,i,n=this;return t=this.node=this.element.node,e=t.getAttribute("style"),this.complete=function(o){i||(!o&&n.isIntro&&Go(t,e),t._ractive.transition=null,n._manager.remove(n),i=!0)},this._fn?void this._fn.apply(this.root,[this].concat(this.params)):void this.complete()}function Go(t,e){e?t.setAttribute("style",e):(t.getAttribute("style"),t.removeAttribute("style"))}function qo(){var t,e,i,n=this,o=this.root;return t=Yo(this),e=this.node=ca(this.name,t),this.parentFragment.cssIds&&this.node.setAttribute("data-ractive-css",this.parentFragment.cssIds.map(function(t){return"{"+t+"}"}).join(" ")),ba(this.node,"_ractive",{value:{proxy:this,keypath:ah(this.parentFragment),events:wa(null),root:o}}),this.attributes.forEach(function(t){return t.render(e)}),this.conditionalAttributes.forEach(function(t){return t.render(e)}),this.fragment&&("script"===this.name?(this.bubble=dv,this.node.text=this.fragment.toString(!1),this.fragment.unrender=Da):"style"===this.name?(this.bubble=cv,this.bubble(),this.fragment.unrender=Da):this.binding&&this.getAttribute("contenteditable")?this.fragment.unrender=Da:this.node.appendChild(this.fragment.render())),this.binding&&(this.binding.render(),this.node._ractive.binding=this.binding),this.eventHandlers&&this.eventHandlers.forEach(function(t){return t.render()}),"option"===this.name&&Jo(this),"img"===this.name?Ro(this):"form"===this.name?zo(this):"input"===this.name||"textarea"===this.name?this.node.defaultValue=this.node.value:"option"===this.name&&(this.node.defaultSelected=this.node.selected),this.decorator&&this.decorator.fn&&mh.scheduleTask(function(){n.decorator.torndown||n.decorator.init()},!0),o.transitionsEnabled&&this.intro&&(i=new pv(this,this.intro,!0),mh.registerTransition(i),mh.scheduleTask(function(){return i.start()},!0),this.transition=i),this.node.autofocus&&mh.scheduleTask(function(){return n.node.focus()},!0),$o(this),this.node}function Yo(t){var e,i,n;return e=(i=t.getAttribute("xmlns"))?i:"svg"===t.name?na.svg:(n=t.parent)?"foreignObject"===n.name?na.html:n.node.namespaceURI:t.root.el.namespaceURI}function Jo(t){var e,i,n;if(t.select&&(i=t.select.getAttribute("value"),void 0!==i))if(e=t.getAttribute("value"),t.select.node.multiple&&r(i)){for(n=i.length;n--;)if(e==i[n]){t.node.selected=!0;break}}else t.node.selected=e==i}function $o(t){var e,i,n,o,r;e=t.root;do for(i=e._liveQueries,n=i.length;n--;)o=i[n],r=i["_"+o],r._test(t)&&(t.liveQueries||(t.liveQueries=[])).push(r);while(e=e.parent)}function Ko(t){var e,i,n;if(e=t.getAttribute("value"),void 0===e||!t.select)return!1;if(i=t.select.getAttribute("value"),i==e)return!0;if(t.select.getAttribute("multiple")&&r(i))for(n=i.length;n--;)if(i[n]==e)return!0}function Qo(t){var e,i,n,o;return e=t.attributes,i=e.type,n=e.value,o=e.name,i&&"radio"===i.value&&n&&o.interpolator&&n.value===o.interpolator.value?!0:void 0}function Xo(t){var e=t.toString();return e?" "+e:""}function tr(){this.fragment&&this.fragment.unbind(),this.binding&&this.binding.unbind(),this.eventHandlers&&this.eventHandlers.forEach(q),"option"===this.name&&Do(this),this.attributes.forEach(q),this.conditionalAttributes.forEach(q)}function er(t){var e,i,n;(n=this.transition)&&n.complete(),"option"===this.name?this.detach():t&&mh.detachWhenReady(this),this.fragment&&this.fragment.unrender(!1),(e=this.binding)&&(this.binding.unrender(),this.node._ractive.binding=null,i=this.root._twowayBindings[e.keypath.str],i.splice(i.indexOf(e),1)),this.eventHandlers&&this.eventHandlers.forEach(Y),this.decorator&&mh.registerDecorator(this.decorator),this.root.transitionsEnabled&&this.outro&&(n=new pv(this,this.outro,!1),mh.registerTransition(n),mh.scheduleTask(function(){return n.start()})),this.liveQueries&&ir(this),"form"===this.name&&Uo(this)}function ir(t){var e,i,n;for(n=t.liveQueries.length;n--;)e=t.liveQueries[n],i=e.selector,e._remove(t.node)}function nr(t,e){var i=bv.exec(e)[0];return null===t||i.length<t.length?i:t}function or(t,e,i){var n;if(n=rr(t,e,i||{}))return n;if(n=sp.fromId(e,{
noThrow:!0})){n=Lv(n);var o=sp.parse(n,sp.getParseOptions(t));return t.partials[e]=o.t}}function rr(t,e,i){var n=void 0,o=hr(e,i.owner);if(o)return o;var r=_("partials",t,e);if(r){if(o=r.partials[e],"function"==typeof o&&(n=o.bind(r),n.isOwner=r.partials.hasOwnProperty(e),o=n.call(t,sp)),!o&&""!==o)return void m(Ia,e,"partial","partial",{ractive:t});if(!sp.isParsed(o)){var s=sp.parse(o,sp.getParseOptions(r));s.p&&m("Partials ({{>%s}}) cannot contain nested inline partials",e,{ractive:t});var a=n?r:sr(r,e);a.partials[e]=o=s.t}return n&&(o._fn=n),o.v?o.t:o}}function sr(t,e){return t.partials.hasOwnProperty(e)?t:ar(t.constructor,e)}function ar(t,e){return t?t.partials.hasOwnProperty(e)?t:ar(t._Parent,e):void 0}function hr(t,e){if(e){if(e.template&&e.template.p&&e.template.p[t])return e.template.p[t];if(e.parentFragment&&e.parentFragment.owner)return hr(t,e.parentFragment.owner)}}function lr(t,e){var i,n=_("components",t,e);if(n&&(i=n.components[e],!i._Parent)){var o=i.bind(n);if(o.isOwner=n.components.hasOwnProperty(e),i=o(),!i)return void m(Ia,e,"component","component",{ractive:t});"string"==typeof i&&(i=lr(t,i)),i._fn=o,n.components[e]=i}return i}function ur(){var t=this.instance.fragment.detach();return Av.fire(this.instance),t}function cr(t){return this.instance.fragment.find(t)}function dr(t,e){return this.instance.fragment.findAll(t,e)}function pr(t,e){e._test(this,!0),this.instance.fragment&&this.instance.fragment.findAllComponents(t,e)}function fr(t){return t&&t!==this.name?this.instance.fragment?this.instance.fragment.findComponent(t):null:this.instance}function mr(){return this.parentFragment.findNextNode(this)}function gr(){return this.rendered?this.instance.fragment.firstNode():null}function vr(t,e,i){function n(t){var i,n;t.value=e,t.updating||(n=t.ractive,i=t.keypath,t.updating=!0,mh.start(n),n.viewmodel.mark(i),mh.end(),t.updating=!1)}var o,r,s,a,h,l;if(o=t.obj,r=t.prop,i&&!i.configurable){if("length"===r)return;throw new Error('Cannot use magic mode with property "'+r+'" - object is not configurable')}i&&(s=i.get,a=i.set),h=s||function(){return e},l=function(t){a&&a(t),e=s?s():t,l._ractiveWrappers.forEach(n)},l._ractiveWrappers=[t],Object.defineProperty(o,r,{get:h,set:l,enumerable:!0,configurable:!0})}function _r(t,e){var i,n,o,r;if(this.adaptors)for(i=this.adaptors.length,n=0;i>n;n+=1)if(o=this.adaptors[n],o.filter(e,t,this.ractive))return r=this.wrapped[t]=o.wrap(this.ractive,e,t,wr(t)),void(r.value=e)}function yr(t,e){var i,n={};if(!e)return t;e+=".";for(i in t)t.hasOwnProperty(i)&&(n[e+i]=t[i]);return n}function wr(t){var e;return n_[t]||(e=t?t+".":"",n_[t]=function(i,n){var o;return"string"==typeof i?(o={},o[e+i]=n,o):"object"==typeof i?e?yr(i,t):i:void 0}),n_[t]}function br(t){var e,i,n=[qa];for(e=t.length;e--;)for(i=t[e].parent;i&&!i.isRoot;)-1===t.indexOf(i)&&D(n,i),i=i.parent;return n}function Lr(t,e,i){var n;kr(t,e),i||(n=e.wildcardMatches(),n.forEach(function(i){xr(t,i,e)}))}function xr(t,e,i){var n,o,r;e=e.str||e,n=t.depsMap.patternObservers,o=n&&n[e],o&&o.forEach(function(e){r=i.join(e.lastKey),kr(t,r),xr(t,e,r)})}function kr(t,e){t.patternObservers.forEach(function(t){t.regex.test(e.str)&&t.update(e)})}function Er(){function t(t){var n=t.key;t.viewmodel===s?(s.clearCache(n.str),t.invalidate(),i.push(n),e(n)):t.viewmodel.mark(n)}function e(i){var n,o;s.noCascade.hasOwnProperty(i.str)||((o=s.deps.computed[i.str])&&o.forEach(t),(n=s.depsMap.computed[i.str])&&n.forEach(e))}var i,n,o,r=this,s=this,a={};return i=this.changes,i.length?(i.slice().forEach(e),n=o_(i),n.forEach(function(e){var n;-1===i.indexOf(e)&&(n=s.deps.computed[e.str])&&n.forEach(t)}),this.changes=[],this.patternObservers.length&&(n.forEach(function(t){return r_(r,t,!0)}),i.forEach(function(t){return r_(r,t)})),this.deps.observers&&(n.forEach(function(t){return Pr(r,null,t,"observers")}),Cr(this,i,"observers")),this.deps["default"]&&(o=[],n.forEach(function(t){return Pr(r,o,t,"default")}),o.length&&Mr(this,o,i),Cr(this,i,"default")),i.forEach(function(t){a[t.str]=r.get(t)}),this.implicitChanges={},this.noCascade={},a):void 0}function Pr(t,e,i,n){var o,r;(o=Tr(t,i,n))&&(r=t.get(i),o.forEach(function(t){e&&t.refineValue?e.push(t):t.setValue(r)}))}function Mr(t,e,i){e.forEach(function(e){for(var n=!1,o=0,r=i.length,s=[];r>o;){var a=i[o];if(a===e.keypath){n=!0;break}a.slice(0,e.keypath.length)===e.keypath&&s.push(a),o++}n&&e.setValue(t.get(e.keypath)),s.length&&e.refineValue(s)})}function Cr(t,e,i){function n(t){t.forEach(o),t.forEach(r)}function o(e){var n=Tr(t,e,i);n&&a.push({keypath:e,deps:n})}function r(e){var o;(o=t.depsMap[i][e.str])&&n(o)}function s(e){var i=t.get(e.keypath);e.deps.forEach(function(t){return t.setValue(i)})}var a=[];n(e),a.forEach(s)}function Tr(t,e,i){var n=t.deps[i];return n?n[e.str]:null}function Sr(){this.captureGroups.push([])}function Dr(t,e){var i,n;if(e||(n=this.wrapped[t])&&n.teardown()!==!1&&(this.wrapped[t]=null),this.cache[t]=void 0,i=this.cacheMap[t])for(;i.length;)this.clearCache(i.pop())}function Or(t,e){var i=e.firstKey;return!(i in t.data||i in t.computations||i in t.mappings)}function Ar(t,e){var i=new d_(t,e);return this.ready&&i.init(this),this.computations[t.str]=i}function Ir(t,e){var i,n,o,r,s,a=this.cache,h=t.str;if(e=e||g_,e.capture&&(r=R(this.captureGroups))&&(~r.indexOf(t)||r.push(t)),Ca.call(this.mappings,t.firstKey))return this.mappings[t.firstKey].get(t,e);if(t.isSpecial)return t.value;if(void 0===a[h]?((n=this.computations[h])&&!n.bypass?(i=n.get(),this.adapt(h,i)):(o=this.wrapped[h])?i=o.value:t.isRoot?(this.adapt("",this.data),i=this.data):i=Rr(this,t),a[h]=i):i=a[h],!e.noUnwrap&&(o=this.wrapped[h])&&(i=o.get()),t.isRoot&&e.fullRootGet)for(s in this.mappings)i[s]=this.mappings[s].getValue();return i===f_?void 0:i}function Rr(t,e){var i,n,o,r;return i=t.get(e.parent),(r=t.wrapped[e.parent.str])&&(i=r.get()),null!==i&&void 0!==i?((n=t.cacheMap[e.parent.str])?-1===n.indexOf(e.str)&&n.push(e.str):t.cacheMap[e.parent.str]=[e.str],"object"!=typeof i||e.lastKey in i?(o=i[e.lastKey],t.adapt(e.str,o,!1),t.cache[e.str]=o,o):t.cache[e.str]=f_):void 0}function zr(){var t;for(t in this.computations)this.computations[t].init(this)}function Ur(t,e){var i=this.mappings[t.str]=new y_(t,e);return i.initViewmodel(this),i}function Br(t,e){var i,n=t.str;e&&(e.implicit&&(this.implicitChanges[n]=!0),e.noCascade&&(this.noCascade[n]=!0)),(i=this.computations[n])&&i.invalidate(),-1===this.changes.indexOf(t)&&this.changes.push(t);var o=e?e.keepExistingWrapper:!1;this.clearCache(n,o),this.ready&&this.onchange()}function Nr(t,e,i,n){var o,r,s,a;if(this.mark(t),n&&n.compare){s=jr(n.compare);try{o=e.map(s),r=i.map(s)}catch(h){m('merge(): "%s" comparison failed. Falling back to identity checking',t),o=e,r=i}}else o=e,r=i;a=b_(o,r),this.smartUpdate(t,i,a,e.length!==i.length)}function Fr(t){return JSON.stringify(t)}function jr(t){if(t===!0)return Fr;if("string"==typeof t)return x_[t]||(x_[t]=function(e){return e[t]}),x_[t];if("function"==typeof t)return t;throw new Error("The `compare` option must be a function, or a string representing an identifying field (or `true` to use JSON.stringify)")}function Zr(t,e){var i,n,o,r=void 0===arguments[2]?"default":arguments[2];e.isStatic||((i=this.mappings[t.firstKey])?i.register(t,e,r):(n=this.deps[r]||(this.deps[r]={}),o=n[t.str]||(n[t.str]=[]),o.push(e),this.depsMap[r]||(this.depsMap[r]={}),t.isRoot||Hr(this,t,r)))}function Hr(t,e,i){for(var n,o,r;!e.isRoot;)n=t.depsMap[i],o=n[e.parent.str]||(n[e.parent.str]=[]),r=e.str,void 0===o["_"+r]&&(o["_"+r]=0,o.push(e)),o["_"+r]+=1,e=e.parent}function Vr(){return this.captureGroups.pop()}function Wr(t){this.data=t,this.clearCache("")}function Gr(t,e){var i,n,o,r,s=void 0===arguments[2]?{}:arguments[2];if(!s.noMapping&&(i=this.mappings[t.firstKey]))return i.set(t,e);if(n=this.computations[t.str]){if(n.setting)return;n.set(e),e=n.get()}a(this.cache[t.str],e)||(o=this.wrapped[t.str],o&&o.reset&&(r=o.reset(e)!==!1,r&&(e=o.get())),n||r||qr(this,t,e),s.silent?this.clearCache(t.str):this.mark(t))}function qr(t,e,i){var n,o,r,s;r=function(){n.set?n.set(e.lastKey,i):(o=n.get(),s())},s=function(){o||(o=Kv(e.lastKey),t.set(e.parent,o,{silent:!0})),o[e.lastKey]=i},n=t.wrapped[e.parent.str],n?r():(o=t.get(e.parent),(n=t.wrapped[e.parent.str])?r():s())}function Yr(t,e,i){var n,o,r,s=this;if(o=i.length,i.forEach(function(e,i){-1===e&&s.mark(t.join(i),S_)}),this.set(t,e,{silent:!0}),(n=this.deps["default"][t.str])&&n.filter(Jr).forEach(function(t){return t.shuffle(i,e)}),o!==e.length){for(this.mark(t.join("length"),T_),r=i.touchedFrom;r<e.length;r+=1)this.mark(t.join(r));for(r=e.length;o>r;r+=1)this.mark(t.join(r),S_)}}function Jr(t){return"function"==typeof t.shuffle}function $r(){var t,e=this;for(Object.keys(this.cache).forEach(function(t){return e.clearCache(t)});t=this.unresolvedImplicitDependencies.pop();)t.teardown()}function Kr(t,e){var i,n,o,r=void 0===arguments[2]?"default":arguments[2];if(!e.isStatic){if(i=this.mappings[t.firstKey])return i.unregister(t,e,r);if(n=this.deps[r][t.str],o=n.indexOf(e),-1===o)throw new Error("Attempted to remove a dependant that was no longer registered! This should not happen. If you are seeing this bug in development please raise an issue at https://github.com/RactiveJS/Ractive/issues - thanks");n.splice(o,1),t.isRoot||Qr(this,t,r)}}function Qr(t,e,i){for(var n,o;!e.isRoot;)n=t.depsMap[i],o=n[e.parent.str],o["_"+e.str]-=1,o["_"+e.str]||(z(o,e),o["_"+e.str]=void 0),e=e.parent}function Xr(t){this.hook=new ih(t),this.inProcess={},this.queue={}}function ts(t,e){return t[e._guid]||(t[e._guid]=[])}function es(t,e){var i=ts(t.queue,e);for(t.hook.fire(e);i.length;)es(t,i.shift());delete t.queue[e._guid]}function is(t,e){var i,n={};for(i in e)n[i]=ns(t,i,e[i]);return n}function ns(t,e,i){var n,o;return"function"==typeof i&&(n=rs(i,t)),"string"==typeof i&&(n=os(t,i)),"object"==typeof i&&("string"==typeof i.get?n=os(t,i.get):"function"==typeof i.get?n=rs(i.get,t):c("`%s` computation must have a `get()` method",e),"function"==typeof i.set&&(o=rs(i.set,t))),{getter:n,setter:o}}function os(t,e){var i,n,o;return i="return ("+e.replace(U_,function(t,e){return n=!0,'__ractive.get("'+e+'")'})+");",n&&(i="var __ractive = this; "+i),o=new Function(i),n?o.bind(t):o}function rs(t,e){return/this/.test(t.toString())?t.bind(e):t}function ss(e){var i,o,r=void 0===arguments[1]?{}:arguments[1],s=void 0===arguments[2]?{}:arguments[2];if(Gy.DEBUG&&Ma(),ls(e,s),ba(e,"data",{get:us}),B_.fire(e,r),Z_.forEach(function(t){e[t]=n(wa(e.constructor[t]||null),r[t])}),o=new I_({adapt:as(e,e.adapt,r),data:jl.init(e.constructor,e,r),computed:z_(e,n(wa(e.constructor.prototype.computed),r.computed)),mappings:s.mappings,ractive:e,onchange:function(){return mh.addRactive(e)}}),e.viewmodel=o,o.init(),_p.init(e.constructor,e,r),N_.fire(e),F_.begin(e),e.template){var a=void 0;(s.cssIds||e.cssId)&&(a=s.cssIds?s.cssIds.slice():[],e.cssId&&a.push(e.cssId)),e.fragment=new _y({template:e.template,root:e,owner:e,cssIds:a})}if(F_.end(e),i=t(e.el)){var h=e.render(i,e.append);Gy.DEBUG_PROMISES&&h["catch"](function(t){throw g("Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\n  Ractive.DEBUG_PROMISES = false;"),m("An error happened during rendering",{ractive:e}),t.stack&&d(t.stack),t})}}function as(t,e,i){function n(e){return"string"==typeof e&&(e=v("adaptors",t,e),e||c(Ra(e,"adaptor"))),e}var o,r,s;if(e=e.map(n),o=I(i.adapt).map(n),o=hs(e,o),r="magic"in i?i.magic:t.magic,s="modifyArrays"in i?i.modifyArrays:t.modifyArrays,r){if(!ia)throw new Error("Getters and setters (magic mode) are not supported in this browser");s&&o.push(e_),o.push(t_)}return s&&o.push(Jv),o}function hs(t,e){for(var i=t.slice(),n=e.length;n--;)~i.indexOf(e[n])||i.push(e[n]);return i}function ls(t,e){t._guid="r-"+j_++,t._subs=wa(null),t._config={},t._twowayBindings=wa(null),t._animations=[],t.nodes={},t._liveQueries=[],t._liveComponentQueries=[],t._boundFunctions=[],t._observers=[],e.component?(t.parent=e.parent,t.container=e.container||null,t.root=t.parent.root,t.component=e.component,e.component.instance=t,t._inlinePartials=e.inlinePartials):(t.root=t,t.parent=t.container=null)}function us(){throw new Error("Using `ractive.data` is no longer supported - you must use the `ractive.get()` API instead")}function cs(t,e,i){this.parentFragment=t.parentFragment,this.callback=i,this.fragment=new _y({template:e,root:t.root,owner:this}),this.update()}function ds(t,e,i){var n;return e.r?n=Wp(t,e.r,i):e.x?n=new Jp(t,t.parentFragment,e.x,i):e.rx&&(n=new Xp(t,e.rx,i)),n}function ps(t){return 1===t.length&&t[0].t===Yl}function fs(t,e){var i;for(i in e)e.hasOwnProperty(i)&&ms(t.instance,t.root,i,e[i])}function ms(t,e,i,n){"string"!=typeof n&&c("Components currently only support simple events - you cannot include arguments. Sorry!"),t.on(i,function(){var t,i;return arguments.length&&arguments[0]&&arguments[0].node&&(t=Array.prototype.shift.call(arguments)),i=Array.prototype.slice.call(arguments),jh(e,n,{event:t,args:i}),!1})}function gs(t,e){var i,n;if(!e)throw new Error('Component "'+this.name+'" not found');i=this.parentFragment=t.parentFragment,n=i.root,this.root=n,this.type=ru,this.name=t.template.e,this.index=t.index,this.indexRefBindings={},this.yielders={},this.resolvers=[],W_(this,e,t.template.a,t.template.f,t.template.p),G_(this,t.template.v),(t.template.t0||t.template.t1||t.template.t2||t.template.o)&&m('The "intro", "outro" and "decorator" directives have no effect on components',{ractive:this.instance}),q_(this)}function vs(t,e){function i(i){i.rebind(t,e)}var n;this.resolvers.forEach(i);for(var o in this.yielders)this.yielders[o][0]&&i(this.yielders[o][0]);(n=this.root._liveComponentQueries["_"+this.name])&&n._makeDirty()}function _s(){var t=this.instance;return t.render(this.parentFragment.getNode()),this.rendered=!0,t.fragment.detach()}function ys(){return this.instance.fragment.toString()}function ws(){var t=this.instance;this.resolvers.forEach(q),bs(this),t._observers.forEach(J),t.fragment.unbind(),t.viewmodel.teardown(),t.fragment.rendered&&t.el.__ractive_instances__&&z(t.el.__ractive_instances__,t),X_.fire(t)}function bs(t){var e,i;e=t.root;do(i=e._liveComponentQueries["_"+t.name])&&i._remove(t);while(e=e.parent)}function Ls(t){this.shouldDestroy=t,this.instance.unrender()}function xs(t){var e=this;this.owner=t.owner,this.parent=this.owner.parentFragment,this.root=t.root,this.pElement=t.pElement,this.context=t.context,this.index=t.index,this.key=t.key,this.registeredIndexRefs=[],this.cssIds="cssIds"in t?t.cssIds:this.parent?this.parent.cssIds:null,this.items=t.template.map(function(i,n){return ks({parentFragment:e,pElement:t.pElement,template:i,index:n})}),this.value=this.argsList=null,this.dirtyArgs=this.dirtyValue=!0,this.bound=!0}function ks(t){if("string"==typeof t.template)return new Ap(t);switch(t.template.t){case su:return new sy(t);case Yl:return new sf(t);case $l:return new Pf(t);case Jl:return new Vf(t);case Xl:var e=void 0;return(e=Dv(t.parentFragment.root,t.template.e))?new iy(t,e):new yv(t);case tu:return new Sv(t);case eu:return new oy(t);case hu:return new hy(t);default:throw new Error("Something very strange happened. Please file an issue at https://github.com/ractivejs/ractive/issues. Thanks!")}}function Es(t,e){(!this.owner||this.owner.hasContext)&&L(this,"context",t,e),this.items.forEach(function(i){i.rebind&&i.rebind(t,e)})}function Ps(){var t;return 1===this.items.length?t=this.items[0].render():(t=document.createDocumentFragment(),this.items.forEach(function(e){t.appendChild(e.render())})),this.rendered=!0,t}function Ms(t){return this.items?this.items.map(t?Ts:Cs).join(""):""}function Cs(t){return t.toString()}function Ts(t){return t.toString(!0)}function Ss(){this.bound&&(this.items.forEach(Ds),this.bound=!1)}function Ds(t){t.unbind&&t.unbind()}function Os(t){if(!this.rendered)throw new Error("Attempted to unrender a fragment that was not rendered");this.items.forEach(function(e){return e.unrender(t)}),this.rendered=!1}function As(t){var e,i,n,o,r;if(t=t||{},"object"!=typeof t)throw new Error("The reset method takes either no arguments, or an object containing new data");for((i=this.viewmodel.wrapped[""])&&i.reset?i.reset(t)===!1&&this.viewmodel.reset(t):this.viewmodel.reset(t),n=_p.reset(this),o=n.length;o--;)if(wy.indexOf(n[o])>-1){r=!0;break}if(r){var s=void 0;this.viewmodel.mark(qa),(s=this.component)&&(s.shouldDestroy=!0),this.unrender(),s&&(s.shouldDestroy=!1),this.fragment.template!==this.template&&(this.fragment.unbind(),this.fragment=new _y({template:this.template,root:this,owner:this})),e=this.render(this.el,this.anchor)}else e=mh.start(this,!0),this.viewmodel.mark(qa),mh.end();return by.fire(this,t),e}function Is(t){var e,i;hp.init(null,this,{template:t}),e=this.transitionsEnabled,this.transitionsEnabled=!1,(i=this.component)&&(i.shouldDestroy=!0),this.unrender(),i&&(i.shouldDestroy=!1),this.fragment.unbind(),this.fragment=new _y({template:this.template,root:this,owner:this}),this.render(this.el,this.anchor),this.transitionsEnabled=e}function Rs(t,e){var i,n;if(n=mh.start(this,!0),l(t)){i=t;for(t in i)i.hasOwnProperty(t)&&(e=i[t],zs(this,t,e))}else zs(this,t,e);return mh.end(),n}function zs(t,e,i){e=k(M(e)),e.isPattern?E(t,e).forEach(function(e){t.viewmodel.set(e,i)}):t.viewmodel.set(e,i)}function Us(t,e){return Ya(this,t,void 0===e?-1:-e)}function Bs(){var t;return this.fragment.unbind(),this.viewmodel.teardown(),this._observers.forEach(J),this.fragment.rendered&&this.el.__ractive_instances__&&z(this.el.__ractive_instances__,this),this.shouldDestroy=!0,t=this.fragment.rendered?this.unrender():sh.resolve(),Dy.fire(this),this._boundFunctions.forEach(Ns),t}function Ns(t){delete t.fn[t.prop]}function Fs(t){var e=this;if("string"!=typeof t)throw new TypeError(Aa);var i=void 0;return/\*/.test(t)?(i={},E(this,k(M(t))).forEach(function(t){i[t.str]=!e.viewmodel.get(t)}),this.set(i)):this.set(t,!this.get(t))}function js(){return this.fragment.toString(!0)}function Zs(){var t,e;if(!this.fragment.rendered)return m("ractive.unrender() was called on a Ractive instance that was not rendered"),sh.resolve();for(t=mh.start(this,!0),e=!this.component||this.component.shouldDestroy||this.shouldDestroy;this._animations[0];)this._animations[0].stop();return this.fragment.unrender(e),z(this.el.__ractive_instances__,this),Ry.fire(this),mh.end(),t}function Hs(t){var e;return t=k(t)||qa,e=mh.start(this,!0),this.viewmodel.mark(t),mh.end(),By.fire(this,t),e}function Vs(t,e){var i,n,o;if("string"!=typeof t||e){o=[];for(n in this._twowayBindings)(!t||k(n).equalsOrStartsWith(t))&&o.push.apply(o,this._twowayBindings[n])}else o=this._twowayBindings[t];return i=Ws(this,o),this.set(i)}function Ws(t,e){var i={},n=[];return e.forEach(function(t){var e,o;if(!t.radioName||t.element.node.checked){if(t.checkboxName)return void(n[t.keypath.str]||t.changed()||(n.push(t.keypath),n[t.keypath.str]=t));e=t.attribute.value,o=t.getValue(),A(e,o)||a(e,o)||(i[t.keypath.str]=o)}}),n.length&&n.forEach(function(t){var e,o,r;e=n[t.str],o=e.attribute.value,r=e.getValue(),A(o,r)||(i[t.str]=r)}),i}function Gs(t,e){return"function"==typeof e&&/_super/.test(t)}function qs(t){for(var e={};t;)Ys(t,e),$s(t,e),t=t._Parent!==Gy?t._Parent:!1;return e}function Ys(t,e){mp.forEach(function(i){Js(i.useDefaults?t.prototype:t,e,i.name)})}function Js(t,e,i){var n,o=Object.keys(t[i]);o.length&&((n=e[i])||(n=e[i]={}),o.filter(function(t){return!(t in n)}).forEach(function(e){return n[e]=t[i][e]}))}function $s(t,e){Object.keys(t.prototype).forEach(function(i){if("computed"!==i){var n=t.prototype[i];if(i in e){if("function"==typeof e[i]&&"function"==typeof n&&e[i]._method){var o=void 0,r=n._method;r&&(n=n._method),o=jy(e[i]._method,n),r&&(o._method=o),e[i]=o}}else e[i]=n._method?n._method:n}})}function Ks(){for(var t=arguments.length,e=Array(t),i=0;t>i;i++)e[i]=arguments[i];return e.length?e.reduce(Qs,this):Qs(this)}function Qs(t){var e,i,o=void 0===arguments[1]?{}:arguments[1];return o.prototype instanceof Gy&&(o=Zy(o)),e=function(t){return this instanceof e?void H_(this,t):new e(t)},i=wa(t.prototype),i.constructor=e,La(e,{defaults:{value:i},extend:{value:Ks,writable:!0,configurable:!0},_Parent:{value:t}}),_p.extend(t,i,o),jl.extend(t,i,o),o.computed&&(i.computed=n(wa(t.prototype.computed),o.computed)),e.prototype=i,e}var Xs,ta,ea,ia,na,oa,ra,sa=3,aa={el:void 0,append:!1,template:{v:sa,t:[]},preserveWhitespace:!1,sanitize:!1,stripComments:!0,delimiters:["{{","}}"],tripleDelimiters:["{{{","}}}"],interpolate:!1,data:{},computed:{},magic:!1,modifyArrays:!0,adapt:[],isolated:!1,twoway:!0,lazy:!1,noIntro:!1,transitionsEnabled:!0,complete:void 0,css:null,noCssTransform:!1},ha=aa,la={linear:function(t){return t},easeIn:function(t){return Math.pow(t,3)},easeOut:function(t){return Math.pow(t-1,3)+1},easeInOut:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)}};Xs="object"==typeof document,ta="undefined"!=typeof navigator&&/jsDom/.test(navigator.appName),ea="undefined"!=typeof console&&"function"==typeof console.warn&&"function"==typeof console.warn.apply;try{Object.defineProperty({},"test",{value:0}),ia=!0}catch(ua){ia=!1}na={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},oa="undefined"==typeof document?!1:document&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),ra=["o","ms","moz","webkit"];var ca,da,pa,fa,ma,ga,va,_a,ya;if(ca=oa?function(t,e){return e&&e!==na.html?document.createElementNS(e,t):document.createElement(t)}:function(t,e){if(e&&e!==na.html)throw"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information";return document.createElement(t)},Xs){for(pa=ca("div"),fa=["matches","matchesSelector"],ya=function(t){return function(e,i){return e[t](i)}},va=fa.length;va--&&!da;)if(ma=fa[va],pa[ma])da=ya(ma);else for(_a=ra.length;_a--;)if(ga=ra[va]+ma.substr(0,1).toUpperCase()+ma.substring(1),pa[ga]){da=ya(ga);break}da||(da=function(t,e){var i,n,o;for(n=t.parentNode,n||(pa.innerHTML="",n=pa,t=t.cloneNode(),pa.appendChild(t)),i=n.querySelectorAll(e),o=i.length;o--;)if(i[o]===t)return!0;return!1})}else da=null;var wa,ba,La,xa=null;try{Object.defineProperty({},"test",{value:0}),Xs&&Object.defineProperty(document.createElement("div"),"test",{value:0}),ba=Object.defineProperty}catch(ka){ba=function(t,e,i){t[e]=i.value}}try{try{Object.defineProperties({},{test:{value:0}})}catch(ka){throw ka}Xs&&Object.defineProperties(ca("div"),{test:{value:0}}),La=Object.defineProperties}catch(ka){La=function(t,e){var i;for(i in e)e.hasOwnProperty(i)&&ba(t,i,e[i])}}try{Object.create(null),wa=Object.create}catch(ka){wa=function(){var t=function(){};return function(e,i){var n;return null===e?{}:(t.prototype=e,n=new t,i&&Object.defineProperties(n,i),n)}}()}var Ea,Pa,Ma,Ca=Object.prototype.hasOwnProperty,Ta=Object.prototype.toString,Sa=/^\[object (?:Array|FileList)\]$/,Da=function(){},Oa={};ea?!function(){var t=["%cRactive.js %c0.7.3 %cin debug mode, %cmore...","color: rgb(114, 157, 52); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;"],e="You're running Ractive 0.7.3 in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://docs.ractivejs.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n";Ma=function(){var i=!!console.groupCollapsed;console[i?"groupCollapsed":"log"].apply(console,t),console.log(e),i&&console.groupEnd(t),Ma=Da},Pa=function(t,e){if(Ma(),"object"==typeof e[e.length-1]){var i=e.pop(),n=i?i.ractive:null;if(n){var o=void 0;n.component&&(o=n.component.name)&&(t="<"+o+"> "+t);var r=void 0;(r=i.node||n.fragment&&n.fragment.rendered&&n.find("*"))&&e.push(r)}}console.warn.apply(console,["%cRactive.js: %c"+t,"color: rgb(114, 157, 52);","color: rgb(85, 85, 85);"].concat(e))},Ea=function(){console.log.apply(console,arguments)}}():Pa=Ea=Ma=Da;var Aa="Bad arguments",Ia='A function was specified for "%s" %s, but no %s was returned',Ra=function(t,e){return'Missing "'+t+'" '+e+" plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#"+e+"s"},za=function(t,e,i,n){if(t===e)return y(e);if(n){var o=v("interpolators",i,n);if(o)return o(t,e)||y(e);c(Ra(n,"interpolator"))}return Na.number(t,e)||Na.array(t,e)||Na.object(t,e)||y(e)},Ua=za,Ba={number:function(t,e){var i;return h(t)&&h(e)?(t=+t,e=+e,i=e-t,i?function(e){return t+e*i}:function(){return t}):null},array:function(t,e){var i,n,o,s;if(!r(t)||!r(e))return null;for(i=[],n=[],s=o=Math.min(t.length,e.length);s--;)n[s]=Ua(t[s],e[s]);for(s=o;s<t.length;s+=1)i[s]=t[s];for(s=o;s<e.length;s+=1)i[s]=e[s];return function(t){for(var e=o;e--;)i[e]=n[e](t);return i}},object:function(t,e){var i,n,o,r,s;if(!l(t)||!l(e))return null;i=[],r={},o={};for(s in t)Ca.call(t,s)&&(Ca.call(e,s)?(i.push(s),o[s]=Ua(t[s],e[s])):r[s]=t[s]);for(s in e)Ca.call(e,s)&&!Ca.call(t,s)&&(r[s]=e[s]);return n=i.length,function(t){for(var e,s=n;s--;)e=i[s],r[e]=o[e](t);return r}}},Na=Ba,Fa=w,ja={},Za=/\[\s*(\*|[0-9]|[1-9][0-9]+)\s*\]/g,Ha=/\*/,Va={},Wa=function(t){var e=t.split(".");this.str=t,"@"===t[0]&&(this.isSpecial=!0,this.value=x(t)),this.firstKey=e[0],this.lastKey=e.pop(),this.isPattern=Ha.test(t),this.parent=""===t?null:k(e.join(".")),this.isRoot=!t};Wa.prototype={equalsOrStartsWith:function(t){return t===this||this.startsWith(t)},join:function(t){return k(this.isRoot?String(t):this.str+"."+t)},replace:function(t,e){return this===t?e:this.startsWith(t)?null===e?e:k(this.str.replace(t.str+".",e.str+".")):void 0},startsWith:function(t){return t?t&&this.str.substr(0,t.str.length+1)===t.str+".":!1},toString:function(){throw new Error("Bad coercion")},valueOf:function(){throw new Error("Bad coercion")},wildcardMatches:function(){return this._wildcardMatches||(this._wildcardMatches=Fa(this.str))}};var Ga,qa=k(""),Ya=C,Ja="Cannot add to a non-numeric value",$a=T;"undefined"==typeof window?Ga=null:(!function(t,e,i){var n,o;if(!i.requestAnimationFrame){for(n=0;n<t.length&&!i.requestAnimationFrame;++n)i.requestAnimationFrame=i[t[n]+"RequestAnimationFrame"];i.requestAnimationFrame||(o=i.setTimeout,i.requestAnimationFrame=function(t){var i,n,r;return i=Date.now(),n=Math.max(0,16-(i-e)),r=o(function(){t(i+n)},n),e=i+n,r})}}(ra,0,window),Ga=window.requestAnimationFrame);var Ka,Qa=Ga;Ka="undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};var Xa=Ka,th={construct:{deprecated:"beforeInit",replacement:"onconstruct"},render:{deprecated:"init",message:'The "init" method has been deprecated and will likely be removed in a future release. You can either use the "oninit" method which will fire only once prior to, and regardless of, any eventual ractive instance being rendered, or if you need to access the rendered DOM, use "onrender" instead. See http://docs.ractivejs.org/latest/migrating for more information.'},complete:{deprecated:"complete",replacement:"oncomplete"}};S.prototype.fire=function(t,e){function i(i){return t[i]?(e?t[i](e):t[i](),!0):void 0}i(this.method),!t[this.method]&&this.deprecate&&i(this.deprecate.deprecated)&&(this.deprecate.message?m(this.deprecate.message):m('The method "%s" has been deprecated in favor of "%s" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.',this.deprecate.deprecated,this.deprecate.replacement)),e?t.fire(this.event,e):t.fire(this.event)};var eh,ih=S,nh={},oh={},rh={};"function"==typeof Promise?eh=Promise:(eh=function(t){var e,i,n,o,r,s,a=[],h=[],l=nh;n=function(t){return function(n){l===nh&&(e=n,l=t,i=N(l===oh?a:h,e),B(i))}},o=n(oh),r=n(rh);try{t(o,r)}catch(u){r(u)}return s={then:function(t,e){var n=new eh(function(o,r){var s=function(t,e,i){"function"==typeof t?e.push(function(e){var i;try{i=t(e),F(n,i,o,r)}catch(s){r(s)}}):e.push(i)};s(t,a,o),s(e,h,r),l!==nh&&B(i)});return n}},s["catch"]=function(t){return this.then(null,t)},s},eh.all=function(t){return new eh(function(e,i){var n,o,r,s=[];if(!t.length)return void e(s);for(r=function(t,o){t&&"function"==typeof t.then?t.then(function(t){s[o]=t,--n||e(s)},i):(s[o]=t,--n||e(s))},n=o=t.length;o--;)r(t[o],o)})},eh.resolve=function(t){return new eh(function(e){e(t)})},eh.reject=function(t){return new eh(function(e,i){i(t)})});var sh=eh,ah=function(t){do if(void 0!==t.context)return t.context;while(t=t.parent);return qa},hh=j,lh=function(t,e){this.callback=t,this.parent=e,this.intros=[],this.outros=[],this.children=[],this.totalChildren=this.outroChildren=0,this.detachQueue=[],this.decoratorQueue=[],this.outrosComplete=!1,e&&e.addChild(this)};lh.prototype={addChild:function(t){this.children.push(t),this.totalChildren+=1,this.outroChildren+=1},decrementOutros:function(){this.outroChildren-=1,Q(this)},decrementTotal:function(){this.totalChildren-=1,Q(this)},add:function(t){var e=t.isIntro?this.intros:this.outros;e.push(t)},addDecorator:function(t){this.decoratorQueue.push(t)},remove:function(t){var e=t.isIntro?this.intros:this.outros;z(e,t),Q(this)},init:function(){this.ready=!0,Q(this)},detachNodes:function(){this.decoratorQueue.forEach(G),this.detachQueue.forEach($),this.children.forEach(K)}};var uh,ch,dh=lh,ph=[],fh=new ih("change");ch={start:function(t,e){var i,n;return e&&(i=new sh(function(t){return n=t})),uh={previousBatch:uh,transitionManager:new dh(n,uh&&uh.transitionManager),views:[],tasks:[],ractives:[],instance:t},t&&uh.ractives.push(t),i},end:function(){X(),uh.transitionManager.init(),!uh.previousBatch&&uh.instance&&(uh.instance.viewmodel.changes=[]),uh=uh.previousBatch},addRactive:function(t){uh&&D(uh.ractives,t)},registerTransition:function(t){t._manager=uh.transitionManager,uh.transitionManager.add(t)},registerDecorator:function(t){uh.transitionManager.addDecorator(t)},addView:function(t){uh.views.push(t)},addUnresolved:function(t){ph.push(t)},removeUnresolved:function(t){z(ph,t)},detachWhenReady:function(t){uh.transitionManager.detachQueue.push(t)},scheduleTask:function(t,e){var i;if(uh){for(i=uh;e&&i.previousBatch;)i=i.previousBatch;i.tasks.push(t)}else t()}};var mh=ch,gh=[],vh={tick:function(){var t,e,i;for(i=Xa(),mh.start(),t=0;t<gh.length;t+=1)e=gh[t],e.tick(i)||gh.splice(t--,1);mh.end(),gh.length?Qa(vh.tick):vh.running=!1},add:function(t){gh.push(t),vh.running||(vh.running=!0,Qa(vh.tick))},abort:function(t,e){for(var i,n=gh.length;n--;)i=gh[n],i.root===e&&i.keypath===t&&i.stop()}},_h=vh,yh=function(t){var e;this.startTime=Date.now();for(e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this.interpolator=Ua(this.from,this.to,this.root,this.interpolator),this.running=!0,this.tick()};yh.prototype={tick:function(){var t,e,i,n,o,r;return r=this.keypath,this.running?(n=Date.now(),t=n-this.startTime,t>=this.duration?(null!==r&&(mh.start(this.root),this.root.viewmodel.set(r,this.to),mh.end()),this.step&&this.step(1,this.to),this.complete(this.to),o=this.root._animations.indexOf(this),-1===o&&m("Animation was not found"),this.root._animations.splice(o,1),
this.running=!1,!1):(e=this.easing?this.easing(t/this.duration):t/this.duration,null!==r&&(i=this.interpolator(e),mh.start(this.root),this.root.viewmodel.set(r,i),mh.end()),this.step&&this.step(e,i),!0)):!1},stop:function(){var t;this.running=!1,t=this.root._animations.indexOf(this),-1===t&&m("Animation was not found"),this.root._animations.splice(t,1)}};var wh=yh,bh=it,Lh={stop:Da},xh=ot,kh=new ih("detach"),Eh=rt,Ph=st,Mh=function(){var t,e,i;t=this._root[this._isComponentQuery?"liveComponentQueries":"liveQueries"],e=this.selector,i=t.indexOf(e),-1!==i&&(t.splice(i,1),t[e]=null)},Ch=function(t,e){var i,n,o,r,s,a,h,l,u,c;for(i=ht(t.component||t._ractive.proxy),n=ht(e.component||e._ractive.proxy),o=R(i),r=R(n);o&&o===r;)i.pop(),n.pop(),s=o,o=R(i),r=R(n);if(o=o.component||o,r=r.component||r,u=o.parentFragment,c=r.parentFragment,u===c)return a=u.items.indexOf(o),h=c.items.indexOf(r),a-h||i.length-n.length;if(l=s.fragments)return a=l.indexOf(u),h=l.indexOf(c),a-h||i.length-n.length;throw new Error("An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/RactiveJS/Ractive/issues - thanks!")},Th=function(t,e){var i;return t.compareDocumentPosition?(i=t.compareDocumentPosition(e),2&i?1:-1):Ch(t,e)},Sh=function(){this.sort(this._isComponentQuery?Ch:Th),this._dirty=!1},Dh=function(){var t=this;this._dirty||(this._dirty=!0,mh.scheduleTask(function(){t._sort()}))},Oh=function(t){var e=this.indexOf(this._isComponentQuery?t.instance:t);-1!==e&&this.splice(e,1)},Ah=lt,Ih=ut,Rh=ct,zh=dt,Uh=pt,Bh=ft,Nh={enqueue:function(t,e){t.event&&(t._eventQueue=t._eventQueue||[],t._eventQueue.push(t.event)),t.event=e},dequeue:function(t){t._eventQueue&&t._eventQueue.length?t.event=t._eventQueue.pop():delete t.event}},Fh=Nh,jh=mt,Zh=_t,Hh=yt,Vh={capture:!0,noUnwrap:!0,fullRootGet:!0},Wh=wt,Gh=new ih("insert"),qh=Lt,Yh=function(t,e,i,n){this.root=t,this.keypath=e,this.callback=i,this.defer=n.defer,this.context=n&&n.context?n.context:t};Yh.prototype={init:function(t){this.value=this.root.get(this.keypath.str),t!==!1?this.update():this.oldValue=this.value},setValue:function(t){var e=this;a(t,this.value)||(this.value=t,this.defer&&this.ready?mh.scheduleTask(function(){return e.update()}):this.update())},update:function(){this.updating||(this.updating=!0,this.callback.call(this.context,this.value,this.oldValue,this.keypath.str),this.oldValue=this.value,this.updating=!1)}};var Jh,$h=Yh,Kh=xt,Qh=Array.prototype.slice;Jh=function(t,e,i,n){this.root=t,this.callback=i,this.defer=n.defer,this.keypath=e,this.regex=new RegExp("^"+e.str.replace(/\./g,"\\.").replace(/\*/g,"([^\\.]+)")+"$"),this.values={},this.defer&&(this.proxies=[]),this.context=n&&n.context?n.context:t},Jh.prototype={init:function(t){var e,i;if(e=Kh(this.root,this.keypath),t!==!1)for(i in e)e.hasOwnProperty(i)&&this.update(k(i));else this.values=e},update:function(t){var e,i=this;if(t.isPattern){e=Kh(this.root,t);for(t in e)e.hasOwnProperty(t)&&this.update(k(t))}else if(!this.root.viewmodel.implicitChanges[t.str])return this.defer&&this.ready?void mh.scheduleTask(function(){return i.getProxy(t).update()}):void this.reallyUpdate(t)},reallyUpdate:function(t){var e,i,n,o;return e=t.str,i=this.root.viewmodel.get(t),this.updating?void(this.values[e]=i):(this.updating=!0,a(i,this.values[e])&&this.ready||(n=Qh.call(this.regex.exec(e),1),o=[i,this.values[e],e].concat(n),this.values[e]=i,this.callback.apply(this.context,o)),void(this.updating=!1))},getProxy:function(t){var e=this;return this.proxies[t.str]||(this.proxies[t.str]={update:function(){return e.reallyUpdate(t)}}),this.proxies[t.str]}};var Xh,tl,el,il,nl,ol,rl=Jh,sl=kt,al={},hl=Et,ll=Pt,ul=function(t){return t.trim()},cl=function(t){return""!==t},dl=Mt,pl=Ct,fl=Tt,ml=St,gl=Array.prototype,vl=function(t){return function(e){for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;i>o;o++)n[o-1]=arguments[o];var s,a,h,l,u=[];if(e=k(M(e)),s=this.viewmodel.get(e),a=s.length,!r(s))throw new Error("Called ractive."+t+"('"+e.str+"'), but '"+e.str+"' does not refer to an array");return u=ml(s,t,n),l=gl[t].apply(s,n),h=mh.start(this,!0).then(function(){return l}),u?this.viewmodel.smartUpdate(e,s,u):this.viewmodel.mark(e),mh.end(),h}},_l=vl("pop"),yl=vl("push"),wl="/* Ractive.js component styles */\n",bl=[],Ll=!1;Xs?(el=document.createElement("style"),el.type="text/css",il=document.getElementsByTagName("head")[0],ol=!1,nl=el.styleSheet,tl=function(){var t=wl+bl.map(function(t){return"\n/* {"+t.id+"} */\n"+t.styles}).join("\n");nl?nl.cssText=t:el.innerHTML=t,ol||(il.appendChild(el),ol=!0)},Xh={add:function(t){bl.push(t),Ll=!0},apply:function(){Ll&&(tl(),Ll=!1)}}):Xh={add:Da,apply:Da};var xl,kl,El=Xh,Pl=Ot,Ml=new ih("render"),Cl=new ih("complete"),Tl={extend:function(t,e,i){e.adapt=It(e.adapt,I(i.adapt))},init:function(){}},Sl=Tl,Dl=Rt,Ol=/(?:^|\})?\s*([^\{\}]+)\s*\{/g,Al=/\/\*.*?\*\//g,Il=/((?:(?:\[[^\]+]\])|(?:[^\s\+\>\~:]))+)((?::[^\s\+\>\~\(]+(?:\([^\)]+\))?)?\s*[\s\+\>\~]?)\s*/g,Rl=/^@media/,zl=/\[data-ractive-css~="\{[a-z0-9-]+\}"]/g,Ul=1,Bl={name:"css",extend:function(t,e,i){if(i.css){var n=Ul++,o=i.noCssTransform?i.css:Dl(i.css,n);e.cssId=n,El.add({id:n,styles:o})}},init:function(){}},Nl=Bl,Fl={name:"data",extend:function(t,e,i){var n=void 0,o=void 0;if(i.data&&l(i.data))for(n in i.data)o=i.data[n],o&&"object"==typeof o&&(l(o)||r(o))&&m("Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }");e.data=Nt(e.data,i.data)},init:function(t,e,i){var n=Nt(t.prototype.data,i.data);return"function"==typeof n&&(n=n.call(e)),n||{}},reset:function(t){var e=this.init(t.constructor,t,t.viewmodel);return t.viewmodel.reset(e),!0}},jl=Fl,Zl=/^\s+/;kl=function(t){this.name="ParseError",this.message=t;try{throw new Error(t)}catch(e){this.stack=e.stack}},kl.prototype=Error.prototype,xl=function(t,e){var i,n,o=0;for(this.str=t,this.options=e||{},this.pos=0,this.lines=this.str.split("\n"),this.lineEnds=this.lines.map(function(t){var e=o+t.length+1;return o=e,e},0),this.init&&this.init(t,e),i=[];this.pos<this.str.length&&(n=this.read());)i.push(n);this.leftover=this.remaining(),this.result=this.postProcess?this.postProcess(i,e):i},xl.prototype={read:function(t){var e,i,n,o;for(t||(t=this.converters),e=this.pos,n=t.length,i=0;n>i;i+=1)if(this.pos=e,o=t[i](this))return o;return null},getLinePos:function(t){for(var e,i=0,n=0;t>=this.lineEnds[i];)n=this.lineEnds[i],i+=1;return e=t-n,[i+1,e+1,t]},error:function(t){var e=this.getLinePos(this.pos),i=e[0],n=e[1],o=this.lines[e[0]-1],r=0,s=o.replace(/\t/g,function(t,i){return i<e[1]&&(r+=1),"  "})+"\n"+new Array(e[1]+r).join(" ")+"^----",a=new kl(""+t+" at line "+i+" character "+n+":\n"+s);throw a.line=e[0],a.character=e[1],a.shortMessage=t,a},matchString:function(t){return this.str.substr(this.pos,t.length)===t?(this.pos+=t.length,t):void 0},matchPattern:function(t){var e;return(e=t.exec(this.remaining()))?(this.pos+=e[0].length,e[1]||e[0]):void 0},allowWhitespace:function(){this.matchPattern(Zl)},remaining:function(){return this.str.substring(this.pos)},nextChar:function(){return this.str.charAt(this.pos)}},xl.extend=function(t){var e,i,n=this;e=function(t,e){xl.call(this,t,e)},e.prototype=wa(n.prototype);for(i in t)Ca.call(t,i)&&(e.prototype[i]=t[i]);return e.extend=xl.extend,e};var Hl,Vl,Wl,Gl=xl,ql=1,Yl=2,Jl=3,$l=4,Kl=5,Ql=6,Xl=7,tu=8,eu=9,iu=10,nu=13,ou=14,ru=15,su=16,au=17,hu=18,lu=20,uu=21,cu=22,du=23,pu=24,fu=25,mu=26,gu=27,vu=30,_u=31,yu=32,wu=33,bu=34,Lu=35,xu=36,ku=40,Eu=50,Pu=51,Mu=52,Cu=53,Tu=54,Su=60,Du=61,Ou=Zt,Au=/^[^\s=]+/,Iu=/^\s+/,Ru=Ht,zu=/^(\/(?:[^\n\r\u2028\u2029\/\\[]|\\.|\[(?:[^\n\r\u2028\u2029\]\\]|\\.)*])+\/(?:([gimuy])(?![a-z]*\2))*(?![a-zA-Z_$0-9]))/,Uu=Vt,Bu={t:iu,exclude:!0},Nu="Expected a JavaScript expression",Fu="Expected closing paren",ju=Gt,Zu=/^(?:[+-]?)0*(?:(?:(?:[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,Hu=qt;Hl=/^(?=.)[^"'\\]+?(?:(?!.)|(?=["'\\]))/,Vl=/^\\(?:['"\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/,Wl=/^\\(?:\r\n|[\u000A\u000D\u2028\u2029])/;var Vu,Wu,Gu=function(t){return function(e){var i,n,o,r;for(i=e.pos,n='"',o=!1;!o;)r=e.matchPattern(Hl)||e.matchPattern(Vl)||e.matchString(t),r?n+='"'===r?'\\"':"\\'"===r?"'":r:(r=e.matchPattern(Wl),r?n+="\\u"+("000"+r.charCodeAt(1).toString(16)).slice(-4):o=!0);return n+='"',JSON.parse(n)}},qu=Gu('"'),Yu=Gu("'"),Ju=function(t){var e,i;return e=t.pos,t.matchString('"')?(i=Yu(t),t.matchString('"')?{t:uu,v:i}:(t.pos=e,null)):t.matchString("'")?(i=qu(t),t.matchString("'")?{t:uu,v:i}:(t.pos=e,null)):null},$u=/^[a-zA-Z_$][a-zA-Z_$0-9]*/,Ku=Yt,Qu=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/,Xu=Jt,tc=$t,ec=function(t){var e,i;return e=t.pos,t.allowWhitespace(),t.matchString("{")?(i=tc(t),t.allowWhitespace(),t.matchString("}")?{t:du,m:i}:(t.pos=e,null)):(t.pos=e,null)},ic=Kt,nc=function(t){var e,i;return e=t.pos,t.allowWhitespace(),t.matchString("[")?(i=ic(t),t.matchString("]")?{t:cu,m:i}:(t.pos=e,null)):(t.pos=e,null)},oc=Qt,rc=Xt,sc=/^(?:~\/|(?:\.\.\/)+|\.\/(?:\.\.\/)*|\.)/;Vu=/^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null)\b/,Wu=/^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;var ac,hc,lc=/^[a-zA-Z$_0-9]+(?:(?:\.[a-zA-Z$_0-9]+)|(?:\[[0-9]+\]))*/,uc=/^[a-zA-Z_$][-a-zA-Z_$0-9]*/,cc=te,dc=function(t){return oc(t)||rc(t)||cc(t)},pc=ee,fc=function(t){var e,i,n,o;if(i=dc(t),!i)return null;for(;i;)if(e=t.pos,n=pc(t))i={t:yu,x:i,r:n};else{if(!t.matchString("("))break;t.allowWhitespace(),o=ic(t),t.allowWhitespace(),t.matchString(")")||t.error(Fu),i={t:ku,x:i},o&&(i.o=o)}return i};hc=function(t,e){return function(i){var n;return(n=e(i))?n:i.matchString(t)?(i.allowWhitespace(),n=Cc(i),n||i.error(Nu),{s:t,o:n,t:wu}):null}},function(){var t,e,i,n,o;for(n="! ~ + - typeof".split(" "),o=fc,t=0,e=n.length;e>t;t+=1)i=hc(n[t],o),o=i;ac=o}();var mc,gc,vc=ac;gc=function(t,e){return function(i){var n,o,r;if(o=e(i),!o)return null;for(;;){if(n=i.pos,i.allowWhitespace(),!i.matchString(t))return i.pos=n,o;if("in"===t&&/[a-zA-Z_$0-9]/.test(i.remaining().charAt(0)))return i.pos=n,o;if(i.allowWhitespace(),r=e(i),!r)return i.pos=n,o;o={t:xu,s:t,o:[o,r]}}}},function(){var t,e,i,n,o;for(n="* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||".split(" "),o=vc,t=0,e=n.length;e>t;t+=1)i=gc(n[t],o),o=i;mc=o}();var _c,yc,wc,bc,Lc,xc,kc,Ec,Pc=mc,Mc=ie,Cc=ne,Tc=oe,Sc=se,Dc=/^[0-9][1-9]*$/,Oc=he,Ac=le,Ic=ue,Rc=ce,zc=de,Uc=pe,Bc=fe,Nc=/^yield\s*/,Fc=me,jc=ge,Zc=/^\s*else\s*/,Hc=ve,Vc=/^\s*elseif\s+/,Wc={each:Mu,"if":Eu,"if-with":Tu,"with":Cu,unless:Pu},Gc=_e,qc=/^\s*:\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,Yc=/^\s*,\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,Jc=new RegExp("^("+Object.keys(Wc).join("|")+")\\b"),$c=xe,Kc="<!--",Qc="-->";_c=/^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i,yc=/^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i,wc={quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,"int":8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},bc=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376],Lc=new RegExp("&(#?(?:x[\\w\\d]+|\\d+|"+Object.keys(wc).join("|")+"));?","g"),xc=/</g,kc=/>/g,Ec=/&/g;var Xc,td,ed,id,nd,od,rd,sd=/^\s*\r?\n/,ad=/\r?\n\s*$/,hd=function(t){var e,i,n,o,r;for(e=1;e<t.length;e+=1)i=t[e],n=t[e-1],o=t[e-2],Me(i)&&Ce(n)&&Me(o)&&ad.test(o)&&sd.test(i)&&(t[e-2]=o.replace(ad,"\n"),t[e]=i.replace(sd,"")),Te(i)&&Me(n)&&ad.test(n)&&Me(i.f[0])&&sd.test(i.f[0])&&(t[e-1]=n.replace(ad,"\n"),i.f[0]=i.f[0].replace(sd,"")),Me(i)&&Te(n)&&(r=R(n.f),Me(r)&&ad.test(r)&&sd.test(i)&&(n.f[n.f.length-1]=r.replace(ad,"\n"),t[e]=i.replace(sd,"")));return t},ld=function(t,e,i){var n;e&&(n=t[0],"string"==typeof n&&(n=n.replace(e,""),n?t[0]=n:t.shift())),i&&(n=R(t),"string"==typeof n&&(n=n.replace(i,""),n?t[t.length-1]=n:t.pop()))},ud=Se,cd=/[ \t\f\r\n]+/g,dd=/^(?:pre|script|style|textarea)$/i,pd=/^[ \t\f\r\n]+/,fd=/[ \t\f\r\n]+$/,md=/^(?:\r\n|\r|\n)/,gd=/(?:\r\n|\r|\n)$/,vd=De,_d=/^([a-zA-Z]{1,}:?[a-zA-Z0-9\-]*)\s*\>/,yd=function(t,e){var i,n,o;for(i=e.length;i--;){if(n=t.indexOf(e[i]),!n)return 0;-1!==n&&(!o||o>n)&&(o=n)}return o||-1},wd=Oe,bd=/^[^\s"'>\/=]+/,Ld=/^[^\s"'=<>`]+/;td={"true":!0,"false":!1,undefined:void 0,"null":null},ed=new RegExp("^(?:"+Object.keys(td).join("|")+")"),id=/^(?:[+-]?)(?:(?:(?:0|[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,nd=/\$\{([^\}]+)\}/g,od=/^\$\{([^\}]+)\}/,rd=/^\s*$/,Xc=Gl.extend({init:function(t,e){this.values=e.values,this.allowWhitespace()},postProcess:function(t){return 1===t.length&&rd.test(this.leftover)?{value:t[0].v}:null},converters:[function(t){var e;return t.values?(e=t.matchPattern(od),e&&t.values.hasOwnProperty(e)?{v:t.values[e]}:void 0):null},function(t){var e;return(e=t.matchPattern(ed))?{v:td[e]}:void 0},function(t){var e;return(e=t.matchPattern(id))?{v:+e}:void 0},function(t){var e,i=Ju(t);return i&&(e=t.values)?{v:i.v.replace(nd,function(t,i){return i in e?e[i]:i})}:i},function(t){var e,i;if(!t.matchString("{"))return null;if(e={},t.allowWhitespace(),t.matchString("}"))return{v:e};for(;i=Be(t);){if(e[i.key]=i.value,t.allowWhitespace(),t.matchString("}"))return{v:e};if(!t.matchString(","))return null}return null},function(t){var e,i;if(!t.matchString("["))return null;if(e=[],t.allowWhitespace(),t.matchString("]"))return{v:e};for(;i=t.read();){if(e.push(i.v),t.allowWhitespace(),t.matchString("]"))return{v:e};if(!t.matchString(","))return null;t.allowWhitespace()}return null}]});var xd,kd=function(t,e){var i=new Xc(t,{values:e});return i.result},Ed=Ne,Pd=/^([a-zA-Z_$][a-zA-Z_$0-9]*)\(/,Md=/\)\s*$/;xd=Gl.extend({converters:[Cc]});var Cd,Td=/^[a-zA-Z]{1,}:?[a-zA-Z0-9\-]*/,Sd=/^[\s\n\/>]/,Dd=/^on/,Od=/^on-([a-zA-Z\\*\\.$_][a-zA-Z\\*\\.$_0-9\-]+)$/,Ad=/^(?:change|reset|teardown|update|construct|config|init|render|unrender|detach|insert)$/,Id={"intro-outro":"t0",intro:"t1",outro:"t2",decorator:"o"},Rd={exclude:!0};Cd={li:["li"],dt:["dt","dd"],dd:["dt","dd"],p:"address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul".split(" "),rt:["rt","rp"],rp:["rt","rp"],optgroup:["optgroup"],option:["option","optgroup"],thead:["tbody","tfoot"],tbody:["tbody","tfoot"],tfoot:["tbody"],tr:["tr","tbody"],td:["td","th","tr"],th:["td","th","tr"]};var zd,Ud=Fe,Bd=Ze,Nd=He,Fd=/[-\/\\^$*+?.()|[\]{}]/g,jd=Ve,Zd=/^<!--\s*/,Hd=/s*>\s*([a-zA-Z_$][-a-zA-Z_$0-9]*)\s*/,Vd=/\s*-->/,Wd=We,Gd=/^#\s*partial\s+/,qd=Ge,Yd=qe,Jd=[Ic,Ac,Gc,Bc,Uc,Rc],$d=[Oc],Kd=[Ac,Gc,Uc],Qd=void 0,Xd=[Uu,$c,Ud,Bd],tp=[jd,Wd];Qd=Gl.extend({init:function(t,e){var i=e.tripleDelimiters||["{{{","}}}"],n=e.staticDelimiters||["[[","]]"],o=e.staticTripleDelimiters||["[[[","]]]"];this.standardDelimiters=e.delimiters||["{{","}}"],this.tags=[{isStatic:!1,isTriple:!1,open:this.standardDelimiters[0],close:this.standardDelimiters[1],readers:Jd},{isStatic:!1,isTriple:!0,open:i[0],close:i[1],readers:$d},{isStatic:!0,isTriple:!1,open:n[0],close:n[1],readers:Kd},{isStatic:!0,isTriple:!0,open:o[0],close:o[1],readers:$d}],this.sortMustacheTags(),this.sectionDepth=0,this.elementStack=[],this.interpolate={script:!e.interpolate||e.interpolate.script!==!1,style:!e.interpolate||e.interpolate.style!==!1},e.sanitize===!0&&(e.sanitize={elements:"applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title".split(" "),eventAttributes:!0}),this.stripComments=e.stripComments!==!1,this.preserveWhitespace=e.preserveWhitespace,this.sanitizeElements=e.sanitize&&e.sanitize.elements,this.sanitizeEventAttributes=e.sanitize&&e.sanitize.eventAttributes,this.includeLinePositions=e.includeLinePositions},postProcess:function(t){return t.length?(this.sectionDepth>0&&this.error("A section was left open"),ud(t[0].t,this.stripComments,this.preserveWhitespace,!this.preserveWhitespace,!this.preserveWhitespace),t[0]):{t:[],v:sa}},converters:[qd],sortMustacheTags:function(){this.tags.sort(function(t,e){return e.open.length-t.open.length})}});var ep,ip,np,op=["preserveWhitespace","sanitize","stripComments","delimiters","tripleDelimiters","interpolate"],rp={fromId:$e,isHashedId:Ke,isParsed:Qe,getParseOptions:Xe,createHelper:Ye,parse:Je},sp=rp,ap={name:"template",extend:function(t,e,i){var n;"template"in i&&(n=i.template,"function"==typeof n?e.template=n:e.template=ni(n,e))},init:function(t,e,i){var n,o;n="template"in i?i.template:t.prototype.template,"function"==typeof n&&(o=n,n=ei(e,o),e._config.template={fn:o,result:n}),n=ni(n,e),e.template=n.t,n.p&&oi(e.partials,n.p)},reset:function(t){var e,i=ti(t);return i?(e=ni(i,t),t.template=e.t,oi(t.partials,e.p,!0),!0):void 0}},hp=ap;ep=["adaptors","components","computed","decorators","easing","events","interpolators","partials","transitions"],ip=function(t,e){this.name=t,this.useDefaults=e},ip.prototype={constructor:ip,extend:function(t,e,i){this.configure(this.useDefaults?t.defaults:t,this.useDefaults?e:e.constructor,i)},init:function(){},configure:function(t,e,i){var n,o=this.name,r=i[o];n=wa(t[o]);for(var s in r)n[s]=r[s];e[o]=n},reset:function(t){var e=t[this.name],i=!1;return Object.keys(e).forEach(function(t){var n=e[t];n._fn&&(n._fn.isOwner?e[t]=n._fn:delete e[t],i=!0)}),i}},np=ep.map(function(t){return new ip(t,"computed"===t)});var lp,up,cp,dp,pp,fp,mp=np,gp=ri,vp=li;dp={adapt:Sl,css:Nl,data:jl,template:hp},cp=Object.keys(ha),fp=di(cp.filter(function(t){return!dp[t]})),pp=di(cp.concat(mp.map(function(t){return t.name}))),up=[].concat(cp.filter(function(t){return!mp[t]&&!dp[t]}),mp,dp.data,dp.template,dp.css),lp={extend:function(t,e,i){return ui("extend",t,e,i)},init:function(t,e,i){return ui("init",t,e,i)},reset:function(t){return up.filter(function(e){return e.reset&&e.reset(t)}).map(function(t){return t.name})},order:up};var _p=lp,yp=pi,wp=fi,bp=mi,Lp=gi,xp=vi,kp=_i,Ep=yi,Pp=wi,Mp=bi,Cp=Li,Tp=xi,Sp=ki,Dp=function(){return e(this.node)},Op=function(t){this.type=ql,this.text=t.template};Op.prototype={detach:Dp,firstNode:function(){return this.node},render:function(){return this.node||(this.node=document.createTextNode(this.text)),this.node},toString:function(t){return t?Pe(this.text):this.text},unrender:function(t){return t?this.detach():void 0}};var Ap=Op,Ip=Ei,Rp=Pi,zp=function(t,e,i){var n;this.ref=e,this.resolved=!1,this.root=t.root,this.parentFragment=t.parentFragment,this.callback=i,n=hh(t.root,e,t.parentFragment),void 0!=n?this.resolve(n):mh.addUnresolved(this)};zp.prototype={resolve:function(t){this.keypath&&!t&&mh.addUnresolved(this),this.resolved=!0,this.keypath=t,this.callback(t)},forceResolution:function(){this.resolve(k(this.ref))},rebind:function(t,e){var i;void 0!=this.keypath&&(i=this.keypath.replace(t,e),void 0!==i&&this.resolve(i))},unbind:function(){this.resolved||mh.removeUnresolved(this)}};var Up=zp,Bp=function(t,e,i){this.parentFragment=t.parentFragment,this.ref=e,this.callback=i,this.rebind()},Np={"@keypath":{prefix:"c",prop:["context"]},"@index":{prefix:"i",prop:["index"]},"@key":{prefix:"k",prop:["key","index"]}};Bp.prototype={rebind:function(){var t,e=this.ref,i=this.parentFragment,n=Np[e];if(!n)throw new Error('Unknown special reference "'+e+'" - valid references are @index, @key and @keypath');if(this.cached)return this.callback(k("@"+n.prefix+Mi(this.cached,n)));if(-1!==n.prop.indexOf("index")||-1!==n.prop.indexOf("key"))for(;i;){if(i.owner.currentSubtype===Mu&&void 0!==(t=Mi(i,n)))return this.cached=i,i.registerIndexRef(this),this.callback(k("@"+n.prefix+t));i=!i.parent&&i.owner&&i.owner.component&&i.owner.component.parentFragment&&!i.owner.component.instance.isolated?i.owner.component.parentFragment:i.parent}else for(;i;){if(void 0!==(t=Mi(i,n)))return this.callback(k("@"+n.prefix+t.str));i=i.parent}},unbind:function(){this.cached&&this.cached.unregisterIndexRef(this)}};var Fp=Bp,jp=function(t,e,i){this.parentFragment=t.parentFragment,this.ref=e,this.callback=i,e.ref.fragment.registerIndexRef(this),this.rebind()};jp.prototype={rebind:function(){var t,e=this.ref.ref;t="k"===e.ref.t?"k"+e.fragment.key:"i"+e.fragment.index,void 0!==t&&this.callback(k("@"+t))},unbind:function(){this.ref.ref.fragment.unregisterIndexRef(this)}};var Zp=jp,Hp=Ci;Ci.resolve=function(t){var e,i,n={};for(e in t.refs)i=t.refs[e],n[i.ref.n]="k"===i.ref.t?i.fragment.key:i.fragment.index;return n};var Vp,Wp=Ti,Gp=Si,qp={},Yp=Function.prototype.bind;Vp=function(t,e,i,n){var o,r=this;o=t.root,this.root=o,this.parentFragment=e,this.callback=n,this.owner=t,this.str=i.s,this.keypaths=[],this.pending=i.r.length,this.refResolvers=i.r.map(function(t,e){return Wp(r,t,function(t){r.resolve(e,t)})}),this.ready=!0,this.bubble()},Vp.prototype={bubble:function(){this.ready&&(this.uniqueString=Oi(this.str,this.keypaths),this.keypath=Ai(this.uniqueString),this.createEvaluator(),this.callback(this.keypath))},unbind:function(){for(var t;t=this.refResolvers.pop();)t.unbind()},resolve:function(t,e){this.keypaths[t]=e,this.bubble()},createEvaluator:function(){var t,e,i,n,o,r=this;n=this.keypath,t=this.root.viewmodel.computations[n.str],t?this.root.viewmodel.mark(n):(o=Gp(this.str,this.refResolvers.length),e=this.keypaths.map(function(t){var e;return"undefined"===t?function(){}:t.isSpecial?(e=t.value,function(){return e}):function(){var e=r.root.viewmodel.get(t,{noUnwrap:!0,fullRootGet:!0});return"function"==typeof e&&(e=Ri(e,r.root)),e}}),i={deps:this.keypaths.filter(Ii),getter:function(){var t=e.map(Di);return o.apply(null,t)}},t=this.root.viewmodel.compute(n,i))},rebind:function(t,e){this.refResolvers.forEach(function(i){return i.rebind(t,e)})}};var Jp=Vp,$p=function(t,e,i){var n=this;this.resolver=e,this.root=e.root,this.parentFragment=i,this.viewmodel=e.root.viewmodel,"string"==typeof t?this.value=t:t.t===vu?this.refResolver=Wp(this,t.n,function(t){n.resolve(t)}):new Jp(e,i,t,function(t){n.resolve(t)})};$p.prototype={resolve:function(t){this.keypath&&this.viewmodel.unregister(this.keypath,this),this.keypath=t,this.value=this.viewmodel.get(t),this.bind(),this.resolver.bubble()},bind:function(){this.viewmodel.register(this.keypath,this)},rebind:function(t,e){this.refResolver&&this.refResolver.rebind(t,e)},setValue:function(t){this.value=t,this.resolver.bubble()},unbind:function(){this.keypath&&this.viewmodel.unregister(this.keypath,this),this.refResolver&&this.refResolver.unbind()},forceResolution:function(){this.refResolver&&this.refResolver.forceResolution()}};var Kp=$p,Qp=function(t,e,i){var n,o,r,s,a=this;this.parentFragment=s=t.parentFragment,this.root=n=t.root,this.mustache=t,this.ref=o=e.r,this.callback=i,this.unresolved=[],(r=hh(n,o,s))?this.base=r:this.baseResolver=new Up(this,o,function(t){a.base=t,a.baseResolver=null,a.bubble()}),this.members=e.m.map(function(t){return new Kp(t,a,s)}),this.ready=!0,this.bubble()};Qp.prototype={getKeypath:function(){var t=this.members.map(zi);return!t.every(Ui)||this.baseResolver?null:this.base.join(t.join("."))},bubble:function(){this.ready&&!this.baseResolver&&this.callback(this.getKeypath())},unbind:function(){this.members.forEach(q)},rebind:function(t,e){var i;if(this.base){var n=this.base.replace(t,e);n&&n!==this.base&&(this.base=n,i=!0)}this.members.forEach(function(n){n.rebind(t,e)&&(i=!0)}),i&&this.bubble()},forceResolution:function(){this.baseResolver&&(this.base=k(this.ref),this.baseResolver.unbind(),this.baseResolver=null),this.members.forEach(Bi),this.bubble()}};var Xp=Qp,tf=Ni,ef=Fi,nf=ji,of={getValue:Rp,init:tf,resolve:ef,rebind:nf},rf=function(t){this.type=Yl,of.init(this,t)};rf.prototype={update:function(){this.node.data=void 0==this.value?"":this.value},resolve:of.resolve,rebind:of.rebind,detach:Dp,unbind:Ip,render:function(){return this.node||(this.node=document.createTextNode(i(this.value))),this.node},unrender:function(t){t&&e(this.node)},getValue:of.getValue,setValue:function(t){var e;this.keypath&&(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),a(t,this.value)||(this.value=t,this.parentFragment.bubble(),this.node&&mh.addView(this))},firstNode:function(){return this.node},toString:function(t){var e=""+i(this.value);return t?Pe(e):e}};var sf=rf,af=Zi,hf=Hi,lf=Vi,uf=Wi,cf=Gi,df=qi,pf=Yi,ff=Ji,mf=$i,gf=function(t,e){of.rebind.call(this,t,e)},vf=Qi,_f=Xi,yf=cn,wf=dn,bf=pn,Lf=gn,xf=function(t){this.type=$l,this.subtype=this.currentSubtype=t.template.n,this.inverted=this.subtype===Pu,this.pElement=t.pElement,this.fragments=[],this.fragmentsToCreate=[],this.fragmentsToRender=[],this.fragmentsToUnrender=[],t.template.i&&(this.indexRefs=t.template.i.split(",").map(function(t,e){return{n:t,t:0===e?"k":"i"}})),this.renderedFragments=[],this.length=0,of.init(this,t)};xf.prototype={bubble:af,detach:hf,find:lf,findAll:uf,findAllComponents:cf,findComponent:df,findNextNode:pf,firstNode:ff,getIndexRef:function(t){if(this.indexRefs)for(var e=this.indexRefs.length;e--;){var i=this.indexRefs[e];if(i.n===t)return i}},getValue:of.getValue,shuffle:mf,rebind:gf,render:vf,resolve:of.resolve,setValue:_f,toString:yf,unbind:wf,unrender:bf,update:Lf};var kf,Ef,Pf=xf,Mf=vn,Cf=_n,Tf=yn,Sf=wn,Df={};try{ca("table").innerHTML="foo"}catch(ka){kf=!0,Ef={TABLE:['<table class="x">',"</table>"],THEAD:['<table><thead class="x">',"</thead></table>"],TBODY:['<table><tbody class="x">',"</tbody></table>"],TR:['<table><tr class="x">',"</tr></table>"],SELECT:['<select class="x">',"</select>"]}}var Of=function(t,e,i){var n,o,r,s,a,h=[];if(null!=t&&""!==t){for(kf&&(o=Ef[e.tagName])?(n=bn("DIV"),n.innerHTML=o[0]+t+o[1],n=n.querySelector(".x"),"SELECT"===n.tagName&&(r=n.options[n.selectedIndex])):e.namespaceURI===na.svg?(n=bn("DIV"),n.innerHTML='<svg class="x">'+t+"</svg>",n=n.querySelector(".x")):(n=bn(e.tagName),n.innerHTML=t,"SELECT"===n.tagName&&(r=n.options[n.selectedIndex]));s=n.firstChild;)h.push(s),i.appendChild(s);if("SELECT"===e.tagName)for(a=h.length;a--;)h[a]!==r&&(h[a].selected=!1)}return h},Af=Ln,If=kn,Rf=En,zf=Pn,Uf=Mn,Bf=Cn,Nf=function(t){this.type=Jl,of.init(this,t)};Nf.prototype={detach:Mf,find:Cf,findAll:Tf,firstNode:Sf,getValue:of.getValue,rebind:of.rebind,render:If,resolve:of.resolve,setValue:Rf,toString:zf,unbind:Ip,unrender:Uf,update:Bf};var Ff,jf,Zf,Hf,Vf=Nf,Wf=function(){this.parentFragment.bubble()},Gf=Tn,qf=function(t){return this.node?da(this.node,t)?this.node:this.fragment&&this.fragment.find?this.fragment.find(t):void 0:null},Yf=function(t,e){e._test(this,!0)&&e.live&&(this.liveQueries||(this.liveQueries=[])).push(e),this.fragment&&this.fragment.findAll(t,e)},Jf=function(t,e){this.fragment&&this.fragment.findAllComponents(t,e)},$f=function(t){return this.fragment?this.fragment.findComponent(t):void 0},Kf=Sn,Qf=Dn,Xf=On,tm=/^true|on|yes|1$/i,em=/^[0-9]+$/,im=function(t,e){var i,n,o;return o=e.a||{},n={},i=o.twoway,void 0!==i&&(n.twoway=0===i||tm.test(i)),i=o.lazy,void 0!==i&&(0!==i&&em.test(i)?n.lazy=parseInt(i):n.lazy=0===i||tm.test(i)),n},nm=An;Ff="altGlyph altGlyphDef altGlyphItem animateColor animateMotion animateTransform clipPath feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence foreignObject glyphRef linearGradient radialGradient textPath vkern".split(" "),jf="attributeName attributeType baseFrequency baseProfile calcMode clipPathUnits contentScriptType contentStyleType diffuseConstant edgeMode externalResourcesRequired filterRes filterUnits glyphRef gradientTransform gradientUnits kernelMatrix kernelUnitLength keyPoints keySplines keyTimes lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY repeatCount repeatDur requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox viewTarget xChannelSelector yChannelSelector zoomAndPan".split(" "),Zf=function(t){for(var e={},i=t.length;i--;)e[t[i].toLowerCase()]=t[i];return e},Hf=Zf(Ff.concat(jf));var om=function(t){var e=t.toLowerCase();return Hf[e]||e},rm=function(t,e){var i,n;if(i=e.indexOf(":"),-1===i||(n=e.substr(0,i),"xmlns"===n))t.name=t.element.namespace!==na.html?om(e):e;else if(e=e.substring(i+1),t.name=om(e),t.namespace=na[n.toLowerCase()],t.namespacePrefix=n,!t.namespace)throw'Unknown namespace ("'+n+'")'},sm=In,am=Rn,hm=zn,lm=Un,um={"accept-charset":"acceptCharset",accesskey:"accessKey",bgcolor:"bgColor","class":"className",codebase:"codeBase",colspan:"colSpan",contenteditable:"contentEditable",datetime:"dateTime",
dirname:"dirName","for":"htmlFor","http-equiv":"httpEquiv",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",pubdate:"pubDate",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"},cm=Bn,dm=Fn,pm=jn,fm=Zn,mm=Hn,gm=Vn,vm=Wn,_m=Gn,ym=qn,wm=Yn,bm=Jn,Lm=$n,xm=Kn,km=Qn,Em=Xn,Pm=function(t){this.init(t)};Pm.prototype={bubble:nm,init:am,rebind:hm,render:lm,toString:cm,unbind:dm,update:Em};var Mm,Cm=Pm,Tm=function(t,e){var i,n,o=[];for(i in e)"twoway"!==i&&"lazy"!==i&&e.hasOwnProperty(i)&&(n=new Cm({element:t,name:i,value:e[i],root:t.root}),o[i]=n,"value"!==i&&o.push(n));return(n=o.value)&&o.push(n),o};"undefined"!=typeof document&&(Mm=ca("div"));var Sm=function(t,e){this.element=t,this.root=t.root,this.parentFragment=t.parentFragment,this.attributes=[],this.fragment=new _y({root:t.root,owner:this,template:[e]})};Sm.prototype={bubble:function(){this.node&&this.update(),this.element.bubble()},rebind:function(t,e){this.fragment.rebind(t,e)},render:function(t){this.node=t,this.isSvg=t.namespaceURI===na.svg,this.update()},unbind:function(){this.fragment.unbind()},update:function(){var t,e,i=this;t=this.fragment.toString(),e=to(t,this.isSvg),this.attributes.filter(function(t){return eo(e,t)}).forEach(function(t){i.node.removeAttribute(t.name)}),e.forEach(function(t){i.node.setAttribute(t.name,t.value)}),this.attributes=e},toString:function(){return this.fragment.toString()}};var Dm=Sm,Om=function(t,e){return e?e.map(function(e){return new Dm(t,e)}):[]},Am=function(t){var e,i,n,o;if(this.element=t,this.root=t.root,this.attribute=t.attributes[this.name||"value"],e=this.attribute.interpolator,e.twowayBinding=this,i=e.keypath){if("}"===i.str.slice(-1))return g("Two-way binding does not work with expressions (`%s` on <%s>)",e.resolver.uniqueString,t.name,{ractive:this.root}),!1;if(i.isSpecial)return g("Two-way binding does not work with %s",e.resolver.ref,{ractive:this.root}),!1}else{var r=e.template.r?"'"+e.template.r+"' reference":"expression";m("The %s being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity",r,{ractive:this.root}),e.resolver.forceResolution(),i=e.keypath}this.attribute.isTwoway=!0,this.keypath=i,n=this.root.viewmodel.get(i),void 0===n&&this.getInitialValue&&(n=this.getInitialValue(),void 0!==n&&this.root.viewmodel.set(i,n)),(o=io(t))&&(this.resetValue=n,o.formBindings.push(this))};Am.prototype={handleChange:function(){var t=this;mh.start(this.root),this.attribute.locked=!0,this.root.viewmodel.set(this.keypath,this.getValue()),mh.scheduleTask(function(){return t.attribute.locked=!1}),mh.end()},rebound:function(){var t,e,i;e=this.keypath,i=this.attribute.interpolator.keypath,e!==i&&(z(this.root._twowayBindings[e.str],this),this.keypath=i,t=this.root._twowayBindings[i.str]||(this.root._twowayBindings[i.str]=[]),t.push(this))},unbind:function(){}},Am.extend=function(t){var e,i=this;return e=function(t){Am.call(this,t),this.init&&this.init()},e.prototype=wa(i.prototype),n(e.prototype,t),e.extend=Am.extend,e};var Im,Rm=Am,zm=no;Im=Rm.extend({getInitialValue:function(){return""},getValue:function(){return this.element.node.value},render:function(){var t,e=this.element.node,i=!1;this.rendered=!0,t=this.root.lazy,this.element.lazy===!0?t=!0:this.element.lazy===!1?t=!1:h(this.element.lazy)?(t=!1,i=+this.element.lazy):h(t||"")&&(i=+t,t=!1,this.element.lazy=i),this.handler=i?ro:zm,e.addEventListener("change",zm,!1),t||(e.addEventListener("input",this.handler,!1),e.attachEvent&&e.addEventListener("keyup",this.handler,!1)),e.addEventListener("blur",oo,!1)},unrender:function(){var t=this.element.node;this.rendered=!1,t.removeEventListener("change",zm,!1),t.removeEventListener("input",this.handler,!1),t.removeEventListener("keyup",this.handler,!1),t.removeEventListener("blur",oo,!1)}});var Um=Im,Bm=Um.extend({getInitialValue:function(){return this.element.fragment?this.element.fragment.toString():""},getValue:function(){return this.element.node.innerHTML}}),Nm=Bm,Fm=so,jm={},Zm=Rm.extend({name:"checked",init:function(){this.siblings=Fm(this.root._guid,"radio",this.element.getAttribute("name")),this.siblings.push(this)},render:function(){var t=this.element.node;t.addEventListener("change",zm,!1),t.attachEvent&&t.addEventListener("click",zm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",zm,!1),t.removeEventListener("click",zm,!1)},handleChange:function(){mh.start(this.root),this.siblings.forEach(function(t){t.root.viewmodel.set(t.keypath,t.getValue())}),mh.end()},getValue:function(){return this.element.node.checked},unbind:function(){z(this.siblings,this)}}),Hm=Zm,Vm=Rm.extend({name:"name",init:function(){this.siblings=Fm(this.root._guid,"radioname",this.keypath.str),this.siblings.push(this),this.radioName=!0},getInitialValue:function(){return this.element.getAttribute("checked")?this.element.getAttribute("value"):void 0},render:function(){var t=this.element.node;t.name="{{"+this.keypath.str+"}}",t.checked=this.root.viewmodel.get(this.keypath)==this.element.getAttribute("value"),t.addEventListener("change",zm,!1),t.attachEvent&&t.addEventListener("click",zm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",zm,!1),t.removeEventListener("click",zm,!1)},getValue:function(){var t=this.element.node;return t._ractive?t._ractive.value:t.value},handleChange:function(){this.element.node.checked&&Rm.prototype.handleChange.call(this)},rebound:function(t,e){var i;Rm.prototype.rebound.call(this,t,e),(i=this.element.node)&&(i.name="{{"+this.keypath.str+"}}")},unbind:function(){z(this.siblings,this)}}),Wm=Vm,Gm=Rm.extend({name:"name",getInitialValue:function(){return this.noInitialValue=!0,[]},init:function(){var t,e;this.checkboxName=!0,this.siblings=Fm(this.root._guid,"checkboxes",this.keypath.str),this.siblings.push(this),this.noInitialValue&&(this.siblings.noInitialValue=!0),this.siblings.noInitialValue&&this.element.getAttribute("checked")&&(t=this.root.viewmodel.get(this.keypath),e=this.element.getAttribute("value"),t.push(e))},unbind:function(){z(this.siblings,this)},render:function(){var t,e,i=this.element.node;t=this.root.viewmodel.get(this.keypath),e=this.element.getAttribute("value"),r(t)?this.isChecked=O(t,e):this.isChecked=t==e,i.name="{{"+this.keypath.str+"}}",i.checked=this.isChecked,i.addEventListener("change",zm,!1),i.attachEvent&&i.addEventListener("click",zm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",zm,!1),t.removeEventListener("click",zm,!1)},changed:function(){var t=!!this.isChecked;return this.isChecked=this.element.node.checked,this.isChecked===t},handleChange:function(){this.isChecked=this.element.node.checked,Rm.prototype.handleChange.call(this)},getValue:function(){return this.siblings.filter(ao).map(ho)}}),qm=Gm,Ym=Rm.extend({name:"checked",render:function(){var t=this.element.node;t.addEventListener("change",zm,!1),t.attachEvent&&t.addEventListener("click",zm,!1)},unrender:function(){var t=this.element.node;t.removeEventListener("change",zm,!1),t.removeEventListener("click",zm,!1)},getValue:function(){return this.element.node.checked}}),Jm=Ym,$m=Rm.extend({getInitialValue:function(){var t,e,i,n,o=this.element.options;if(void 0===this.element.getAttribute("value")&&(e=t=o.length,t)){for(;e--;)if(o[e].getAttribute("selected")){i=o[e].getAttribute("value"),n=!0;break}if(!n)for(;++e<t;)if(!o[e].getAttribute("disabled")){i=o[e].getAttribute("value");break}return void 0!==i&&(this.element.attributes.value.value=i),i}},render:function(){this.element.node.addEventListener("change",zm,!1)},unrender:function(){this.element.node.removeEventListener("change",zm,!1)},setValue:function(t){this.root.viewmodel.set(this.keypath,t)},getValue:function(){var t,e,i,n,o;for(t=this.element.node.options,i=t.length,e=0;i>e;e+=1)if(n=t[e],t[e].selected)return o=n._ractive?n._ractive.value:n.value},forceUpdate:function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,mh.scheduleTask(function(){return t.attribute.locked=!1}),this.root.viewmodel.set(this.keypath,e))}}),Km=$m,Qm=Km.extend({getInitialValue:function(){return this.element.options.filter(function(t){return t.getAttribute("selected")}).map(function(t){return t.getAttribute("value")})},render:function(){var t;this.element.node.addEventListener("change",zm,!1),t=this.root.viewmodel.get(this.keypath),void 0===t&&this.handleChange()},unrender:function(){this.element.node.removeEventListener("change",zm,!1)},setValue:function(){throw new Error("TODO not implemented yet")},getValue:function(){var t,e,i,n,o,r;for(t=[],e=this.element.node.options,n=e.length,i=0;n>i;i+=1)o=e[i],o.selected&&(r=o._ractive?o._ractive.value:o.value,t.push(r));return t},handleChange:function(){var t,e,i;return t=this.attribute,e=t.value,i=this.getValue(),void 0!==e&&A(i,e)||Km.prototype.handleChange.call(this),this},forceUpdate:function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,mh.scheduleTask(function(){return t.attribute.locked=!1}),this.root.viewmodel.set(this.keypath,e))},updateModel:function(){void 0!==this.attribute.value&&this.attribute.value.length||this.root.viewmodel.set(this.keypath,this.initialValue)}}),Xm=Qm,tg=Rm.extend({render:function(){this.element.node.addEventListener("change",zm,!1)},unrender:function(){this.element.node.removeEventListener("change",zm,!1)},getValue:function(){return this.element.node.files}}),eg=tg,ig=Um.extend({getInitialValue:function(){},getValue:function(){var t=parseFloat(this.element.node.value);return isNaN(t)?void 0:t}}),ng=lo,og=co,rg=po,sg=fo,ag=mo,hg=/^event(?:\.(.+))?/,lg=yo,ug=wo,cg={},dg={touchstart:!0,touchmove:!0,touchend:!0,touchcancel:!0,touchleave:!0},pg=Lo,fg=xo,mg=ko,gg=Eo,vg=Po,_g=function(t,e,i){this.init(t,e,i)};_g.prototype={bubble:og,fire:rg,getAction:sg,init:ag,listen:ug,rebind:pg,render:fg,resolve:mg,unbind:gg,unrender:vg};var yg=_g,wg=function(t,e){var i,n,o,r,s=[];for(n in e)if(e.hasOwnProperty(n))for(o=n.split("-"),i=o.length;i--;)r=new yg(t,o[i],e[n]),s.push(r);return s},bg=function(t,e){var i,n,o,r=this;this.element=t,this.root=i=t.root,n=e.n||e,("string"==typeof n||(o=new _y({template:n,root:i,owner:t}),n=o.toString(),o.unbind(),""!==n))&&(e.a?this.params=e.a:e.d&&(this.fragment=new _y({template:e.d,root:i,owner:t}),this.params=this.fragment.getArgsList(),this.fragment.bubble=function(){this.dirtyArgs=this.dirtyValue=!0,r.params=this.getArgsList(),r.ready&&r.update()}),this.fn=v("decorators",i,n),this.fn||c(Ra(n,"decorator")))};bg.prototype={init:function(){var t,e,i;if(t=this.element.node,this.params?(i=[t].concat(this.params),e=this.fn.apply(this.root,i)):e=this.fn.call(this.root,t),!e||!e.teardown)throw new Error("Decorator definition must return an object with a teardown method");this.actual=e,this.ready=!0},update:function(){this.actual.update?this.actual.update.apply(this.root,this.params):(this.actual.teardown(!0),this.init())},rebind:function(t,e){this.fragment&&this.fragment.rebind(t,e)},teardown:function(t){this.torndown=!0,this.ready&&this.actual.teardown(),!t&&this.fragment&&this.fragment.unbind()}};var Lg,xg,kg,Eg=bg,Pg=Ao,Mg=Io,Cg=Fo,Tg=function(t){return t.replace(/-([a-zA-Z])/g,function(t,e){return e.toUpperCase()})};Xs?(xg={},kg=ca("div").style,Lg=function(t){var e,i,n;if(t=Tg(t),!xg[t])if(void 0!==kg[t])xg[t]=t;else for(n=t.charAt(0).toUpperCase()+t.substring(1),e=ra.length;e--;)if(i=ra[e],void 0!==kg[i+n]){xg[t]=i+n;break}return xg[t]}):Lg=null;var Sg,Dg,Og=Lg;Xs?(Dg=window.getComputedStyle||xa.getComputedStyle,Sg=function(t){var e,i,n,o,s;if(e=Dg(this.node),"string"==typeof t)return s=e[Og(t)],"0px"===s&&(s=0),s;if(!r(t))throw new Error("Transition$getStyle must be passed a string, or an array of strings representing CSS properties");for(i={},n=t.length;n--;)o=t[n],s=e[Og(o)],"0px"===s&&(s=0),i[o]=s;return i}):Sg=null;var Ag=Sg,Ig=function(t,e){var i;if("string"==typeof t)this.node.style[Og(t)]=e;else for(i in t)t.hasOwnProperty(i)&&(this.node.style[Og(i)]=t[i]);return this},Rg=function(t){var e;this.duration=t.duration,this.step=t.step,this.complete=t.complete,"string"==typeof t.easing?(e=t.root.easing[t.easing],e||(g(Ra(t.easing,"easing")),e=jo)):e="function"==typeof t.easing?t.easing:jo,this.easing=e,this.start=Xa(),this.end=this.start+this.duration,this.running=!0,_h.add(this)};Rg.prototype={tick:function(t){var e,i;return this.running?t>this.end?(this.step&&this.step(1),this.complete&&this.complete(1),!1):(e=t-this.start,i=this.easing(e/this.duration),this.step&&this.step(i),!0):!1},stop:function(){this.abort&&this.abort(),this.running=!1}};var zg,Ug,Bg,Ng,Fg,jg,Zg,Hg,Vg=Rg,Wg=new RegExp("^-(?:"+ra.join("|")+")-"),Gg=function(t){return t.replace(Wg,"")},qg=new RegExp("^(?:"+ra.join("|")+")([A-Z])"),Yg=function(t){var e;return t?(qg.test(t)&&(t="-"+t),e=t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})):""},Jg={},$g={};Xs?(Ug=ca("div").style,function(){void 0!==Ug.transition?(Bg="transition",Ng="transitionend",Fg=!0):void 0!==Ug.webkitTransition?(Bg="webkitTransition",Ng="webkitTransitionEnd",Fg=!0):Fg=!1}(),Bg&&(jg=Bg+"Duration",Zg=Bg+"Property",Hg=Bg+"TimingFunction"),zg=function(t,e,i,n,o){setTimeout(function(){var r,s,a,h,l;h=function(){s&&a&&(t.root.fire(t.name+":end",t.node,t.isIntro),o())},r=(t.node.namespaceURI||"")+t.node.tagName,t.node.style[Zg]=n.map(Og).map(Yg).join(","),t.node.style[Hg]=Yg(i.easing||"linear"),t.node.style[jg]=i.duration/1e3+"s",l=function(e){var i;i=n.indexOf(Tg(Gg(e.propertyName))),-1!==i&&n.splice(i,1),n.length||(t.node.removeEventListener(Ng,l,!1),a=!0,h())},t.node.addEventListener(Ng,l,!1),setTimeout(function(){for(var o,u,c,d,p,f=n.length,g=[];f--;)d=n[f],o=r+d,Fg&&!$g[o]&&(t.node.style[Og(d)]=e[d],Jg[o]||(u=t.getStyle(d),Jg[o]=t.getStyle(d)!=e[d],$g[o]=!Jg[o],$g[o]&&(t.node.style[Og(d)]=u))),(!Fg||$g[o])&&(void 0===u&&(u=t.getStyle(d)),c=n.indexOf(d),-1===c?m("Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!",{node:t.node}):n.splice(c,1),p=/[^\d]*$/.exec(e[d])[0],g.push({name:Og(d),interpolator:Ua(parseFloat(u),parseFloat(e[d])),suffix:p}));g.length?new Vg({root:t.root,duration:i.duration,easing:Tg(i.easing||""),step:function(e){var i,n;for(n=g.length;n--;)i=g[n],t.node.style[i.name]=i.interpolator(e)+i.suffix},complete:function(){s=!0,h()}}):s=!0,n.length||(t.node.removeEventListener(Ng,l,!1),a=!0,h())},0)},i.delay||0)}):zg=null;var Kg,Qg,Xg,tv,ev,iv=zg;if("undefined"!=typeof document){if(Kg="hidden",ev={},Kg in document)Xg="";else for(tv=ra.length;tv--;)Qg=ra[tv],Kg=Qg+"Hidden",Kg in document&&(Xg=Qg);void 0!==Xg?(document.addEventListener(Xg+"visibilitychange",Zo),Zo()):("onfocusout"in document?(document.addEventListener("focusout",Ho),document.addEventListener("focusin",Vo)):(window.addEventListener("pagehide",Ho),window.addEventListener("blur",Ho),window.addEventListener("pageshow",Vo),window.addEventListener("focus",Vo)),ev.hidden=!1)}var nv,ov,rv,sv=ev;Xs?(ov=window.getComputedStyle||xa.getComputedStyle,nv=function(t,e,i){var n,o=this;if(4===arguments.length)throw new Error("t.animateStyle() returns a promise - use .then() instead of passing a callback");if(sv.hidden)return this.setStyle(t,e),rv||(rv=sh.resolve());"string"==typeof t?(n={},n[t]=e):(n=t,i=e),i||(g('The "%s" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340',this.name),i=this);var r=new sh(function(t){var e,r,s,a,h,l,u;if(!i.duration)return o.setStyle(n),void t();for(e=Object.keys(n),r=[],s=ov(o.node),h={},l=e.length;l--;)u=e[l],a=s[Og(u)],"0px"===a&&(a=0),a!=n[u]&&(r.push(u),o.node.style[Og(u)]=a);return r.length?void iv(o,n,i,r,t):void t()});return r}):nv=null;var av=nv,hv=function(t,e){return"number"==typeof t?t={duration:t}:"string"==typeof t?t="slow"===t?{duration:600}:"fast"===t?{duration:200}:{duration:400}:t||(t={}),o({},t,e)},lv=Wo,uv=function(t,e,i){this.init(t,e,i)};uv.prototype={init:Cg,start:lv,getStyle:Ag,setStyle:Ig,animateStyle:av,processParams:hv};var cv,dv,pv=uv,fv=qo;cv=function(){var t=this.node,e=this.fragment.toString(!1);if(window&&window.appearsToBeIELessEqual8&&(t.type="text/css"),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}},dv=function(){this.node.type&&"text/javascript"!==this.node.type||m("Script tag was updated. This does not cause the code to be re-evaluated!",{ractive:this.root}),this.node.text=this.fragment.toString(!1)};var mv=function(){var t,e;return this.template.y?"<!DOCTYPE"+this.template.dd+">":(t="<"+this.template.e,t+=this.attributes.map(Xo).join("")+this.conditionalAttributes.map(Xo).join(""),"option"===this.name&&Ko(this)&&(t+=" selected"),"input"===this.name&&Qo(this)&&(t+=" checked"),t+=">","textarea"===this.name&&void 0!==this.getAttribute("value")?t+=Pe(this.getAttribute("value")):void 0!==this.getAttribute("contenteditable")&&(t+=this.getAttribute("value")||""),this.fragment&&(e="script"!==this.name&&"style"!==this.name,t+=this.fragment.toString(e)),yc.test(this.template.e)||(t+="</"+this.template.e+">"),t)},gv=tr,vv=er,_v=function(t){this.init(t)};_v.prototype={bubble:Wf,detach:Gf,find:qf,findAll:Yf,findAllComponents:Jf,findComponent:$f,findNextNode:Kf,firstNode:Qf,getAttribute:Xf,init:Pg,rebind:Mg,render:fv,toString:mv,unbind:gv,unrender:vv};var yv=_v,wv=/^\s*$/,bv=/^\s*/,Lv=function(t){var e,i,n,o;return e=t.split("\n"),i=e[0],void 0!==i&&wv.test(i)&&e.shift(),n=R(e),void 0!==n&&wv.test(n)&&e.pop(),o=e.reduce(nr,null),o&&(t=e.map(function(t){return t.replace(o,"")}).join("\n")),t},xv=or,kv=function(t,e){var i;return e?i=t.split("\n").map(function(t,i){return i?e+t:t}).join("\n"):t},Ev='Could not find template for partial "%s"',Pv=function(t){var e,i;e=this.parentFragment=t.parentFragment,this.root=e.root,this.type=tu,this.index=t.index,this.name=t.template.r,this.rendered=!1,this.fragment=this.fragmentToRender=this.fragmentToUnrender=null,of.init(this,t),this.keypath||((i=xv(this.root,this.name,e))?(Ip.call(this),this.isNamed=!0,this.setTemplate(i)):g(Ev,this.name))};Pv.prototype={bubble:function(){this.parentFragment.bubble()},detach:function(){return this.fragment.detach()},find:function(t){return this.fragment.find(t)},findAll:function(t,e){return this.fragment.findAll(t,e)},findComponent:function(t){return this.fragment.findComponent(t)},findAllComponents:function(t,e){return this.fragment.findAllComponents(t,e)},firstNode:function(){return this.fragment.firstNode()},findNextNode:function(){return this.parentFragment.findNextNode(this)},getPartialName:function(){return this.isNamed&&this.name?this.name:void 0===this.value?this.name:this.value},getValue:function(){return this.fragment.getValue()},rebind:function(t,e){this.isNamed||nf.call(this,t,e),this.fragment&&this.fragment.rebind(t,e)},render:function(){return this.docFrag=document.createDocumentFragment(),this.update(),this.rendered=!0,this.docFrag},resolve:of.resolve,setValue:function(t){var e;(void 0===t||t!==this.value)&&(void 0!==t&&(e=xv(this.root,""+t,this.parentFragment)),!e&&this.name&&(e=xv(this.root,this.name,this.parentFragment))&&(Ip.call(this),this.isNamed=!0),e||g(Ev,this.name,{ractive:this.root}),this.value=t,this.setTemplate(e||[]),this.bubble(),this.rendered&&mh.addView(this))},setTemplate:function(t){this.fragment&&(this.fragment.unbind(),this.rendered&&(this.fragmentToUnrender=this.fragment)),this.fragment=new _y({template:t,root:this.root,owner:this,pElement:this.parentFragment.pElement}),this.fragmentToRender=this.fragment},toString:function(t){var e,i,n,o;return e=this.fragment.toString(t),i=this.parentFragment.items[this.index-1],i&&i.type===ql?(n=i.text.split("\n").pop(),(o=/^\s+$/.exec(n))?kv(e,o[0]):e):e},unbind:function(){this.isNamed||Ip.call(this),this.fragment&&this.fragment.unbind()},unrender:function(t){this.rendered&&(this.fragment&&this.fragment.unrender(t),this.rendered=!1)},update:function(){var t,e;this.fragmentToUnrender&&(this.fragmentToUnrender.unrender(!0),this.fragmentToUnrender=null),this.fragmentToRender&&(this.docFrag.appendChild(this.fragmentToRender.render()),this.fragmentToRender=null),this.rendered&&(t=this.parentFragment.getNode(),e=this.parentFragment.findNextNode(this),t.insertBefore(this.docFrag,e))}};var Mv,Cv,Tv,Sv=Pv,Dv=lr,Ov=ur,Av=new ih("detach"),Iv=cr,Rv=dr,zv=pr,Uv=fr,Bv=mr,Nv=gr,Fv=function(t,e,i,n){var o=t.root,r=t.keypath;n?o.viewmodel.smartUpdate(r,e,n):o.viewmodel.mark(r)},jv=[],Zv=["pop","push","reverse","shift","sort","splice","unshift"];Zv.forEach(function(t){var e=function(){for(var e=arguments.length,i=Array(e),n=0;e>n;n++)i[n]=arguments[n];var o,r,s,a;for(o=ml(this,t,i),r=Array.prototype[t].apply(this,arguments),mh.start(),this._ractive.setting=!0,a=this._ractive.wrappers.length;a--;)s=this._ractive.wrappers[a],mh.addRactive(s.root),Fv(s,this,t,o);return mh.end(),this._ractive.setting=!1,r};ba(jv,t,{value:e})}),Mv={},Mv.__proto__?(Cv=function(t){t.__proto__=jv},Tv=function(t){t.__proto__=Array.prototype}):(Cv=function(t){var e,i;for(e=Zv.length;e--;)i=Zv[e],ba(t,i,{value:jv[i],configurable:!0})},Tv=function(t){var e;for(e=Zv.length;e--;)delete t[Zv[e]]}),Cv.unpatch=Tv;var Hv,Vv,Wv,Gv=Cv;Hv={filter:function(t){return r(t)&&(!t._ractive||!t._ractive.setting)},wrap:function(t,e,i){return new Vv(t,e,i)}},Vv=function(t,e,i){this.root=t,this.value=e,this.keypath=k(i),e._ractive||(ba(e,"_ractive",{value:{wrappers:[],instances:[],setting:!1},configurable:!0}),Gv(e)),e._ractive.instances[t._guid]||(e._ractive.instances[t._guid]=0,e._ractive.instances.push(t)),e._ractive.instances[t._guid]+=1,e._ractive.wrappers.push(this)},Vv.prototype={get:function(){return this.value},teardown:function(){var t,e,i,n,o;if(t=this.value,e=t._ractive,i=e.wrappers,n=e.instances,e.setting)return!1;if(o=i.indexOf(this),-1===o)throw new Error(Wv);if(i.splice(o,1),i.length){if(n[this.root._guid]-=1,!n[this.root._guid]){if(o=n.indexOf(this.root),-1===o)throw new Error(Wv);n.splice(o,1)}}else delete t._ractive,Gv.unpatch(this.value)}},Wv="Something went wrong in a rather interesting way";var qv,Yv,Jv=Hv,$v=/^\s*[0-9]+\s*$/,Kv=function(t){return $v.test(t)?[]:{}};try{Object.defineProperty({},"test",{value:0}),qv={filter:function(t,e,i){var n,o;return e?(e=k(e),(n=i.viewmodel.wrapped[e.parent.str])&&!n.magic?!1:(o=i.viewmodel.get(e.parent),r(o)&&/^[0-9]+$/.test(e.lastKey)?!1:o&&("object"==typeof o||"function"==typeof o))):!1},wrap:function(t,e,i){return new Yv(t,e,i)}},Yv=function(t,e,i){var n,o,r;return i=k(i),this.magic=!0,this.ractive=t,this.keypath=i,this.value=e,this.prop=i.lastKey,n=i.parent,this.obj=n.isRoot?t.viewmodel.data:t.viewmodel.get(n),o=this.originalDescriptor=Object.getOwnPropertyDescriptor(this.obj,this.prop),o&&o.set&&(r=o.set._ractiveWrappers)?void(-1===r.indexOf(this)&&r.push(this)):void vr(this,e,o)},Yv.prototype={get:function(){return this.value},reset:function(t){return this.updating?void 0:(this.updating=!0,this.obj[this.prop]=t,mh.addRactive(this.ractive),this.ractive.viewmodel.mark(this.keypath,{keepExistingWrapper:!0}),this.updating=!1,!0)},set:function(t,e){this.updating||(this.obj[this.prop]||(this.updating=!0,this.obj[this.prop]=Kv(t),this.updating=!1),this.obj[this.prop][t]=e)},teardown:function(){var t,e,i,n,o;return this.updating?!1:(t=Object.getOwnPropertyDescriptor(this.obj,this.prop),e=t&&t.set,void(e&&(n=e._ractiveWrappers,o=n.indexOf(this),-1!==o&&n.splice(o,1),n.length||(i=this.obj[this.prop],Object.defineProperty(this.obj,this.prop,this.originalDescriptor||{writable:!0,enumerable:!0,configurable:!0}),this.obj[this.prop]=i))))}}}catch(ka){qv=!1}var Qv,Xv,t_=qv;t_&&(Qv={filter:function(t,e,i){return t_.filter(t,e,i)&&Jv.filter(t)},wrap:function(t,e,i){return new Xv(t,e,i)}},Xv=function(t,e,i){this.value=e,this.magic=!0,this.magicWrapper=t_.wrap(t,e,i),this.arrayWrapper=Jv.wrap(t,e,i)},Xv.prototype={get:function(){return this.value},teardown:function(){this.arrayWrapper.teardown(),this.magicWrapper.teardown()},reset:function(t){return this.magicWrapper.reset(t)}});var e_=Qv,i_=_r,n_={},o_=br,r_=Lr,s_=Er,a_=Sr,h_=Dr,l_=function(t,e){this.computation=t,this.viewmodel=t.viewmodel,this.ref=e,this.root=this.viewmodel.ractive,this.parentFragment=this.root.component&&this.root.component.parentFragment};l_.prototype={resolve:function(t){this.computation.softDeps.push(t),this.computation.unresolvedDeps[t.str]=null,this.viewmodel.register(t,this.computation,"computed")}};var u_=l_,c_=function(t,e){this.key=t,this.getter=e.getter,this.setter=e.setter,this.hardDeps=e.deps||[],this.softDeps=[],this.unresolvedDeps={},this.depValues={},this._dirty=this._firstRun=!0};c_.prototype={constructor:c_,init:function(t){var e,i=this;this.viewmodel=t,this.bypass=!0,e=t.get(this.key),t.clearCache(this.key.str),this.bypass=!1,this.setter&&void 0!==e&&this.set(e),this.hardDeps&&this.hardDeps.forEach(function(e){return t.register(e,i,"computed")})},invalidate:function(){this._dirty=!0},get:function(){var t,e,i=this,n=!1;if(this.getting){var o="The "+this.key.str+" computation indirectly called itself. This probably indicates a bug in the computation. It is commonly caused by `array.sort(...)` - if that's the case, clone the array first with `array.slice().sort(...)`";return f(o),this.value}if(this.getting=!0,this._dirty){if(this._firstRun||!this.hardDeps.length&&!this.softDeps.length?n=!0:[this.hardDeps,this.softDeps].forEach(function(t){var e,o,r;if(!n)for(r=t.length;r--;)if(e=t[r],o=i.viewmodel.get(e),!a(o,i.depValues[e.str]))return i.depValues[e.str]=o,void(n=!0)}),n){this.viewmodel.capture();try{this.value=this.getter()}catch(r){m('Failed to compute "%s"',this.key.str),d(r.stack||r),this.value=void 0}t=this.viewmodel.release(),e=this.updateDependencies(t),e&&[this.hardDeps,this.softDeps].forEach(function(t){t.forEach(function(t){i.depValues[t.str]=i.viewmodel.get(t)})})}this._dirty=!1}return this.getting=this._firstRun=!1,this.value},set:function(t){if(this.setting)return void(this.value=t);if(!this.setter)throw new Error("Computed properties without setters are read-only. (This may change in a future version of Ractive!)");this.setter(t)},updateDependencies:function(t){var e,i,n,o,r;for(i=this.softDeps,e=i.length;e--;)n=i[e],-1===t.indexOf(n)&&(o=!0,this.viewmodel.unregister(n,this,"computed"));for(e=t.length;e--;)n=t[e],-1!==i.indexOf(n)||this.hardDeps&&-1!==this.hardDeps.indexOf(n)||(o=!0,Or(this.viewmodel,n)&&!this.unresolvedDeps[n.str]?(r=new u_(this,n.str),t.splice(e,1),this.unresolvedDeps[n.str]=r,mh.addUnresolved(r)):this.viewmodel.register(n,this,"computed"));return o&&(this.softDeps=t.slice()),o}};var d_=c_,p_=Ar,f_={FAILED_LOOKUP:!0},m_=Ir,g_={},v_=zr,__=Ur,y_=function(t,e){this.localKey=t,this.keypath=e.keypath,this.origin=e.origin,this.deps=[],this.unresolved=[],this.resolved=!1};y_.prototype={forceResolution:function(){this.keypath=this.localKey,this.setup()},get:function(t,e){return this.resolved?this.origin.get(this.map(t),e):void 0},getValue:function(){return this.keypath?this.origin.get(this.keypath):void 0},initViewmodel:function(t){this.local=t,this.setup()},map:function(t){return void 0===typeof this.keypath?this.localKey:t.replace(this.localKey,this.keypath)},register:function(t,e,i){this.deps.push({keypath:t,dep:e,group:i}),this.resolved&&this.origin.register(this.map(t),e,i)},resolve:function(t){void 0!==this.keypath&&this.unbind(!0),this.keypath=t,this.setup()},set:function(t,e){this.resolved||this.forceResolution(),this.origin.set(this.map(t),e)},setup:function(){var t=this;void 0!==this.keypath&&(this.resolved=!0,this.deps.length&&(this.deps.forEach(function(e){var i=t.map(e.keypath);if(t.origin.register(i,e.dep,e.group),e.dep.setValue)e.dep.setValue(t.origin.get(i));else{if(!e.dep.invalidate)throw new Error("An unexpected error occurred. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!");e.dep.invalidate()}}),this.origin.mark(this.keypath)))},setValue:function(t){if(!this.keypath)throw new Error("Mapping does not have keypath, cannot set value. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!");this.origin.set(this.keypath,t)},unbind:function(t){var e=this;t||delete this.local.mappings[this.localKey],this.resolved&&(this.deps.forEach(function(t){e.origin.unregister(e.map(t.keypath),t.dep,t.group)}),this.tracker&&this.origin.unregister(this.keypath,this.tracker))},unregister:function(t,e,i){var n,o;if(this.resolved){for(n=this.deps,o=n.length;o--;)if(n[o].dep===e){n.splice(o,1);break}this.origin.unregister(this.map(t),e,i)}}};var w_=Br,b_=function(t,e){var i,n,o,r;return i={},n=0,o=t.map(function(t,o){var s,a,h;a=n,h=e.length;do{if(s=e.indexOf(t,a),-1===s)return r=!0,-1;a=s+1}while(i[s]&&h>a);return s===n&&(n+=1),s!==o&&(r=!0),i[s]=!0,s})},L_=Nr,x_={},k_=Zr,E_=Vr,P_=Wr,M_=Gr,C_=Yr,T_={implicit:!0},S_={noCascade:!0},D_=$r,O_=Kr,A_=function(t){var e,i,n=t.adapt,o=t.data,r=t.ractive,s=t.computed,a=t.mappings;this.ractive=r,this.adaptors=n,this.onchange=t.onchange,this.cache={},this.cacheMap=wa(null),this.deps={computed:wa(null),"default":wa(null)},this.depsMap={computed:wa(null),"default":wa(null)},this.patternObservers=[],this.specials=wa(null),this.wrapped=wa(null),this.computations=wa(null),this.captureGroups=[],this.unresolvedImplicitDependencies=[],this.changes=[],this.implicitChanges={},this.noCascade={},this.data=o,this.mappings=wa(null);for(e in a)this.map(k(e),a[e]);if(o)for(e in o)(i=this.mappings[e])&&void 0===i.getValue()&&i.setValue(o[e]);for(e in s)a&&e in a&&c("Cannot map to a computed property ('%s')",e),this.compute(k(e),s[e]);this.ready=!0};A_.prototype={adapt:i_,applyChanges:s_,capture:a_,clearCache:h_,compute:p_,get:m_,init:v_,map:__,mark:w_,merge:L_,register:k_,release:E_,reset:P_,set:M_,smartUpdate:C_,teardown:D_,unregister:O_};var I_=A_;Xr.prototype={constructor:Xr,begin:function(t){this.inProcess[t._guid]=!0},end:function(t){var e=t.parent;e&&this.inProcess[e._guid]?ts(this.queue,e).push(t):es(this,t),delete this.inProcess[t._guid]}};var R_=Xr,z_=is,U_=/\$\{([^\}]+)\}/g,B_=new ih("construct"),N_=new ih("config"),F_=new R_("init"),j_=0,Z_=["adaptors","components","decorators","easing","events","interpolators","partials","transitions"],H_=ss,V_=cs;cs.prototype={bubble:function(){this.dirty||(this.dirty=!0,mh.addView(this))},update:function(){this.callback(this.fragment.getValue()),this.dirty=!1},rebind:function(t,e){this.fragment.rebind(t,e)},unbind:function(){this.fragment.unbind()}};var W_=function(t,e,i,o,s){var a,h,l,u,c,d,p={},f={},g={},v=[];for(h=t.parentFragment,l=t.root,s=s||{},n(p,s),s.content=o||[],p[""]=s.content,e.defaults.el&&m("The <%s/> component has a default `el` property; it has been disregarded",t.name),u=h;u;){if(u.owner.type===su){c=u.owner.container;break}u=u.parent}return i&&Object.keys(i).forEach(function(e){var n,o,s=i[e];if("string"==typeof s)n=kd(s),f[e]=n?n.value:s;else if(0===s)f[e]=!0;else{if(!r(s))throw new Error("erm wut");ps(s)?(g[e]={origin:t.root.viewmodel,keypath:void 0},o=ds(t,s[0],function(t){t.isSpecial?d?a.set(e,t.value):(f[e]=t.value,delete g[e]):d?a.viewmodel.mappings[e].resolve(t):g[e].keypath=t})):o=new V_(t,s,function(t){d?a.set(e,t):f[e]=t}),v.push(o)}}),a=wa(e.prototype),H_(a,{el:null,append:!0,data:f,partials:s,magic:l.magic||e.defaults.magic,modifyArrays:l.modifyArrays,adapt:l.adapt},{parent:l,component:t,container:c,mappings:g,inlinePartials:p,cssIds:h.cssIds}),d=!0,t.resolvers=v,a},G_=fs,q_=function(t){var e,i;for(e=t.root;e;)(i=e._liveComponentQueries["_"+t.name])&&i.push(t.instance),e=e.parent},Y_=gs,J_=vs,$_=_s,K_=ys,Q_=ws,X_=new ih("teardown"),ty=Ls,ey=function(t,e){this.init(t,e)};ey.prototype={detach:Ov,find:Iv,findAll:Rv,findAllComponents:zv,findComponent:Uv,findNextNode:Bv,firstNode:Nv,init:Y_,rebind:J_,render:$_,toString:K_,unbind:Q_,unrender:ty};var iy=ey,ny=function(t){this.type=eu,this.value=t.template.c;
};ny.prototype={detach:Dp,firstNode:function(){return this.node},render:function(){return this.node||(this.node=document.createComment(this.value)),this.node},toString:function(){return"<!--"+this.value+"-->"},unrender:function(t){t&&this.node.parentNode.removeChild(this.node)}};var oy=ny,ry=function(t){var e,i;this.type=su,this.container=e=t.parentFragment.root,this.component=i=e.component,this.container=e,this.containerFragment=t.parentFragment,this.parentFragment=i.parentFragment;var n=this.name=t.template.n||"",o=e._inlinePartials[n];o||(m('Could not find template for partial "'+n+'"',{ractive:t.root}),o=[]),this.fragment=new _y({owner:this,root:e.parent,template:o,pElement:this.containerFragment.pElement}),r(i.yielders[n])?i.yielders[n].push(this):i.yielders[n]=[this],mh.scheduleTask(function(){if(i.yielders[n].length>1)throw new Error("A component template can only have one {{yield"+(n?" "+n:"")+"}} declaration at a time")})};ry.prototype={detach:function(){return this.fragment.detach()},find:function(t){return this.fragment.find(t)},findAll:function(t,e){return this.fragment.findAll(t,e)},findComponent:function(t){return this.fragment.findComponent(t)},findAllComponents:function(t,e){return this.fragment.findAllComponents(t,e)},findNextNode:function(){return this.containerFragment.findNextNode(this)},firstNode:function(){return this.fragment.firstNode()},getValue:function(t){return this.fragment.getValue(t)},render:function(){return this.fragment.render()},unbind:function(){this.fragment.unbind()},unrender:function(t){this.fragment.unrender(t),z(this.component.yielders[this.name],this)},rebind:function(t,e){this.fragment.rebind(t,e)},toString:function(){return this.fragment.toString()}};var sy=ry,ay=function(t){this.declaration=t.template.a};ay.prototype={init:Da,render:Da,unrender:Da,teardown:Da,toString:function(){return"<!DOCTYPE"+this.declaration+">"}};var hy=ay,ly=xs,uy=Es,cy=Ps,dy=Ms,py=Ss,fy=Os,my=function(t){this.init(t)};my.prototype={bubble:yp,detach:wp,find:bp,findAll:Lp,findAllComponents:xp,findComponent:kp,findNextNode:Ep,firstNode:Pp,getArgsList:Cp,getNode:Tp,getValue:Sp,init:ly,rebind:uy,registerIndexRef:function(t){var e=this.registeredIndexRefs;-1===e.indexOf(t)&&e.push(t)},render:cy,toString:dy,unbind:py,unregisterIndexRef:function(t){var e=this.registeredIndexRefs;e.splice(e.indexOf(t),1)},unrender:fy};var gy,vy,_y=my,yy=As,wy=["template","partials","components","decorators","events"],by=new ih("reset"),Ly=function(t,e){function i(e,n,o){o&&o.partials[t]||e.forEach(function(e){e.type===tu&&e.getPartialName()===t&&n.push(e),e.fragment&&i(e.fragment.items,n,o),r(e.fragments)?i(e.fragments,n,o):r(e.items)?i(e.items,n,o):e.type===ru&&e.instance&&i(e.instance.fragment.items,n,e.instance),e.type===Xl&&(r(e.attributes)&&i(e.attributes,n,o),r(e.conditionalAttributes)&&i(e.conditionalAttributes,n,o))})}var n,o=[];return i(this.fragment.items,o),this.partials[t]=e,n=mh.start(this,!0),o.forEach(function(e){e.value=void 0,e.setValue(t)}),mh.end(),n},xy=Is,ky=vl("reverse"),Ey=Rs,Py=vl("shift"),My=vl("sort"),Cy=vl("splice"),Ty=Us,Sy=Bs,Dy=new ih("teardown"),Oy=Fs,Ay=js,Iy=Zs,Ry=new ih("unrender"),zy=vl("unshift"),Uy=Hs,By=new ih("update"),Ny=Vs,Fy={add:$a,animate:bh,detach:xh,find:Eh,findAll:Ih,findAllComponents:Rh,findComponent:zh,findContainer:Uh,findParent:Bh,fire:Zh,get:Hh,insert:Wh,merge:qh,observe:hl,observeOnce:ll,off:dl,on:pl,once:fl,pop:_l,push:yl,render:Pl,reset:yy,resetPartial:Ly,resetTemplate:xy,reverse:ky,set:Ey,shift:Py,sort:My,splice:Cy,subtract:Ty,teardown:Sy,toggle:Oy,toHTML:Ay,toHtml:Ay,unrender:Iy,unshift:zy,update:Uy,updateModel:Ny},jy=function(t,e,i){return i||Gs(t,e)?function(){var i,n="_super"in this,o=this._super;return this._super=e,i=t.apply(this,arguments),n&&(this._super=o),i}:t},Zy=qs,Hy=Ks,Vy=function(t){var e,i,n={};return t&&(e=t._ractive)?(n.ractive=e.root,n.keypath=e.keypath.str,n.index={},(i=Hp(e.proxy.parentFragment))&&(n.index=Hp.resolve(i)),n):n};gy=function(t){return this instanceof gy?void H_(this,t):new gy(t)},vy={DEBUG:{writable:!0,value:!0},DEBUG_PROMISES:{writable:!0,value:!0},extend:{value:Hy},getNodeInfo:{value:Vy},parse:{value:Yd},Promise:{value:sh},svg:{value:oa},magic:{value:ia},VERSION:{value:"0.7.3"},adaptors:{writable:!0,value:{}},components:{writable:!0,value:{}},decorators:{writable:!0,value:{}},easing:{writable:!0,value:la},events:{writable:!0,value:{}},interpolators:{writable:!0,value:Na},partials:{writable:!0,value:{}},transitions:{writable:!0,value:{}}},La(gy,vy),gy.prototype=n(Fy,ha),gy.prototype.constructor=gy,gy.defaults=gy.prototype;var Wy="function";if(typeof Date.now!==Wy||typeof String.prototype.trim!==Wy||typeof Object.keys!==Wy||typeof Array.prototype.indexOf!==Wy||typeof Array.prototype.forEach!==Wy||typeof Array.prototype.map!==Wy||typeof Array.prototype.filter!==Wy||"undefined"!=typeof window&&typeof window.addEventListener!==Wy)throw new Error("It looks like you're attempting to use Ractive.js in an older browser. You'll need to use one of the 'legacy builds' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.");var Gy=gy;return Gy}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t.Ractive=t.Ractive||{},t.Ractive.events=t.Ractive.events||{},t.Ractive.events.tap=e())}(this,function(){"use strict";function t(t,i){return new e(t,i)}function e(t,e){this.node=t,this.callback=e,this.preventMousedownEvents=!1,this.bind(t)}function i(t){this.__tap_handler__.mousedown(t)}function n(t){this.__tap_handler__.touchdown(t)}function o(){this.addEventListener("keydown",s,!1),this.addEventListener("blur",r,!1)}function r(){this.removeEventListener("keydown",s,!1),this.removeEventListener("blur",r,!1)}function s(t){32===t.which&&this.__tap_handler__.fire()}var a=5,h=400;return e.prototype={bind:function(t){window.navigator.pointerEnabled?t.addEventListener("pointerdown",i,!1):window.navigator.msPointerEnabled?t.addEventListener("MSPointerDown",i,!1):(t.addEventListener("mousedown",i,!1),t.addEventListener("touchstart",n,!1)),("BUTTON"===t.tagName||"button"===t.type)&&t.addEventListener("focus",o,!1),t.__tap_handler__=this},fire:function(t,e,i){this.callback({node:this.node,original:t,x:e,y:i})},mousedown:function(t){var e=this;if(!this.preventMousedownEvents&&(void 0===t.which||1===t.which)){var i=t.clientX,n=t.clientY,o=t.pointerId,r=function(t){t.pointerId==o&&(e.fire(t,i,n),l())},s=function(t){t.pointerId==o&&(Math.abs(t.clientX-i)>=a||Math.abs(t.clientY-n)>=a)&&l()},l=function(){e.node.removeEventListener("MSPointerUp",r,!1),document.removeEventListener("MSPointerMove",s,!1),document.removeEventListener("MSPointerCancel",l,!1),e.node.removeEventListener("pointerup",r,!1),document.removeEventListener("pointermove",s,!1),document.removeEventListener("pointercancel",l,!1),e.node.removeEventListener("click",r,!1),document.removeEventListener("mousemove",s,!1)};window.navigator.pointerEnabled?(this.node.addEventListener("pointerup",r,!1),document.addEventListener("pointermove",s,!1),document.addEventListener("pointercancel",l,!1)):window.navigator.msPointerEnabled?(this.node.addEventListener("MSPointerUp",r,!1),document.addEventListener("MSPointerMove",s,!1),document.addEventListener("MSPointerCancel",l,!1)):(this.node.addEventListener("click",r,!1),document.addEventListener("mousemove",s,!1)),setTimeout(l,h)}},touchdown:function(t){var e=this,i=t.touches[0],n=i.clientX,o=i.clientY,r=i.identifier,s=function(t){var i=t.changedTouches[0];return i.identifier!==r?void u():(t.preventDefault(),e.preventMousedownEvents=!0,clearTimeout(e.preventMousedownTimeout),e.preventMousedownTimeout=setTimeout(function(){e.preventMousedownEvents=!1},400),e.fire(t,n,o),void u())},l=function(t){(1!==t.touches.length||t.touches[0].identifier!==r)&&u();var e=t.touches[0];(Math.abs(e.clientX-n)>=a||Math.abs(e.clientY-o)>=a)&&u()},u=function(){e.node.removeEventListener("touchend",s,!1),window.removeEventListener("touchmove",l,!1),window.removeEventListener("touchcancel",u,!1)};this.node.addEventListener("touchend",s,!1),window.addEventListener("touchmove",l,!1),window.addEventListener("touchcancel",u,!1),setTimeout(u,h)},teardown:function(){var t=this.node;t.removeEventListener("pointerdown",i,!1),t.removeEventListener("MSPointerDown",i,!1),t.removeEventListener("mousedown",i,!1),t.removeEventListener("touchstart",n,!1),t.removeEventListener("focus",o,!1)}},t}),function(t,e){"use strict";if("undefined"!=typeof module&&module.exports&&"function"==typeof require)e(require("ractive"));else if("function"==typeof define&&define.amd)define(["ractive"],e);else{if(!t.Ractive)throw new Error("Could not find Ractive! It must be loaded before the ractive-transitions-slide plugin");e(t.Ractive)}}("undefined"!=typeof window?window:this,function(t){"use strict";var e,i,n,o;o={duration:300,easing:"easeInOut"},i=["height","borderTopWidth","borderBottomWidth","paddingTop","paddingBottom","marginTop","marginBottom"],n={height:0,borderTopWidth:0,borderBottomWidth:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0},e=function(t,e){var r;e=t.processParams(e,o),t.isIntro?(r=t.getStyle(i),t.setStyle(n)):(t.setStyle(t.getStyle(i)),r=n),t.setStyle("overflowY","hidden"),t.animateStyle(r,e).then(t.complete)},t.transitions.slide=e}),function(){function t(t){function e(e,i,n,o,r,s){for(;r>=0&&s>r;r+=t){var a=o?o[r]:r;n=i(n,e[a],a,e)}return n}return function(i,n,o,r){n=y(n,r,4);var s=!P(i)&&_.keys(i),a=(s||i).length,h=t>0?0:a-1;return arguments.length<3&&(o=i[s?s[h]:h],h+=t),e(i,n,o,s,h,a)}}function e(t){return function(e,i,n){i=w(i,n);for(var o=E(e),r=t>0?0:o-1;r>=0&&o>r;r+=t)if(i(e[r],r,e))return r;return-1}}function i(t,e,i){return function(n,o,r){var s=0,a=E(n);if("number"==typeof r)t>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(i&&r&&a)return r=i(n,o),n[r]===o?r:-1;if(o!==o)return r=e(u.call(n,s,a),_.isNaN),r>=0?r+s:-1;for(r=t>0?s:a-1;r>=0&&a>r;r+=t)if(n[r]===o)return r;return-1}}function n(t,e){var i=D.length,n=t.constructor,o=_.isFunction(n)&&n.prototype||a,r="constructor";for(_.has(t,r)&&!_.contains(e,r)&&e.push(r);i--;)r=D[i],r in t&&t[r]!==o[r]&&!_.contains(e,r)&&e.push(r)}var o=this,r=o._,s=Array.prototype,a=Object.prototype,h=Function.prototype,l=s.push,u=s.slice,c=a.toString,d=a.hasOwnProperty,p=Array.isArray,f=Object.keys,m=h.bind,g=Object.create,v=function(){},_=function(t){return t instanceof _?t:this instanceof _?void(this._wrapped=t):new _(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):o._=_,_.VERSION="1.8.3";var y=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,r){return t.call(e,i,n,o,r)}}return function(){return t.apply(e,arguments)}},w=function(t,e,i){return null==t?_.identity:_.isFunction(t)?y(t,e,i):_.isObject(t)?_.matcher(t):_.property(t)};_.iteratee=function(t,e){return w(t,e,1/0)};var b=function(t,e){return function(i){var n=arguments.length;if(2>n||null==i)return i;for(var o=1;n>o;o++)for(var r=arguments[o],s=t(r),a=s.length,h=0;a>h;h++){var l=s[h];e&&void 0!==i[l]||(i[l]=r[l])}return i}},L=function(t){if(!_.isObject(t))return{};if(g)return g(t);v.prototype=t;var e=new v;return v.prototype=null,e},x=function(t){return function(e){return null==e?void 0:e[t]}},k=Math.pow(2,53)-1,E=x("length"),P=function(t){var e=E(t);return"number"==typeof e&&e>=0&&k>=e};_.each=_.forEach=function(t,e,i){e=y(e,i);var n,o;if(P(t))for(n=0,o=t.length;o>n;n++)e(t[n],n,t);else{var r=_.keys(t);for(n=0,o=r.length;o>n;n++)e(t[r[n]],r[n],t)}return t},_.map=_.collect=function(t,e,i){e=w(e,i);for(var n=!P(t)&&_.keys(t),o=(n||t).length,r=Array(o),s=0;o>s;s++){var a=n?n[s]:s;r[s]=e(t[a],a,t)}return r},_.reduce=_.foldl=_.inject=t(1),_.reduceRight=_.foldr=t(-1),_.find=_.detect=function(t,e,i){var n;return n=P(t)?_.findIndex(t,e,i):_.findKey(t,e,i),void 0!==n&&-1!==n?t[n]:void 0},_.filter=_.select=function(t,e,i){var n=[];return e=w(e,i),_.each(t,function(t,i,o){e(t,i,o)&&n.push(t)}),n},_.reject=function(t,e,i){return _.filter(t,_.negate(w(e)),i)},_.every=_.all=function(t,e,i){e=w(e,i);for(var n=!P(t)&&_.keys(t),o=(n||t).length,r=0;o>r;r++){var s=n?n[r]:r;if(!e(t[s],s,t))return!1}return!0},_.some=_.any=function(t,e,i){e=w(e,i);for(var n=!P(t)&&_.keys(t),o=(n||t).length,r=0;o>r;r++){var s=n?n[r]:r;if(e(t[s],s,t))return!0}return!1},_.contains=_.includes=_.include=function(t,e,i,n){return P(t)||(t=_.values(t)),("number"!=typeof i||n)&&(i=0),_.indexOf(t,e,i)>=0},_.invoke=function(t,e){var i=u.call(arguments,2),n=_.isFunction(e);return _.map(t,function(t){var o=n?e:t[e];return null==o?o:o.apply(t,i)})},_.pluck=function(t,e){return _.map(t,_.property(e))},_.where=function(t,e){return _.filter(t,_.matcher(e))},_.findWhere=function(t,e){return _.find(t,_.matcher(e))},_.max=function(t,e,i){var n,o,r=-(1/0),s=-(1/0);if(null==e&&null!=t){t=P(t)?t:_.values(t);for(var a=0,h=t.length;h>a;a++)n=t[a],n>r&&(r=n)}else e=w(e,i),_.each(t,function(t,i,n){o=e(t,i,n),(o>s||o===-(1/0)&&r===-(1/0))&&(r=t,s=o)});return r},_.min=function(t,e,i){var n,o,r=1/0,s=1/0;if(null==e&&null!=t){t=P(t)?t:_.values(t);for(var a=0,h=t.length;h>a;a++)n=t[a],r>n&&(r=n)}else e=w(e,i),_.each(t,function(t,i,n){o=e(t,i,n),(s>o||o===1/0&&r===1/0)&&(r=t,s=o)});return r},_.shuffle=function(t){for(var e,i=P(t)?t:_.values(t),n=i.length,o=Array(n),r=0;n>r;r++)e=_.random(0,r),e!==r&&(o[r]=o[e]),o[e]=i[r];return o},_.sample=function(t,e,i){return null==e||i?(P(t)||(t=_.values(t)),t[_.random(t.length-1)]):_.shuffle(t).slice(0,Math.max(0,e))},_.sortBy=function(t,e,i){return e=w(e,i),_.pluck(_.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var M=function(t){return function(e,i,n){var o={};return i=w(i,n),_.each(e,function(n,r){var s=i(n,r,e);t(o,n,s)}),o}};_.groupBy=M(function(t,e,i){_.has(t,i)?t[i].push(e):t[i]=[e]}),_.indexBy=M(function(t,e,i){t[i]=e}),_.countBy=M(function(t,e,i){_.has(t,i)?t[i]++:t[i]=1}),_.toArray=function(t){return t?_.isArray(t)?u.call(t):P(t)?_.map(t,_.identity):_.values(t):[]},_.size=function(t){return null==t?0:P(t)?t.length:_.keys(t).length},_.partition=function(t,e,i){e=w(e,i);var n=[],o=[];return _.each(t,function(t,i,r){(e(t,i,r)?n:o).push(t)}),[n,o]},_.first=_.head=_.take=function(t,e,i){return null!=t?null==e||i?t[0]:_.initial(t,t.length-e):void 0},_.initial=function(t,e,i){return u.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},_.last=function(t,e,i){return null!=t?null==e||i?t[t.length-1]:_.rest(t,Math.max(0,t.length-e)):void 0},_.rest=_.tail=_.drop=function(t,e,i){return u.call(t,null==e||i?1:e)},_.compact=function(t){return _.filter(t,_.identity)};var C=function(t,e,i,n){for(var o=[],r=0,s=n||0,a=E(t);a>s;s++){var h=t[s];if(P(h)&&(_.isArray(h)||_.isArguments(h))){e||(h=C(h,e,i));var l=0,u=h.length;for(o.length+=u;u>l;)o[r++]=h[l++]}else i||(o[r++]=h)}return o};_.flatten=function(t,e){return C(t,e,!1)},_.without=function(t){return _.difference(t,u.call(arguments,1))},_.uniq=_.unique=function(t,e,i,n){_.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=w(i,n));for(var o=[],r=[],s=0,a=E(t);a>s;s++){var h=t[s],l=i?i(h,s,t):h;e?(s&&r===l||o.push(h),r=l):i?_.contains(r,l)||(r.push(l),o.push(h)):_.contains(o,h)||o.push(h)}return o},_.union=function(){return _.uniq(C(arguments,!0,!0))},_.intersection=function(t){for(var e=[],i=arguments.length,n=0,o=E(t);o>n;n++){var r=t[n];if(!_.contains(e,r)){for(var s=1;i>s&&_.contains(arguments[s],r);s++);s===i&&e.push(r)}}return e},_.difference=function(t){var e=C(arguments,!0,!0,1);return _.filter(t,function(t){return!_.contains(e,t)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(t){for(var e=t&&_.max(t,E).length||0,i=Array(e),n=0;e>n;n++)i[n]=_.pluck(t,n);return i},_.object=function(t,e){for(var i={},n=0,o=E(t);o>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},_.findIndex=e(1),_.findLastIndex=e(-1),_.sortedIndex=function(t,e,i,n){i=w(i,n,1);for(var o=i(e),r=0,s=E(t);s>r;){var a=Math.floor((r+s)/2);i(t[a])<o?r=a+1:s=a}return r},_.indexOf=i(1,_.findIndex,_.sortedIndex),_.lastIndexOf=i(-1,_.findLastIndex),_.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=Array(n),r=0;n>r;r++,t+=i)o[r]=t;return o};var T=function(t,e,i,n,o){if(!(n instanceof e))return t.apply(i,o);var r=L(t.prototype),s=t.apply(r,o);return _.isObject(s)?s:r};_.bind=function(t,e){if(m&&t.bind===m)return m.apply(t,u.call(arguments,1));if(!_.isFunction(t))throw new TypeError("Bind must be called on a function");var i=u.call(arguments,2),n=function(){return T(t,n,e,this,i.concat(u.call(arguments)))};return n},_.partial=function(t){var e=u.call(arguments,1),i=function(){for(var n=0,o=e.length,r=Array(o),s=0;o>s;s++)r[s]=e[s]===_?arguments[n++]:e[s];for(;n<arguments.length;)r.push(arguments[n++]);return T(t,i,this,this,r)};return i},_.bindAll=function(t){var e,i,n=arguments.length;if(1>=n)throw new Error("bindAll must be passed function names");for(e=1;n>e;e++)i=arguments[e],t[i]=_.bind(t[i],t);return t},_.memoize=function(t,e){var i=function(n){var o=i.cache,r=""+(e?e.apply(this,arguments):n);return _.has(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return i.cache={},i},_.delay=function(t,e){var i=u.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},_.defer=_.partial(_.delay,_,1),_.throttle=function(t,e,i){var n,o,r,s=null,a=0;i||(i={});var h=function(){a=i.leading===!1?0:_.now(),s=null,r=t.apply(n,o),s||(n=o=null)};return function(){var l=_.now();a||i.leading!==!1||(a=l);var u=e-(l-a);return n=this,o=arguments,0>=u||u>e?(s&&(clearTimeout(s),s=null),a=l,r=t.apply(n,o),s||(n=o=null)):s||i.trailing===!1||(s=setTimeout(h,u)),r}},_.debounce=function(t,e,i){var n,o,r,s,a,h=function(){var l=_.now()-s;e>l&&l>=0?n=setTimeout(h,e-l):(n=null,i||(a=t.apply(r,o),n||(r=o=null)))};return function(){r=this,o=arguments,s=_.now();var l=i&&!n;return n||(n=setTimeout(h,e)),l&&(a=t.apply(r,o),r=o=null),a}},_.wrap=function(t,e){return _.partial(e,t)},_.negate=function(t){return function(){return!t.apply(this,arguments)}},_.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},_.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},_.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),1>=t&&(e=null),i}},_.once=_.partial(_.before,2);var S=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(t){if(!_.isObject(t))return[];if(f)return f(t);var e=[];for(var i in t)_.has(t,i)&&e.push(i);return S&&n(t,e),e},_.allKeys=function(t){if(!_.isObject(t))return[];var e=[];for(var i in t)e.push(i);return S&&n(t,e),e},_.values=function(t){for(var e=_.keys(t),i=e.length,n=Array(i),o=0;i>o;o++)n[o]=t[e[o]];return n},_.mapObject=function(t,e,i){e=w(e,i);for(var n,o=_.keys(t),r=o.length,s={},a=0;r>a;a++)n=o[a],s[n]=e(t[n],n,t);return s},_.pairs=function(t){for(var e=_.keys(t),i=e.length,n=Array(i),o=0;i>o;o++)n[o]=[e[o],t[e[o]]];return n},_.invert=function(t){for(var e={},i=_.keys(t),n=0,o=i.length;o>n;n++)e[t[i[n]]]=i[n];return e},_.functions=_.methods=function(t){var e=[];for(var i in t)_.isFunction(t[i])&&e.push(i);return e.sort()},_.extend=b(_.allKeys),_.extendOwn=_.assign=b(_.keys),_.findKey=function(t,e,i){e=w(e,i);for(var n,o=_.keys(t),r=0,s=o.length;s>r;r++)if(n=o[r],e(t[n],n,t))return n},_.pick=function(t,e,i){var n,o,r={},s=t;if(null==s)return r;_.isFunction(e)?(o=_.allKeys(s),n=y(e,i)):(o=C(arguments,!1,!1,1),n=function(t,e,i){return e in i},s=Object(s));for(var a=0,h=o.length;h>a;a++){var l=o[a],u=s[l];n(u,l,s)&&(r[l]=u)}return r},_.omit=function(t,e,i){if(_.isFunction(e))e=_.negate(e);else{var n=_.map(C(arguments,!1,!1,1),String);e=function(t,e){return!_.contains(n,e)}}return _.pick(t,e,i)},_.defaults=b(_.allKeys,!0),_.create=function(t,e){var i=L(t);return e&&_.extendOwn(i,e),i},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend({},t):t},_.tap=function(t,e){return e(t),t},_.isMatch=function(t,e){var i=_.keys(e),n=i.length;if(null==t)return!n;for(var o=Object(t),r=0;n>r;r++){var s=i[r];if(e[s]!==o[s]||!(s in o))return!1}return!0};var O=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof _&&(t=t._wrapped),e instanceof _&&(e=e._wrapped);var o=c.call(t);if(o!==c.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(_.isFunction(s)&&s instanceof s&&_.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var h=i.length;h--;)if(i[h]===t)return n[h]===e;if(i.push(t),n.push(e),r){if(h=t.length,h!==e.length)return!1;for(;h--;)if(!O(t[h],e[h],i,n))return!1}else{var l,u=_.keys(t);if(h=u.length,_.keys(e).length!==h)return!1;for(;h--;)if(l=u[h],!_.has(e,l)||!O(t[l],e[l],i,n))return!1}return i.pop(),n.pop(),!0};_.isEqual=function(t,e){return O(t,e)},_.isEmpty=function(t){return null==t?!0:P(t)&&(_.isArray(t)||_.isString(t)||_.isArguments(t))?0===t.length:0===_.keys(t).length},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=p||function(t){return"[object Array]"===c.call(t)},_.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){_["is"+t]=function(e){return c.call(e)==="[object "+t+"]"}}),_.isArguments(arguments)||(_.isArguments=function(t){return _.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(t){return"function"==typeof t||!1}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!==+t},_.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===c.call(t)},_.isNull=function(t){return null===t},_.isUndefined=function(t){return void 0===t},_.has=function(t,e){return null!=t&&d.call(t,e)},_.noConflict=function(){return o._=r,this},_.identity=function(t){return t},_.constant=function(t){return function(){return t}},_.noop=function(){},_.property=x,_.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},_.matcher=_.matches=function(t){return t=_.extendOwn({},t),function(e){return _.isMatch(e,t)}},_.times=function(t,e,i){var n=Array(Math.max(0,t));e=y(e,i,1);for(var o=0;t>o;o++)n[o]=e(o);return n},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.now=Date.now||function(){return(new Date).getTime()};var A={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=_.invert(A),R=function(t){var e=function(e){return t[e]},i="(?:"+_.keys(t).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}};_.escape=R(A),_.unescape=R(I),_.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),_.isFunction(n)?n.call(t):n};var z=0;_.uniqueId=function(t){var e=++z+"";return t?t+e:e},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var U=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,F=function(t){return"\\"+B[t]};_.template=function(t,e,i){!e&&i&&(e=i),e=_.defaults({},e,_.templateSettings);var n=RegExp([(e.escape||U).source,(e.interpolate||U).source,(e.evaluate||U).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(n,function(e,i,n,s,a){return r+=t.slice(o,a).replace(N,F),o=a+e.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?r+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(a){throw a.source=r,a}var h=function(t){return s.call(this,t,_)},l=e.variable||"obj";return h.source="function("+l+"){\n"+r+"}",h},_.chain=function(t){var e=_(t);return e._chain=!0,e};var j=function(t,e){return t._chain?_(e).chain():e};_.mixin=function(t){_.each(_.functions(t),function(e){var i=_[e]=t[e];_.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),j(this,i.apply(_,t))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];_.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],j(this,i)}}),_.each(["concat","join","slice"],function(t){var e=s[t];_.prototype[t]=function(){return j(this,e.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),!function(t,e,i){var n=t.L,o={};o.version="0.7.7","object"==typeof module&&"object"==typeof module.exports?module.exports=o:"function"==typeof define&&define.amd&&define(o),o.noConflict=function(){return t.L=n,this},t.L=o,o.Util={extend:function(t){var e,i,n,o,r=Array.prototype.slice.call(arguments,1);for(i=0,n=r.length;n>i;i++){o=r[i]||{};for(e in o)o.hasOwnProperty(e)&&(t[e]=o[e])}return t},bind:function(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(i){return i[e]=i[e]||++t,i[e]}}(),invokeEach:function(t,e,i){var n,o;if("object"==typeof t){o=Array.prototype.slice.call(arguments,3);for(n in t)e.apply(i,[n,t[n]].concat(o));return!0}return!1},limitExecByInterval:function(t,e,i){var n,o;return function r(){var s=arguments;return n?void(o=!0):(n=!0,setTimeout(function(){n=!1,o&&(r.apply(i,s),o=!1)},e),void t.apply(i,s))}},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return o.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=o.extend({},t.options,e),t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var o=e[n];if(o===i)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var i,n,o=["webkit","moz","o","ms"];for(i=0;i<o.length&&!n;i++)n=t[o[i]+e];return n}function i(e){var i=+new Date,o=Math.max(0,16-(i-n));return n=i+o,t.setTimeout(e,o)}var n=0,r=t.requestAnimationFrame||e("RequestAnimationFrame")||i,s=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};o.Util.requestAnimFrame=function(e,n,s,a){return e=o.bind(e,n),s&&r===i?void e():r.call(t,e,a)},o.Util.cancelAnimFrame=function(e){e&&s.call(t,e)}}(),o.extend=o.Util.extend,o.bind=o.Util.bind,o.stamp=o.Util.stamp,o.setOptions=o.Util.setOptions,o.Class=function(){},o.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},i=function(){};i.prototype=this.prototype;var n=new i;n.constructor=e,e.prototype=n;for(var r in this)this.hasOwnProperty(r)&&"prototype"!==r&&(e[r]=this[r]);t.statics&&(o.extend(e,t.statics),delete t.statics),t.includes&&(o.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=o.extend({},n.options,t.options)),o.extend(n,t),n._initHooks=[];var s=this;return e.__super__=s.prototype,n.callInitHooks=function(){if(!this._initHooksCalled){s.prototype.callInitHooks&&s.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;e>t;t++)n._initHooks[t].call(this)}},e},o.Class.include=function(t){o.extend(this.prototype,t)},o.Class.mergeOptions=function(t){o.extend(this.prototype.options,t)},o.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)};var r="_leaflet_events";o.Mixin={},o.Mixin.Events={addEventListener:function(t,e,i){if(o.Util.invokeEach(t,this.addEventListener,this,e,i))return this;var n,s,a,h,l,u,c,d=this[r]=this[r]||{},p=i&&i!==this&&o.stamp(i);for(t=o.Util.splitWords(t),n=0,s=t.length;s>n;n++)a={action:e,context:i||this},h=t[n],p?(l=h+"_idx",u=l+"_len",c=d[l]=d[l]||{},c[p]||(c[p]=[],d[u]=(d[u]||0)+1),c[p].push(a)):(d[h]=d[h]||[],d[h].push(a));return this},hasEventListeners:function(t){var e=this[r];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,i){if(!this[r])return this;if(!t)return this.clearAllEventListeners();if(o.Util.invokeEach(t,this.removeEventListener,this,e,i))return this;var n,s,a,h,l,u,c,d,p,f=this[r],m=i&&i!==this&&o.stamp(i);for(t=o.Util.splitWords(t),n=0,s=t.length;s>n;n++)if(a=t[n],u=a+"_idx",c=u+"_len",d=f[u],e){if(h=m&&d?d[m]:f[a]){for(l=h.length-1;l>=0;l--)h[l].action!==e||i&&h[l].context!==i||(p=h.splice(l,1),p[0].action=o.Util.falseFn);i&&d&&0===h.length&&(delete d[m],f[c]--)}}else delete f[a],delete f[u],delete f[c];return this},clearAllEventListeners:function(){return delete this[r],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var i,n,s,a,h,l=o.Util.extend({},e,{type:t,target:this}),u=this[r];if(u[t])for(i=u[t].slice(),n=0,s=i.length;s>n;n++)i[n].action.call(i[n].context,l);a=u[t+"_idx"];for(h in a)if(i=a[h].slice())for(n=0,s=i.length;s>n;n++)i[n].action.call(i[n].context,l);return this},addOneTimeEventListener:function(t,e,i){if(o.Util.invokeEach(t,this.addOneTimeEventListener,this,e,i))return this;var n=o.bind(function(){this.removeEventListener(t,e,i).removeEventListener(t,n,i)},this);return this.addEventListener(t,e,i).addEventListener(t,n,i)}},o.Mixin.Events.on=o.Mixin.Events.addEventListener,o.Mixin.Events.off=o.Mixin.Events.removeEventListener,o.Mixin.Events.once=o.Mixin.Events.addOneTimeEventListener,o.Mixin.Events.fire=o.Mixin.Events.fireEvent,function(){var n="ActiveXObject"in t,r=n&&!e.addEventListener,s=navigator.userAgent.toLowerCase(),a=-1!==s.indexOf("webkit"),h=-1!==s.indexOf("chrome"),l=-1!==s.indexOf("phantom"),u=-1!==s.indexOf("android"),c=-1!==s.search("android [23]"),d=-1!==s.indexOf("gecko"),p=typeof orientation!=i+"",f=!t.PointerEvent&&t.MSPointerEvent,m=t.PointerEvent&&t.navigator.pointerEnabled||f,g="devicePixelRatio"in t&&t.devicePixelRatio>1||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)")&&t.matchMedia("(min-resolution:144dpi)").matches,v=e.documentElement,_=n&&"transition"in v.style,y="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!c,w="MozPerspective"in v.style,b="OTransition"in v.style,L=!t.L_DISABLE_3D&&(_||y||w||b)&&!l,x=!t.L_NO_TOUCH&&!l&&(m||"ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch);o.Browser={ie:n,ielt9:r,webkit:a,gecko:d&&!a&&!t.opera&&!n,android:u,
android23:c,chrome:h,ie3d:_,webkit3d:y,gecko3d:w,opera3d:b,any3d:L,mobile:p,mobileWebkit:p&&a,mobileWebkit3d:p&&y,mobileOpera:p&&t.opera,touch:x,msPointer:f,pointer:m,retina:g}}(),o.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},o.Point.prototype={clone:function(){return new o.Point(this.x,this.y)},add:function(t){return this.clone()._add(o.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(o.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=o.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=o.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=o.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+o.Util.formatNum(this.x)+", "+o.Util.formatNum(this.y)+")"}},o.point=function(t,e,n){return t instanceof o.Point?t:o.Util.isArray(t)?new o.Point(t[0],t[1]):t===i||null===t?t:new o.Point(t,e,n)},o.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},o.Bounds.prototype={extend:function(t){return t=o.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new o.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new o.Point(this.min.x,this.max.y)},getTopRight:function(){return new o.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof o.Point?o.point(t):o.bounds(t),t instanceof o.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=o.bounds(t);var e=this.min,i=this.max,n=t.min,r=t.max,s=r.x>=e.x&&n.x<=i.x,a=r.y>=e.y&&n.y<=i.y;return s&&a},isValid:function(){return!(!this.min||!this.max)}},o.bounds=function(t,e){return!t||t instanceof o.Bounds?t:new o.Bounds(t,e)},o.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},o.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new o.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},o.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i];if(!n&&t.currentStyle&&(n=t.currentStyle[i]),(!n||"auto"===n)&&e.defaultView){var o=e.defaultView.getComputedStyle(t,null);n=o?o[i]:null}return"auto"===n?null:n},getViewportOffset:function(t){var i,n=0,r=0,s=t,a=e.body,h=e.documentElement;do{if(n+=s.offsetTop||0,r+=s.offsetLeft||0,n+=parseInt(o.DomUtil.getStyle(s,"borderTopWidth"),10)||0,r+=parseInt(o.DomUtil.getStyle(s,"borderLeftWidth"),10)||0,i=o.DomUtil.getStyle(s,"position"),s.offsetParent===a&&"absolute"===i)break;if("fixed"===i){n+=a.scrollTop||h.scrollTop||0,r+=a.scrollLeft||h.scrollLeft||0;break}if("relative"===i&&!s.offsetLeft){var l=o.DomUtil.getStyle(s,"width"),u=o.DomUtil.getStyle(s,"max-width"),c=s.getBoundingClientRect();("none"!==l||"none"!==u)&&(r+=c.left+s.clientLeft),n+=c.top+(a.scrollTop||h.scrollTop||0);break}s=s.offsetParent}while(s);s=t;do{if(s===a)break;n-=s.scrollTop||0,r-=s.scrollLeft||0,s=s.parentNode}while(s);return new o.Point(r,n)},documentIsLtr:function(){return o.DomUtil._docIsLtrCached||(o.DomUtil._docIsLtrCached=!0,o.DomUtil._docIsLtr="ltr"===o.DomUtil.getStyle(e.body,"direction")),o.DomUtil._docIsLtr},create:function(t,i,n){var o=e.createElement(t);return o.className=i,n&&n.appendChild(o),o},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=o.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=o.Util.splitWords(e),r=0,s=n.length;s>r;r++)t.classList.add(n[r]);else if(!o.DomUtil.hasClass(t,e)){var a=o.DomUtil._getClass(t);o.DomUtil._setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):o.DomUtil._setClass(t,o.Util.trim((" "+o.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(o){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},getTranslateString:function(t){var e=o.Browser.webkit3d,i="translate"+(e?"3d":"")+"(",n=(e?",0":"")+")";return i+t.x+"px,"+t.y+"px"+n},getScaleString:function(t,e){var i=o.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t))),n=" scale("+t+") ";return i+n},setPosition:function(t,e,i){t._leaflet_pos=e,!i&&o.Browser.any3d?t.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},o.DomUtil.TRANSFORM=o.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),o.DomUtil.TRANSITION=o.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),o.DomUtil.TRANSITION_END="webkitTransition"===o.DomUtil.TRANSITION||"OTransition"===o.DomUtil.TRANSITION?o.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in e)o.extend(o.DomUtil,{disableTextSelection:function(){o.DomEvent.on(t,"selectstart",o.DomEvent.preventDefault)},enableTextSelection:function(){o.DomEvent.off(t,"selectstart",o.DomEvent.preventDefault)}});else{var i=o.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);o.extend(o.DomUtil,{disableTextSelection:function(){if(i){var t=e.documentElement.style;this._userSelect=t[i],t[i]="none"}},enableTextSelection:function(){i&&(e.documentElement.style[i]=this._userSelect,delete this._userSelect)}})}o.extend(o.DomUtil,{disableImageDrag:function(){o.DomEvent.on(t,"dragstart",o.DomEvent.preventDefault)},enableImageDrag:function(){o.DomEvent.off(t,"dragstart",o.DomEvent.preventDefault)}})}(),o.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==i&&(this.alt=parseFloat(n))},o.extend(o.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),o.LatLng.prototype={equals:function(t){if(!t)return!1;t=o.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=o.LatLng.MAX_MARGIN},toString:function(t){return"LatLng("+o.Util.formatNum(this.lat,t)+", "+o.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=o.latLng(t);var e=6378137,i=o.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*i,r=(t.lng-this.lng)*i,s=this.lat*i,a=t.lat*i,h=Math.sin(n/2),l=Math.sin(r/2),u=h*h+l*l*Math.cos(s)*Math.cos(a);return 2*e*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))},wrap:function(t,e){var i=this.lng;return t=t||-180,e=e||180,i=(i+e)%(e-t)+(t>i||i===e?e:t),new o.LatLng(this.lat,i)}},o.latLng=function(t,e){return t instanceof o.LatLng?t:o.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new o.LatLng(t[0],t[1],t[2]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new o.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===i?null:new o.LatLng(t,e)},o.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},o.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=o.latLng(t);return t=null!==e?e:o.latLngBounds(t),t instanceof o.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new o.LatLng(t.lat,t.lng),this._northEast=new o.LatLng(t.lat,t.lng)):t instanceof o.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,r=Math.abs(e.lng-i.lng)*t;return new o.LatLngBounds(new o.LatLng(e.lat-n,e.lng-r),new o.LatLng(i.lat+n,i.lng+r))},getCenter:function(){return new o.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new o.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new o.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof o.LatLng?o.latLng(t):o.latLngBounds(t);var e,i,n=this._southWest,r=this._northEast;return t instanceof o.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=r.lat&&e.lng>=n.lng&&i.lng<=r.lng},intersects:function(t){t=o.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),s=r.lat>=e.lat&&n.lat<=i.lat,a=r.lng>=e.lng&&n.lng<=i.lng;return s&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=o.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},o.latLngBounds=function(t,e){return!t||t instanceof o.LatLngBounds?t:new o.LatLngBounds(t,e)},o.Projection={},o.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=o.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=t.lng*e,s=n*e;return s=Math.log(Math.tan(Math.PI/4+s/2)),new o.Point(r,s)},unproject:function(t){var e=o.LatLng.RAD_TO_DEG,i=t.x*e,n=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new o.LatLng(n,i)}},o.Projection.LonLat={project:function(t){return new o.Point(t.lng,t.lat)},unproject:function(t){return new o.LatLng(t.y,t.x)}},o.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return o.point(e,e)}},o.CRS.Simple=o.extend({},o.CRS,{projection:o.Projection.LonLat,transformation:new o.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),o.CRS.EPSG3857=o.extend({},o.CRS,{code:"EPSG:3857",projection:o.Projection.SphericalMercator,transformation:new o.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),i=6378137;return e.multiplyBy(i)}}),o.CRS.EPSG900913=o.extend({},o.CRS.EPSG3857,{code:"EPSG:900913"}),o.CRS.EPSG4326=o.extend({},o.CRS,{code:"EPSG:4326",projection:o.Projection.LonLat,transformation:new o.Transformation(1/360,.5,-1/360,.5)}),o.Map=o.Class.extend({includes:o.Mixin.Events,options:{crs:o.CRS.EPSG3857,fadeAnimation:o.DomUtil.TRANSITION&&!o.Browser.android23,trackResize:!0,markerZoomAnimation:o.DomUtil.TRANSITION&&o.Browser.any3d},initialize:function(t,e){e=o.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=o.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==i&&this.setView(o.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(o.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),r=this.getSize().divideBy(2),s=t instanceof o.Point?t:this.latLngToContainerPoint(t),a=s.subtract(r).multiplyBy(1-1/n),h=this.containerPointToLatLng(r.add(a));return this.setView(h,e,{zoom:i})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():o.latLngBounds(t);var i=o.point(e.paddingTopLeft||e.padding||[0,0]),n=o.point(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,i.add(n));r=e.maxZoom?Math.min(e.maxZoom,r):r;var s=n.subtract(i).divideBy(2),a=this.project(t.getSouthWest(),r),h=this.project(t.getNorthEast(),r),l=this.unproject(a.add(h).divideBy(2).add(s),r);return this.setView(l,r,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(o.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=o.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)?this:this.panTo(n,e)},addLayer:function(t){var e=o.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&o.TileLayer&&t instanceof o.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=o.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&o.TileLayer&&t instanceof o.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return t?o.stamp(t)in this._layers:!1},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=o.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),r=i.divideBy(2).round(),s=n.subtract(r);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=i}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new o.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom===i?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=o.latLngBounds(t);var n,r=this.getMinZoom()-(e?1:0),s=this.getMaxZoom(),a=this.getSize(),h=t.getNorthWest(),l=t.getSouthEast(),u=!0;i=o.point(i||[0,0]);do r++,n=this.project(l,r).subtract(this.project(h,r)).add(i),u=e?n.x<a.x||n.y<a.y:a.contains(n);while(u&&s>=r);return u&&e?null:e?r:r-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new o.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new o.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(o.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(o.point(t),e)},layerPointToLatLng:function(t){var e=o.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(o.latLng(t))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return o.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return o.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(o.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(o.latLng(t)))},mouseEventToContainerPoint:function(t){return o.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=o.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;o.DomUtil.addClass(t,"leaflet-container"+(o.Browser.touch?" leaflet-touch":"")+(o.Browser.retina?" leaflet-retina":"")+(o.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=o.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(o.DomUtil.addClass(t.markerPane,e),o.DomUtil.addClass(t.shadowPane,e),o.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return o.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?o.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_resetView:function(t,e,i,n){var r=this._zoom!==e;n||(this.fire("movestart"),r&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),i?this._initialTopLeftPoint._add(this._getMapPanePos()):o.DomUtil.setPosition(this._mapPane,new o.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var s=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!i}),s&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(r||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(t){o.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-(1/0),o=this._getZoomSpan();for(t in this._zoomBoundLayers){var r=this._zoomBoundLayers[t];isNaN(r.options.minZoom)||(e=Math.min(e,r.options.minZoom)),isNaN(r.options.maxZoom)||(n=Math.max(n,r.options.maxZoom))}t===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=n,this._layersMinZoom=e),o!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(o.DomEvent){e=e||"on",o.DomEvent[e](this._container,"click",this._onMouseClick,this);var i,n,r=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(i=0,n=r.length;n>i;i++)o.DomEvent[e](this._container,r[i],this._fireMouseEvent,this);this.options.trackResize&&o.DomEvent[e](t,"resize",this._onResize,this)}},_onResize:function(){o.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=o.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||o.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!o.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&o.DomEvent.preventDefault(t);var i=this.mouseEventToContainerPoint(t),n=this.containerPointToLayerPoint(i),r=this.layerPointToLatLng(n);this.fire(e,{latlng:r,layerPoint:n,containerPoint:i,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return o.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),r=this.getSize().divideBy(2),s=new o.Bounds(n.subtract(r),n.add(r)),a=this._getBoundsOffset(s,i,e);return this.unproject(n.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new o.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=this.project(e.getNorthWest(),i).subtract(t.min),r=this.project(e.getSouthEast(),i).subtract(t.max),s=this._rebound(n.x,-r.x),a=this._rebound(n.y,-r.y);return new o.Point(s,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),o.map=function(t,e){return new o.Map(t,e)},o.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=o.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=this.R_MAJOR,s=this.R_MINOR,a=t.lng*e*r,h=n*e,l=s/r,u=Math.sqrt(1-l*l),c=u*Math.sin(h);c=Math.pow((1-c)/(1+c),.5*u);var d=Math.tan(.5*(.5*Math.PI-h))/c;return h=-r*Math.log(d),new o.Point(a,h)},unproject:function(t){for(var e,i=o.LatLng.RAD_TO_DEG,n=this.R_MAJOR,r=this.R_MINOR,s=t.x*i/n,a=r/n,h=Math.sqrt(1-a*a),l=Math.exp(-t.y/n),u=Math.PI/2-2*Math.atan(l),c=15,d=1e-7,p=c,f=.1;Math.abs(f)>d&&--p>0;)e=h*Math.sin(u),f=Math.PI/2-2*Math.atan(l*Math.pow((1-e)/(1+e),.5*h))-u,u+=f;return new o.LatLng(u*i,s)}},o.CRS.EPSG3395=o.extend({},o.CRS,{code:"EPSG:3395",projection:o.Projection.Mercator,transformation:function(){var t=o.Projection.Mercator,e=t.R_MAJOR,i=.5/(Math.PI*e);return new o.Transformation(i,.5,-i,.5)}()}),o.TileLayer=o.Class.extend({includes:o.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:o.Browser.mobile,updateWhenIdle:o.Browser.mobile},initialize:function(t,e){e=o.setOptions(this,e),e.detectRetina&&o.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=o.latLngBounds(e.bounds)),this._url=t;var i=this.options.subdomains;"string"==typeof i&&(this.options.subdomains=i.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=o.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var i,n,o,r=t.children,s=-e(1/0,-(1/0));for(n=0,o=r.length;o>n;n++)r[n]!==this._container&&(i=parseInt(r[n].style.zIndex,10),isNaN(i)||(s=e(s,i)));this.options.zIndex=this._container.style.zIndex=(isFinite(s)?s:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(o.Browser.ielt9)for(t in e)o.DomUtil.setOpacity(e[t],this.options.opacity);else o.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=o.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=o.DomUtil.create("div",e,this._container),this._tileContainer=o.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,i=this.options.maxNativeZoom,n=this.options.tileSize;return i&&e>i&&(n=Math.round(t.getZoomScale(e)/t.getZoomScale(i)*n)),n},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),i=t.getZoom(),n=this._getTileSize();if(!(i>this.options.maxZoom||i<this.options.minZoom)){var r=o.bounds(e.min.divideBy(n)._floor(),e.max.divideBy(n)._floor());this._addTilesFromCenterOut(r),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(r)}}},_addTilesFromCenterOut:function(t){var i,n,r,s=[],a=t.getCenter();for(i=t.min.y;i<=t.max.y;i++)for(n=t.min.x;n<=t.max.x;n++)r=new o.Point(n,i),this._tileShouldBeLoaded(r)&&s.push(r);var h=s.length;if(0!==h){s.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)});var l=e.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=h,n=0;h>n;n++)this._addTile(s[n],l);this._tileContainer.appendChild(l)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var i=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=i.x)||t.y<0||t.y>=i.y)return!1}if(e.bounds){var n=this._getTileSize(),o=t.multiplyBy(n),r=o.add([n,n]),s=this._map.unproject(o),a=this._map.unproject(r);if(e.continuousWorld||e.noWrap||(s=s.wrap(),a=a.wrap()),!e.bounds.intersects([s,a]))return!1}return!0},_removeOtherTiles:function(t){var e,i,n,o;for(o in this._tiles)e=o.split(":"),i=parseInt(e[0],10),n=parseInt(e[1],10),(i<t.min.x||i>t.max.x||n<t.min.y||n>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(o.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),o.Browser.android||(e.onload=null,e.src=o.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var i=this._getTilePos(t),n=this._getTile();o.DomUtil.setPosition(n,i,o.Browser.chrome),this._tiles[t.x+":"+t.y]=n,this._loadTile(n,t),n.parentNode!==this._tileContainer&&e.appendChild(n)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),i=this._getTileSize();return t.multiplyBy(i).subtract(e)},getTileUrl:function(t){return o.Util.template(this._url,o.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,e=t.getSize(this._map.getZoom());return e.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;
return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=o.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=o.Util.falseFn,o.Browser.ielt9&&this.options.opacity!==i&&o.DomUtil.setOpacity(t,this.options.opacity),o.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&o.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(o.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==o.Util.emptyImageUrl&&(o.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),o.tileLayer=function(t,e){return new o.TileLayer(t,e)},o.TileLayer.WMS=o.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var i=o.extend({},this.defaultWmsParams),n=e.tileSize||this.options.tileSize;e.detectRetina&&o.Browser.retina?i.width=i.height=2*n:i.width=i.height=n;for(var r in e)this.options.hasOwnProperty(r)||"crs"===r||(i[r]=e[r]);this.wmsParams=i,o.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,o.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,i=this.options.tileSize,n=t.multiplyBy(i),r=n.add([i,i]),s=this._crs.project(e.unproject(n,t.z)),a=this._crs.project(e.unproject(r,t.z)),h=this._wmsVersion>=1.3&&this._crs===o.CRS.EPSG4326?[a.y,s.x,s.y,a.x].join(","):[s.x,a.y,a.x,s.y].join(","),l=o.Util.template(this._url,{s:this._getSubdomain(t)});return l+o.Util.getParamString(this.wmsParams,l,!0)+"&BBOX="+h},setParams:function(t,e){return o.extend(this.wmsParams,t),e||this.redraw(),this}}),o.tileLayer.wms=function(t,e){return new o.TileLayer.WMS(t,e)},o.TileLayer.Canvas=o.TileLayer.extend({options:{async:!1},initialize:function(t){o.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=o.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=o.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),o.tileLayer.canvas=function(t){return new o.TileLayer.Canvas(t)},o.ImageOverlay=o.Class.extend({includes:o.Mixin.Events,options:{opacity:1},initialize:function(t,e,i){this._url=t,this._bounds=o.latLngBounds(e),o.setOptions(this,i)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&o.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=o.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&o.Browser.any3d?o.DomUtil.addClass(this._image,"leaflet-zoom-animated"):o.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),o.extend(this._image,{galleryimg:"no",onselectstart:o.Util.falseFn,onmousemove:o.Util.falseFn,onload:o.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,i=this._image,n=e.getZoomScale(t.zoom),r=this._bounds.getNorthWest(),s=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(r,t.zoom,t.center),h=e._latLngToNewLayerPoint(s,t.zoom,t.center)._subtract(a),l=a._add(h._multiplyBy(.5*(1-1/n)));i.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(l)+" scale("+n+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),i=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);o.DomUtil.setPosition(t,e),t.style.width=i.x+"px",t.style.height=i.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){o.DomUtil.setOpacity(this._image,this.options.opacity)}}),o.imageOverlay=function(t,e,i){return new o.ImageOverlay(t,e,i)},o.Icon=o.Class.extend({options:{className:""},initialize:function(t){o.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n;return n=e&&"IMG"===e.tagName?this._createImg(i,e):this._createImg(i),this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i,n=this.options,r=o.point(n[e+"Size"]);i="shadow"===e?o.point(n.shadowAnchor||n.iconAnchor):o.point(n.iconAnchor),!i&&r&&(i=r.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+n.className,i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,i){return i=i||e.createElement("img"),i.src=t,i},_getIconUrl:function(t){return o.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),o.icon=function(t){return new o.Icon(t)},o.Icon.Default=o.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];o.Browser.retina&&"icon"===t&&(t+="-2x");var i=o.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+".png"}}),o.Icon.Default.imagePath=function(){var t,i,n,o,r,s=e.getElementsByTagName("script"),a=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,i=s.length;i>t;t++)if(n=s[t].src,o=n.match(a))return r=n.split(a)[0],(r?r+"/":"")+"images"}(),o.Marker=o.Class.extend({includes:o.Mixin.Events,options:{icon:new o.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var t=this.options,e=this._map,i=e.options.zoomAnimation&&e.options.markerZoomAnimation,n=i?"leaflet-zoom-animated":"leaflet-zoom-hide",r=t.icon.createIcon(this._icon),s=!1;r!==this._icon&&(this._icon&&this._removeIcon(),s=!0,t.title&&(r.title=t.title),t.alt&&(r.alt=t.alt)),o.DomUtil.addClass(r,n),t.keyboard&&(r.tabIndex="0"),this._icon=r,this._initInteraction(),t.riseOnHover&&o.DomEvent.on(r,"mouseover",this._bringToFront,this).on(r,"mouseout",this._resetZIndex,this);var a=t.icon.createShadow(this._shadow),h=!1;a!==this._shadow&&(this._removeShadow(),h=!0),a&&o.DomUtil.addClass(a,n),this._shadow=a,t.opacity<1&&this._updateOpacity();var l=this._map._panes;s&&l.markerPane.appendChild(this._icon),a&&h&&l.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&o.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){o.DomUtil.setPosition(this._icon,t),this._shadow&&o.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];o.DomUtil.addClass(t,"leaflet-clickable"),o.DomEvent.on(t,"click",this._onMouseClick,this),o.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)o.DomEvent.on(t,e[i],this._fireMouseEvent,this);o.Handler.MarkerDrag&&(this.dragging=new o.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&o.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&o.DomEvent.preventDefault(t),"mousedown"!==t.type?o.DomEvent.stopPropagation(t):o.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){o.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&o.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),o.marker=function(t,e){return new o.Marker(t,e)},o.DivIcon=o.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),n=this.options;return n.html!==!1?i.innerHTML=n.html:i.innerHTML="",n.bgPos&&(i.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),o.divIcon=function(t){return new o.DivIcon(t)},o.Map.mergeOptions({closePopupOnClick:!0}),o.Popup=o.Class.extend({includes:o.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){o.setOptions(this,t),this._source=e,this._animated=o.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&o.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&o.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),o.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&o.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",i=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=o.DomUtil.create("div",i);this.options.closeButton&&(t=this._closeButton=o.DomUtil.create("a",e+"-close-button",n),t.href="#close",t.innerHTML="&#215;",o.DomEvent.disableClickPropagation(t),o.DomEvent.on(t,"click",this._onCloseButtonClick,this));var r=this._wrapper=o.DomUtil.create("div",e+"-content-wrapper",n);o.DomEvent.disableClickPropagation(r),this._contentNode=o.DomUtil.create("div",e+"-content",r),o.DomEvent.disableScrollPropagation(this._contentNode),o.DomEvent.on(r,"contextmenu",o.DomEvent.stopPropagation),this._tipContainer=o.DomUtil.create("div",e+"-tip-container",n),this._tip=o.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,r=this.options.maxHeight,s="leaflet-popup-scrolled";r&&n>r?(e.height=r+"px",o.DomUtil.addClass(t,s)):o.DomUtil.removeClass(t,s),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,i=o.point(this.options.offset);e&&o.DomUtil.setPosition(this._container,t),this._containerBottom=-i.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+i.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);o.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new o.Point(this._containerLeft,-e-this._containerBottom);this._animated&&n._add(o.DomUtil.getPosition(this._container));var r=t.layerPointToContainerPoint(n),s=o.point(this.options.autoPanPadding),a=o.point(this.options.autoPanPaddingTopLeft||s),h=o.point(this.options.autoPanPaddingBottomRight||s),l=t.getSize(),u=0,c=0;r.x+i+h.x>l.x&&(u=r.x+i-l.x+h.x),r.x-u-a.x<0&&(u=r.x-a.x),r.y+e+h.y>l.y&&(c=r.y+e-l.y+h.y),r.y-c-a.y<0&&(c=r.y-a.y),(u||c)&&t.fire("autopanstart").panBy([u,c])}},_onCloseButtonClick:function(t){this._close(),o.DomEvent.stop(t)}}),o.popup=function(t,e){return new o.Popup(t,e)},o.Map.include({openPopup:function(t,e,i){if(this.closePopup(),!(t instanceof o.Popup)){var n=t;t=new o.Popup(i).setLatLng(e).setContent(n)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),o.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var i=o.point(this.options.icon.options.popupAnchor||[0,0]);return i=i.add(o.Popup.prototype.options.offset),e&&e.offset&&(i=i.add(e.offset)),e=o.extend({offset:i},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof o.Popup?(o.setOptions(t,e),this._popup=t,t._source=this):this._popup=new o.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),o.LayerGroup=o.Class.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return t?t in this._layers||this.getLayerId(t)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return o.stamp(t)}}),o.layerGroup=function(t){return new o.LayerGroup(t)},o.FeatureGroup=o.LayerGroup.extend({includes:o.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(o.FeatureGroup.EVENTS,this._propagateEvent,this),o.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),"off"in t&&t.off(o.FeatureGroup.EVENTS,this._propagateEvent,this),o.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new o.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof o.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=o.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),o.featureGroup=function(t){return new o.FeatureGroup(t)},o.Path=o.Class.extend({includes:[o.Mixin.Events],statics:{CLIP_PADDING:function(){var e=o.Browser.mobile?1280:2e3,i=(e/Math.max(t.outerWidth,t.outerHeight)-1)/2;return Math.max(0,Math.min(.5,i))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){o.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,o.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return o.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),o.Map.include({_updatePathViewport:function(){var t=o.Path.CLIP_PADDING,e=this.getSize(),i=o.DomUtil.getPosition(this._mapPane),n=i.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),r=n.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new o.Bounds(n,r)}}),o.Path.SVG_NS="http://www.w3.org/2000/svg",o.Browser.svg=!(!e.createElementNS||!e.createElementNS(o.Path.SVG_NS,"svg").createSVGRect),o.Path=o.Path.extend({statics:{SVG:o.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,i=t.firstChild;return e&&i!==e&&t.insertBefore(e,i),this},getPathString:function(){},_createElement:function(t){return e.createElementNS(o.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&o.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(o.Browser.svg||!o.Browser.vml)&&o.DomUtil.addClass(this._path,"leaflet-clickable"),o.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)o.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this._map&&this.hasEventListeners(t.type)){var e=this._map,i=e.mouseEventToContainerPoint(t),n=e.containerPointToLayerPoint(i),r=e.layerPointToLatLng(n);this.fire(t.type,{latlng:r,layerPoint:n,containerPoint:i,originalEvent:t}),"contextmenu"===t.type&&o.DomEvent.preventDefault(t),"mousemove"!==t.type&&o.DomEvent.stopPropagation(t)}}}),o.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=o.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&o.Browser.any3d?(o.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):o.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),i=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(i)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max,n=i.x-e.x,r=i.y-e.y,s=this._pathRoot,a=this._panes.overlayPane;o.Browser.mobileWebkit&&a.removeChild(s),o.DomUtil.setPosition(s,e),s.setAttribute("width",n),s.setAttribute("height",r),s.setAttribute("viewBox",[e.x,e.y,n,r].join(" ")),o.Browser.mobileWebkit&&a.appendChild(s)}}}),o.Path.include({bindPopup:function(t,e){return t instanceof o.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new o.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),o.Browser.vml=!o.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(n){return!1}}(),o.Path=o.Browser.svg||!o.Browser.vml?o.Path:o.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");o.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&o.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,i=this.options,n=this._container;n.stroked=i.stroke,n.filled=i.fill,i.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",n.appendChild(t)),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,i.dashArray?t.dashStyle=o.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):t.dashStyle="",i.lineCap&&(t.endcap=i.lineCap.replace("butt","flat")),i.lineJoin&&(t.joinstyle=i.lineJoin)):t&&(n.removeChild(t),this._stroke=null),i.fill?(e||(e=this._fill=this._createElement("fill"),n.appendChild(e)),e.color=i.fillColor||i.color,e.opacity=i.fillOpacity):e&&(n.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),o.Map.include(o.Browser.svg||!o.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=e.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),o.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),o.Path=o.Path.SVG&&!t.L_PREFER_CANVAS||!o.Browser.canvas?o.Path:o.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return o.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!o.Path._updateRequest&&(o.Path._updateRequest=o.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){o.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color),t.lineCap&&(this._ctx.lineCap=t.lineCap),t.lineJoin&&(this._ctx.lineJoin=t.lineJoin)},_drawPath:function(){var t,e,i,n,r,s;for(this._ctx.beginPath(),t=0,i=this._parts.length;i>t;t++){for(e=0,n=this._parts[t].length;n>e;e++)r=this._parts[t][e],s=(0===e?"move":"line")+"To",this._ctx[s](r.x,r.y);this instanceof o.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill(e.fillRule||"evenodd")),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(t){this._containsPoint(t.layerPoint)&&this.fire(t.type,t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),o.Map.include(o.Path.SVG&&!t.L_PREFER_CANVAS||!o.Browser.canvas?{}:{_initPathRoot:function(){var t,i=this._pathRoot;i||(i=this._pathRoot=e.createElement("canvas"),i.style.position="absolute",t=this._canvasCtx=i.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(i),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",
this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max.subtract(e),n=this._pathRoot;o.DomUtil.setPosition(n,e),n.width=i.x,n.height=i.y,n.getContext("2d").translate(-e.x,-e.y)}}}),o.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var n=t.length,o=typeof Uint8Array!=i+""?Uint8Array:Array,r=new o(n);r[0]=r[n-1]=1,this._simplifyDPStep(t,r,e,0,n-1);var s,a=[];for(s=0;n>s;s++)r[s]&&a.push(t[s]);return a},_simplifyDPStep:function(t,e,i,n,o){var r,s,a,h=0;for(s=n+1;o-1>=s;s++)a=this._sqClosestPointOnSegment(t[s],t[n],t[o],!0),a>h&&(r=s,h=a);h>i&&(e[r]=1,this._simplifyDPStep(t,e,i,n,r),this._simplifyDPStep(t,e,i,r,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,r=t.length;r>n;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return r-1>o&&i.push(t[r-1]),i},clipSegment:function(t,e,i,n){var o,r,s,a=n?this._lastCode:this._getBitCode(t,i),h=this._getBitCode(e,i);for(this._lastCode=h;;){if(!(a|h))return[t,e];if(a&h)return!1;o=a||h,r=this._getEdgeIntersection(t,e,o,i),s=this._getBitCode(r,i),o===a?(t=r,a=s):(e=r,h=s)}},_getEdgeIntersection:function(t,e,i,n){var r=e.x-t.x,s=e.y-t.y,a=n.min,h=n.max;return 8&i?new o.Point(t.x+r*(h.y-t.y)/s,h.y):4&i?new o.Point(t.x+r*(a.y-t.y)/s,a.y):2&i?new o.Point(h.x,t.y+s*(h.x-t.x)/r):1&i?new o.Point(a.x,t.y+s*(a.x-t.x)/r):void 0},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var r,s=e.x,a=e.y,h=i.x-s,l=i.y-a,u=h*h+l*l;return u>0&&(r=((t.x-s)*h+(t.y-a)*l)/u,r>1?(s=i.x,a=i.y):r>0&&(s+=h*r,a+=l*r)),h=t.x-s,l=t.y-a,n?h*h+l*l:new o.Point(s,a)}},o.Polyline=o.Path.extend({initialize:function(t,e){o.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,i="";e>t;t++)i+=this._getPathPartStr(this._parts[t]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(o.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,i,n=1/0,r=this._parts,s=null,a=0,h=r.length;h>a;a++)for(var l=r[a],u=1,c=l.length;c>u;u++){e=l[u-1],i=l[u];var d=o.LineUtil._sqClosestPointOnSegment(t,e,i,!0);n>d&&(n=d,s=o.LineUtil._sqClosestPointOnSegment(t,e,i))}return s&&(s.distance=Math.sqrt(n)),s},getBounds:function(){return new o.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var i,n,r=e?t:[];for(i=0,n=t.length;n>i;i++){if(o.Util.isArray(t[i])&&"number"!=typeof t[i][0])return;r[i]=o.latLng(t[i])}return r},_initEvents:function(){o.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,i=o.Path.VML,n=0,r=t.length,s="";r>n;n++)e=t[n],i&&e._round(),s+=(n?"L":"M")+e.x+" "+e.y;return s},_clipPoints:function(){var t,e,i,n=this._originalPoints,r=n.length;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var s=this._parts,a=this._map._pathViewport,h=o.LineUtil;for(t=0,e=0;r-1>t;t++)i=h.clipSegment(n[t],n[t+1],a,t),i&&(s[e]=s[e]||[],s[e].push(i[0]),(i[1]!==n[t+1]||t===r-2)&&(s[e].push(i[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=o.LineUtil,i=0,n=t.length;n>i;i++)t[i]=e.simplify(t[i],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),o.Path.prototype._updatePath.call(this))}}),o.polyline=function(t,e){return new o.Polyline(t,e)},o.PolyUtil={},o.PolyUtil.clipPolygon=function(t,e){var i,n,r,s,a,h,l,u,c,d=[1,4,2,8],p=o.LineUtil;for(n=0,l=t.length;l>n;n++)t[n]._code=p._getBitCode(t[n],e);for(s=0;4>s;s++){for(u=d[s],i=[],n=0,l=t.length,r=l-1;l>n;r=n++)a=t[n],h=t[r],a._code&u?h._code&u||(c=p._getEdgeIntersection(h,a,u,e),c._code=p._getBitCode(c,e),i.push(c)):(h._code&u&&(c=p._getEdgeIntersection(h,a,u,e),c._code=p._getBitCode(c,e),i.push(c)),i.push(a));t=i}return t},o.Polygon=o.Polyline.extend({options:{fill:!0},initialize:function(t,e){o.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,i,n;if(t&&o.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,i=this._holes.length;i>e;e++)n=this._holes[e]=this._convertLatLngs(this._holes[e]),n[0].equals(n[n.length-1])&&n.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(o.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,i,n;for(t=0,i=this._holes.length;i>t;t++)for(this._holePoints[t]=[],e=0,n=this._holes[t].length;n>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&o.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):o.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var i=0,n=this._parts.length;n>i;i++){var r=o.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);r.length&&e.push(r)}this._parts=e}},_getPathPartStr:function(t){var e=o.Polyline.prototype._getPathPartStr.call(this,t);return e+(o.Browser.svg?"z":"x")}}),o.polygon=function(t,e){return new o.Polygon(t,e)},function(){function t(t){return o.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var i=0,n=e.length;for(this.eachLayer(function(t){n>i?t.setLatLngs(e[i++]):this.removeLayer(t)},this);n>i;)this.addLayer(new t(e[i++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}o.MultiPolyline=t(o.Polyline),o.MultiPolygon=t(o.Polygon),o.multiPolyline=function(t,e){return new o.MultiPolyline(t,e)},o.multiPolygon=function(t,e){return new o.MultiPolygon(t,e)}}(),o.Rectangle=o.Polygon.extend({initialize:function(t,e){o.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=o.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),o.rectangle=function(t,e){return new o.Rectangle(t,e)},o.Circle=o.Path.extend({initialize:function(t,e,i){o.Path.prototype.initialize.call(this,i),this._latlng=o.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=o.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,i=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-i.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,i=this._latlng;return new o.LatLngBounds([i.lat-e,i.lng-t],[i.lat+e,i.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":o.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(o.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,i=this._point;return i.x-e>t.max.x||i.y-e>t.max.y||i.x+e<t.min.x||i.y+e<t.min.y}}),o.circle=function(t,e,i){return new o.Circle(t,e,i)},o.CircleMarker=o.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){o.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){o.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return o.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),o.circleMarker=function(t,e){return new o.CircleMarker(t,e)},o.Polyline.include(o.Path.CANVAS?{_containsPoint:function(t,e){var i,n,r,s,a,h,l,u=this.options.weight/2;for(o.Browser.touch&&(u+=10),i=0,s=this._parts.length;s>i;i++)for(l=this._parts[i],n=0,a=l.length,r=a-1;a>n;r=n++)if((e||0!==n)&&(h=o.LineUtil.pointToSegmentDistance(t,l[r],l[n]),u>=h))return!0;return!1}}:{}),o.Polygon.include(o.Path.CANVAS?{_containsPoint:function(t){var e,i,n,r,s,a,h,l,u=!1;if(o.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(r=0,h=this._parts.length;h>r;r++)for(e=this._parts[r],s=0,l=e.length,a=l-1;l>s;a=s++)i=e[s],n=e[a],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u}}:{}),o.Circle.include(o.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,i=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+i}}:{}),o.CircleMarker.include(o.Path.CANVAS?{_updateStyle:function(){o.Path.prototype._updateStyle.call(this)}}:{}),o.GeoJSON=o.FeatureGroup.extend({initialize:function(t,e){o.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,r=o.Util.isArray(t)?t:t.features;if(r){for(e=0,i=r.length;i>e;e++)n=r[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(r[e]);return this}var s=this.options;if(!s.filter||s.filter(t)){var a=o.GeoJSON.geometryToLayer(t,s.pointToLayer,s.coordsToLatLng,s);return a.feature=o.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),s.onEachFeature&&s.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(o.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),o.extend(o.GeoJSON,{geometryToLayer:function(t,e,i,n){var r,s,a,h,l="Feature"===t.type?t.geometry:t,u=l.coordinates,c=[];switch(i=i||this.coordsToLatLng,l.type){case"Point":return r=i(u),e?e(t,r):new o.Marker(r);case"MultiPoint":for(a=0,h=u.length;h>a;a++)r=i(u[a]),c.push(e?e(t,r):new o.Marker(r));return new o.FeatureGroup(c);case"LineString":return s=this.coordsToLatLngs(u,0,i),new o.Polyline(s,n);case"Polygon":if(2===u.length&&!u[1].length)throw new Error("Invalid GeoJSON object.");return s=this.coordsToLatLngs(u,1,i),new o.Polygon(s,n);case"MultiLineString":return s=this.coordsToLatLngs(u,1,i),new o.MultiPolyline(s,n);case"MultiPolygon":return s=this.coordsToLatLngs(u,2,i),new o.MultiPolygon(s,n);case"GeometryCollection":for(a=0,h=l.geometries.length;h>a;a++)c.push(this.geometryToLayer({geometry:l.geometries[a],type:"Feature",properties:t.properties},e,i,n));return new o.FeatureGroup(c);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new o.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){var n,o,r,s=[];for(o=0,r=t.length;r>o;o++)n=e?this.coordsToLatLngs(t[o],e-1,i):(i||this.coordsToLatLng)(t[o]),s.push(n);return s},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==i&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(o.GeoJSON.latLngToCoords(t[i]));return e},getFeature:function(t,e){return t.feature?o.extend({},t.feature,{geometry:e}):o.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var s={toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"Point",coordinates:o.GeoJSON.latLngToCoords(this.getLatLng())})}};o.Marker.include(s),o.Circle.include(s),o.CircleMarker.include(s),o.Polyline.include({toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"LineString",coordinates:o.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),o.Polygon.include({toGeoJSON:function(){var t,e,i,n=[o.GeoJSON.latLngsToCoords(this.getLatLngs())];if(n[0].push(n[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)i=o.GeoJSON.latLngsToCoords(this._holes[t]),i.push(i[0]),n.push(i);return o.GeoJSON.getFeature(this,{type:"Polygon",coordinates:n})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),o.GeoJSON.getFeature(this,{type:t,coordinates:e})}}o.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),o.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),o.LayerGroup.include({toGeoJSON:function(){var e,i=this.feature&&this.feature.geometry,n=[];if(i&&"MultiPoint"===i.type)return t("MultiPoint").call(this);var r=i&&"GeometryCollection"===i.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),n.push(r?e.geometry:o.GeoJSON.asFeature(e)))}),r?o.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}})}(),o.geoJson=function(t,e){return new o.GeoJSON(t,e)},o.DomEvent={addListener:function(t,e,i,n){var r,s,a,h=o.stamp(i),l="_leaflet_"+e+h;return t[l]?this:(r=function(e){return i.call(n||t,e||o.DomEvent._getEvent())},o.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,r,h):(o.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,r,h),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",r,!1),t.addEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?(s=r,a="mouseenter"===e?"mouseover":"mouseout",r=function(e){return o.DomEvent._checkMouse(t,e)?s(e):void 0},t.addEventListener(a,r,!1)):"click"===e&&o.Browser.android?(s=r,r=function(t){return o.DomEvent._filterClick(t,s)},t.addEventListener(e,r,!1)):t.addEventListener(e,r,!1):"attachEvent"in t&&t.attachEvent("on"+e,r),t[l]=r,this))},removeListener:function(t,e,i){var n=o.stamp(i),r="_leaflet_"+e+n,s=t[r];return s?(o.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,n):o.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",s,!1),t.removeEventListener(e,s,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1):t.removeEventListener(e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[r]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,o.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=o.DomEvent.stopPropagation;return o.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=o.DomEvent.stopPropagation,i=o.Draggable.START.length-1;i>=0;i--)o.DomEvent.on(t,o.Draggable.START[i],e);return o.DomEvent.on(t,"click",o.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return o.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new o.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new o.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){o.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_getEvent:function(){var e=t.event;if(!e)for(var i=arguments.callee.caller;i&&(e=i.arguments[0],!e||t.Event!==e.constructor);)i=i.caller;return e},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=o.DomEvent._lastClick&&i-o.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?void o.DomEvent.stop(t):(o.DomEvent._lastClick=i,e(t))}},o.DomEvent.on=o.DomEvent.addListener,o.DomEvent.off=o.DomEvent.removeListener,o.Draggable=o.Class.extend({includes:o.Mixin.Events,statics:{START:o.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=o.Draggable.START.length-1;t>=0;t--)o.DomEvent.on(this._dragStartTarget,o.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=o.Draggable.START.length-1;t>=0;t--)o.DomEvent.off(this._dragStartTarget,o.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!t.shiftKey&&(1===t.which||1===t.button||t.touches)&&(o.DomEvent.stopPropagation(t),!o.Draggable._disabled&&(o.DomUtil.disableImageDrag(),o.DomUtil.disableTextSelection(),!this._moving))){var i=t.touches?t.touches[0]:t;this._startPoint=new o.Point(i.clientX,i.clientY),this._startPos=this._newPos=o.DomUtil.getPosition(this._element),o.DomEvent.on(e,o.Draggable.MOVE[t.type],this._onMove,this).on(e,o.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var i=t.touches&&1===t.touches.length?t.touches[0]:t,n=new o.Point(i.clientX,i.clientY),r=n.subtract(this._startPoint);(r.x||r.y)&&(o.Browser.touch&&Math.abs(r.x)+Math.abs(r.y)<3||(o.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=o.DomUtil.getPosition(this._element).subtract(r),o.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,o.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(r),this._moving=!0,o.Util.cancelAnimFrame(this._animRequest),this._animRequest=o.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),o.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){o.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(o.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in o.Draggable.MOVE)o.DomEvent.off(e,o.Draggable.MOVE[t],this._onMove).off(e,o.Draggable.END[t],this._onUp);o.DomUtil.enableImageDrag(),o.DomUtil.enableTextSelection(),this._moved&&this._moving&&(o.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),o.Handler=o.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),o.Map.mergeOptions({dragging:!0,inertia:!o.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:o.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),o.Map.Drag=o.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new o.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,s=Math.abs(o+i)<Math.abs(r+i)?o:r;this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=+new Date-this._lastTime,r=!i.inertia||n>i.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),r)e.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+n-this._times[0])/1e3,h=i.easeLinearity,l=s.multiplyBy(h/a),u=l.distanceTo([0,0]),c=Math.min(i.inertiaMaxSpeed,u),d=l.multiplyBy(c/u),p=c/(i.inertiaDeceleration*h),f=d.multiplyBy(-p/2).round();f.x&&f.y?(f=e._limitOffset(f,e.options.maxBounds),o.Util.requestAnimFrame(function(){e.panBy(f,{duration:p,easeLinearity:h,noMoveStart:!0})})):e.fire("moveend")}}}),o.Map.addInitHook("addHandler","dragging",o.Map.Drag),o.Map.mergeOptions({doubleClickZoom:!0}),o.Map.DoubleClickZoom=o.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}}),o.Map.addInitHook("addHandler","doubleClickZoom",o.Map.DoubleClickZoom),o.Map.mergeOptions({scrollWheelZoom:!0}),o.Map.ScrollWheelZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),o.DomEvent.on(this._map._container,"MozMousePixelScroll",o.DomEvent.preventDefault),this._delta=0},removeHooks:function(){o.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),o.DomEvent.off(this._map._container,"MozMousePixelScroll",o.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=o.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o.bind(this._performZoom,this),i),o.DomEvent.preventDefault(t),o.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),o.Map.addInitHook("addHandler","scrollWheelZoom",o.Map.ScrollWheelZoom),o.extend(o.DomEvent,{_touchstart:o.Browser.msPointer?"MSPointerDown":o.Browser.pointer?"pointerdown":"touchstart",_touchend:o.Browser.msPointer?"MSPointerUp":o.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,i,n){function r(t){var e;if(o.Browser.pointer?(f.push(t.pointerId),e=f.length):e=t.touches.length,!(e>1)){var i=Date.now(),n=i-(a||i);h=t.touches?t.touches[0]:t,l=n>0&&u>=n,a=i}}function s(t){if(o.Browser.pointer){var e=f.indexOf(t.pointerId);if(-1===e)return;f.splice(e,1)}if(l){if(o.Browser.pointer){var n,r={};for(var s in h)n=h[s],"function"==typeof n?r[s]=n.bind(h):r[s]=n;h=r}h.type="dblclick",i(h),a=null}}var a,h,l=!1,u=250,c="_leaflet_",d=this._touchstart,p=this._touchend,f=[];t[c+d+n]=r,t[c+p+n]=s;var m=o.Browser.pointer?e.documentElement:t;return t.addEventListener(d,r,!1),m.addEventListener(p,s,!1),o.Browser.pointer&&m.addEventListener(o.DomEvent.POINTER_CANCEL,s,!1),this},removeDoubleTapListener:function(t,i){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+i],!1),(o.Browser.pointer?e.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+i],!1),o.Browser.pointer&&e.documentElement.removeEventListener(o.DomEvent.POINTER_CANCEL,t[n+this._touchend+i],!1),this}}),o.extend(o.DomEvent,{POINTER_DOWN:o.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:o.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:o.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:o.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,i,n){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,i,n);case"touchend":return this.addPointerListenerEnd(t,e,i,n);case"touchmove":return this.addPointerListenerMove(t,e,i,n);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,i,n,r){var s="_leaflet_",a=this._pointers,h=function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&o.DomEvent.preventDefault(t);for(var e=!1,i=0;i<a.length;i++)if(a[i].pointerId===t.pointerId){e=!0;break}e||a.push(t),t.touches=a.slice(),t.changedTouches=[t],n(t)};if(t[s+"touchstart"+r]=h,t.addEventListener(this.POINTER_DOWN,h,!1),!this._pointerDocumentListener){var l=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}};e.documentElement.addEventListener(this.POINTER_UP,l,!1),e.documentElement.addEventListener(this.POINTER_CANCEL,l,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,i,n){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s[e]=t;break}t.touches=s.slice(),t.changedTouches=[t],i(t)}}var r="_leaflet_",s=this._pointers;return t[r+"touchmove"+n]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,i,n){var o="_leaflet_",r=this._pointers,s=function(t){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r.splice(e,1);break}t.touches=r.slice(),t.changedTouches=[t],i(t)};return t[o+"touchend"+n]=s,t.addEventListener(this.POINTER_UP,s,!1),t.addEventListener(this.POINTER_CANCEL,s,!1),this},removePointerListener:function(t,e,i){var n="_leaflet_",o=t[n+e+i];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,o,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,o,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,o,!1),t.removeEventListener(this.POINTER_CANCEL,o,!1)}return this}}),o.Map.mergeOptions({touchZoom:o.Browser.touch&&!o.Browser.android23,bounceAtZoomLimits:!0}),o.Map.TouchZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToLayerPoint(t.touches[0]),r=i.mouseEventToLayerPoint(t.touches[1]),s=i._getCenterLayerPoint();this._startCenter=n.add(r)._divideBy(2),this._startDist=n.distanceTo(r),this._moved=!1,this._zooming=!0,this._centerOffset=s.subtract(this._startCenter),i._panAnim&&i._panAnim.stop(),o.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),o.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(o.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),o.Util.cancelAnimFrame(this._animRequest),this._animRequest=o.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),o.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),n=t.getScaleZoom(this._scale);t._animateZoom(i,n,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,o.DomUtil.removeClass(t._mapPane,"leaflet-touching"),o.Util.cancelAnimFrame(this._animRequest),o.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd);var i=this._getScaleOrigin(),n=t.layerPointToLatLng(i),r=t.getZoom(),s=t.getScaleZoom(this._scale)-r,a=s>0?Math.ceil(s):Math.floor(s),h=t._limitZoom(r+a),l=t.getZoomScale(h)/this._scale;t._animateZoom(n,h,i,l)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),o.Map.addInitHook("addHandler","touchZoom",o.Map.TouchZoom),o.Map.mergeOptions({tap:!0,tapTolerance:15}),o.Map.Tap=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(o.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new o.Point(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(o.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),o.DomEvent.on(e,"touchmove",this._onMove,this).on(e,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),o.DomEvent.off(e,"touchmove",this._onMove,this).off(e,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],n=i.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new o.Point(e.clientX,e.clientY)},_simulateEvent:function(i,n){var o=e.createEvent("MouseEvents");o._simulated=!0,n.target._simulatedClick=!0,o.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(o)}}),o.Browser.touch&&!o.Browser.pointer&&o.Map.addInitHook("addHandler","tap",o.Map.Tap),o.Map.mergeOptions({boxZoom:!0}),o.Map.BoxZoom=o.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){o.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){o.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved;
},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(o.DomUtil.disableTextSelection(),o.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void o.DomEvent.on(e,"mousemove",this._onMouseMove,this).on(e,"mouseup",this._onMouseUp,this).on(e,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=o.DomUtil.create("div","leaflet-zoom-box",this._pane),o.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,i=this._box,n=this._map.mouseEventToLayerPoint(t),r=n.subtract(e),s=new o.Point(Math.min(n.x,e.x),Math.min(n.y,e.y));o.DomUtil.setPosition(i,s),this._moved=!0,i.style.width=Math.max(0,Math.abs(r.x)-4)+"px",i.style.height=Math.max(0,Math.abs(r.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),o.DomUtil.enableTextSelection(),o.DomUtil.enableImageDrag(),o.DomEvent.off(e,"mousemove",this._onMouseMove).off(e,"mouseup",this._onMouseUp).off(e,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,i=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(i)){var n=new o.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(i));e.fitBounds(n),e.fire("boxzoomend",{boxZoomBounds:n})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),o.Map.addInitHook("addHandler","boxZoom",o.Map.BoxZoom),o.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),o.Map.Keyboard=o.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),o.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;o.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,o=i.scrollTop||n.scrollTop,r=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(r,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;i>e;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;i>e;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;i>e;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;i>e;e++)n[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;i>e;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;i>e;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){o.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){o.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,i=this._map;if(e in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[e]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(e in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[e])}o.DomEvent.stop(t)}}),o.Map.addInitHook("addHandler","keyboard",o.Map.Keyboard),o.Handler.MarkerDrag=o.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new o.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),o.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),o.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,i=o.DomUtil.getPosition(t._icon),n=t._map.layerPointToLatLng(i);e&&o.DomUtil.setPosition(e,i),t._latlng=n,t.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),o.Control=o.Class.extend({options:{position:"topright"},initialize:function(t){o.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return o.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),i=t._controlCorners[e];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),o.control=function(t){return new o.Control(t)},o.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,r){var s=i+t+" "+i+r;e[t+r]=o.DomUtil.create("div",s,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=o.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),o.Control.Zoom=o.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=o.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",i,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",i,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,r,s){var a=o.DomUtil.create("a",i,n);a.innerHTML=t,a.href="#",a.title=e;var h=o.DomEvent.stopPropagation;return o.DomEvent.on(a,"click",h).on(a,"mousedown",h).on(a,"dblclick",h).on(a,"click",o.DomEvent.preventDefault).on(a,"click",r,s).on(a,"click",this._refocusOnMap,s),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";o.DomUtil.removeClass(this._zoomInButton,e),o.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&o.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&o.DomUtil.addClass(this._zoomInButton,e)}}),o.Map.mergeOptions({zoomControl:!0}),o.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new o.Control.Zoom,this.addControl(this.zoomControl))}),o.control.zoom=function(t){return new o.Control.Zoom(t)},o.Control.Attribution=o.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){o.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=o.DomUtil.create("div","leaflet-control-attribution"),o.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),o.Map.mergeOptions({attributionControl:!0}),o.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new o.Control.Attribution).addTo(this))}),o.control.attribution=function(t){return new o.Control.Attribution(t)},o.Control.Scale=o.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",i=o.DomUtil.create("div",e),n=this.options;return this._addScales(n,e,i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=o.DomUtil.create("div",e+"-line",i)),t.imperial&&(this._iScale=o.DomUtil.create("div",e+"-line",i))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,i=6378137*Math.PI*Math.cos(e*Math.PI/180),n=i*(t.getNorthEast().lng-t.getSouthWest().lng)/180,o=this._map.getSize(),r=this.options,s=0;o.x>0&&(s=n*(r.maxWidth/o.x)),this._updateScales(r,s)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,i,n,o=3.2808399*t,r=this._iScale;o>5280?(e=o/5280,i=this._getRoundNum(e),r.style.width=this._getScaleWidth(i/e)+"px",r.innerHTML=i+" mi"):(n=this._getRoundNum(o),r.style.width=this._getScaleWidth(n/o)+"px",r.innerHTML=n+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),o.control.scale=function(t){return new o.Control.Scale(t)},o.Control.Layers=o.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,i){o.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=o.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=o.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),o.Browser.touch?o.DomEvent.on(e,"click",o.DomEvent.stopPropagation):o.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var i=this._form=o.DomUtil.create("form",t+"-list");if(this.options.collapsed){o.Browser.android||o.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var n=this._layersLink=o.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",o.Browser.touch?o.DomEvent.on(n,"click",o.DomEvent.stop).on(n,"click",this._expand,this):o.DomEvent.on(n,"focus",this._expand,this),o.DomEvent.on(i,"click",function(){setTimeout(o.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=o.DomUtil.create("div",t+"-base",i),this._separator=o.DomUtil.create("div",t+"-separator",i),this._overlaysList=o.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){var n=o.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,i=!1,n=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),n=n||e.overlay,i=i||!e.overlay;this._separator.style.display=n&&i?"":"none"}},_onLayerChange:function(t){var e=this._layers[o.stamp(t.layer)];if(e){this._handlingClick||this._update();var i=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)}},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';i&&(n+=' checked="checked"'),n+="/>";var o=e.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var i,n=e.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?(i=e.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=r):i=this._createRadioElement("leaflet-base-layers",r),i.layerId=o.stamp(t.layer),o.DomEvent.on(i,"click",this._onInputClick,this);var s=e.createElement("span");s.innerHTML=" "+t.name,n.appendChild(i),n.appendChild(s);var a=t.overlay?this._overlaysList:this._baseLayersList;return a.appendChild(n),n},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=n.length;for(this._handlingClick=!0,t=0;o>t;t++)e=n[t],i=this._layers[e.layerId],e.checked&&!this._map.hasLayer(i.layer)?this._map.addLayer(i.layer):!e.checked&&this._map.hasLayer(i.layer)&&this._map.removeLayer(i.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){o.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),o.control.layers=function(t,e,i){return new o.Control.Layers(t,e,i)},o.PosAnimation=o.Class.extend({includes:o.Mixin.Events,run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[o.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",o.DomEvent.on(t,o.DomUtil.TRANSITION_END,this._onTransitionEnd,this),o.DomUtil.setPosition(t,e),o.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(o.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(o.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),o.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,i,n,r=this._el,s=t.getComputedStyle(r);if(o.Browser.any3d){if(n=s[o.DomUtil.TRANSFORM].match(this._transformRe),!n)return;e=parseFloat(n[1]),i=parseFloat(n[2])}else e=parseFloat(s.left),i=parseFloat(s.top);return new o.Point(e,i,!0)},_onTransitionEnd:function(){o.DomEvent.off(this._el,o.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[o.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),o.Map.include({setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(o.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=o.extend({animate:n.animate},n.zoom),n.pan=o.extend({animate:n.animate},n.pan));var r=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(r)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=o.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new o.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){o.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){o.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(i)?(this.panBy(i,e),!0):!1}}),o.PosAnimation=o.DomUtil.TRANSITION?o.PosAnimation:o.PosAnimation.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=o.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=o.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));o.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){o.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),o.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),o.DomUtil.TRANSITION&&o.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&o.DomUtil.TRANSITION&&o.Browser.any3d&&!o.Browser.android23&&!o.Browser.mobileOpera,this._zoomAnimated&&o.DomEvent.on(this._mapPane,o.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),o.Map.include(o.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n),r=this._getCenterLayerPoint()._add(o);return i.animate===!0||this.getSize().contains(o)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,r,n,null,!0),!0):!1},_animateZoom:function(t,e,i,n,r,s,a){a||(this._animatingZoom=!0),o.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,o.Draggable&&(o.Draggable._disabled=!0),o.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:i,scale:n,delta:r,backwards:s}),setTimeout(o.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,o.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),o.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),o.Draggable&&(o.Draggable._disabled=!1)},this))}}:{}),o.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,i=o.DomUtil.TRANSFORM,n=t.delta?o.DomUtil.getTranslateString(t.delta):e.style[i],r=o.DomUtil.getScaleString(t.scale,t.origin);e.style[i]=t.backwards?r+" "+n:n+" "+r},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),o.Util.falseFn(e.offsetWidth);var i=this._map.getZoom();(i>this.options.maxZoom||i<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[o.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,i=this._getLoadedTilesPercentage(e),n=this._getLoadedTilesPercentage(t);return e&&i>.5&&.5>n?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[o.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,i,n=t.getElementsByTagName("img"),o=0;for(e=0,i=n.length;i>e;e++)n[e].complete&&o++;return o/i},_stopLoadingImages:function(t){var e,i,n,r=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,i=r.length;i>e;e++)n=r[e],n.complete||(n.onload=o.Util.falseFn,n.onerror=o.Util.falseFn,n.src=o.Util.emptyImageUrl,n.parentNode.removeChild(n))}}),o.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=o.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o.bind(this._handleGeolocationResponse,this),i=o.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new o.LatLng(e,i),r=180*t.coords.accuracy/40075017,s=r/Math.cos(o.LatLng.DEG_TO_RAD*e),a=o.latLngBounds([e-r,i-s],[e+r,i+s]),h=this._locateOptions;if(h.setView){var l=Math.min(this.getBoundsZoom(a),h.maxZoom);this.setView(n,l)}var u={latlng:n,bounds:a,timestamp:t.timestamp};for(var c in t.coords)"number"==typeof t.coords[c]&&(u[c]=t.coords[c]);this.fire("locationfound",u)}})}(window,document),!function(t,e,i){L.drawVersion="0.3.0-dev",L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}},L.Draw={},L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire("draw:drawstart",{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire("draw:drawstop",{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire("draw:created",{layer:t,layerType:this.type})},_cancelDrawing:function(t){this._map.fire("draw:canceled",{layerType:this.type}),27===t.keyCode&&this.disable()}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,showLength:!0,zIndexOffset:2e3},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),L.Browser.touch||this._map.on("mouseup",this._onMouseUp,this),this._mouseMarker.on("mousedown",this._onMouseDown,this).on("mouseout",this._onMouseOut,this).on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("click",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,i=this._poly.spliceLatLngs(e.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(i,!1)}},addVertex:function(t){var e=this._markers.length;return e>0&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?void this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),void this._vertexChanged(t,!0))},completeShape:function(){this._markers.length<=1||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly.newLatLngIntersects(this._poly.getLatLngs()[this._poly.getLatLngs().length-1]);return!this.options.allowIntersection&&t||!this._shapeIsValid()?void this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),void(this.options.repeatMode&&this.enable()))},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),i=this._map.layerPointToLatLng(e);this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire("draw:drawvertex",{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){var e=t.originalEvent;this._mouseDownOrigin=L.point(e.clientX,e.clientY)},_onMouseUp:function(e){if(this._mouseDownOrigin){var i=L.point(e.originalEvent.clientX,e.originalEvent.clientY).distanceTo(this._mouseDownOrigin);Math.abs(i)<9*(t.devicePixelRatio||1)&&this.addVertex(e.latlng)}this._mouseDownOrigin=null},_onTouch:function(t){L.Browser.touch&&(this._onMouseDown(t),this._onMouseUp(t))},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,n,o,r=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),s=this.options.guidelineDistance,a=this.options.maxGuideLineLength,h=r>a?r-a:s;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));r>h;h+=this.options.guidelineDistance)i=h/r,n={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},o=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),o.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(o,n)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;i>e;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild);
},_getTooltipText:function(){var t,e,i=this.options.showLength;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=i?this._getMeasurementString():"",t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var i,n,o=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(i=o-(e?2:1),n=t.distanceTo(this._markers[i].getLatLng()),this._measurementRunningTotal+=n*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=this._measurementRunningTotal+e.distanceTo(i),L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),t>2&&(this._markers[t-1].on("dblclick",this._finishShape,this),t>3&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?t=L.drawLocal.draw.handlers.polygon.tooltip.cont:(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area;return t?L.GeometryUtil.readableArea(t,this.options.metric):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(t,e){var i;!this.options.allowIntersection&&this.options.showArea&&(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off("click",this._finishShape,this),t>2&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,i,n=L.Draw.SimpleShape.prototype._getTooltipText.call(this),o=this._shape;return o&&(t=this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),i=L.GeometryUtil.readableArea(e,this.options.metric)),{text:n.text,subtext:i}}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(t)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,n=this.options.showRadius,o=this.options.metric;this._tooltip.updatePosition(i),this._isDrawing&&(this._drawShape(i),e=this._shape.getRadius().toFixed(1),this._tooltip.updateContent({text:this._endLabelText,subtext:n?L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(e,o,this.options.feet):""}))}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire("draw:editmove",{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display="none",L.DomUtil.hasClass(t,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,4)),t.style.display="")},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,n=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+"px",t.style.marginLeft=n+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({options:{},initialize:function(t,e){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,L.setOptions(this,e),this._poly.on("revert-edited",this._updateLatLngs,this)},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this.options))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(t,e,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this._latlngs=e,L.setOptions(this,i)},addHooks:function(){var t=this._poly;t instanceof L.Polygon||(t.options.fill=!1),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly;t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,n,o=this._latlngs;for(t=0,i=o.length;i>t;t++)n=this._createMarker(o[t],t),n.on("click",this._onMarkerClick,this),this._markers.push(n);var r,s;for(t=0,e=i-1;i>t;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(r=this._markers[e],s=this._markers[t],this._createMiddleMarker(r,s),this._updatePrevNext(r,s))},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(i),i},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._poly._convertLatLngs(this._latlngs,!0),this._poly.redraw(),t},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire("draw:editvertex",{layers:this._markerGroup})},_onMarkerDrag:function(t){var e=t.target,i=this._poly;if(L.extend(e._origLatLng,e._latlng),e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),i.options.poly){var n=i._map._editTooltip;if(!i.options.poly.allowIntersection&&i.intersects()){var o=i.options.color;i.setStyle({color:this.options.drawError.color}),n&&n.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){i.setStyle({color:o}),n&&n.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3),this._onMarkerClick(t)}}this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._latlngs.length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),n=t.target;L.extend(n._origLatLng,i),n._middleLeft&&n._middleLeft.setLatLng(this._getMiddleLatLng(n._prev,n)),n._middleRight&&n._middleRight.setLatLng(this._getMiddleLatLng(n,n._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(i){i._index>t&&(i._index+=e)})},_createMiddleMarker:function(t,e){var i,n,o,r=this._getMiddleLatLng(t,e),s=this._createMarker(r);s.setOpacity(.6),t._middleRight=e._middleLeft=s,n=function(){s.off("touchmove",n,this);var o=e._index;s._index=o,s.off("click",i,this).on("click",this._onMarkerClick,this),r.lat=s.getLatLng().lat,r.lng=s.getLatLng().lng,this._spliceLatLngs(o,0,r),this._markers.splice(o,0,s),s.setOpacity(1),this._updateIndexes(o,1),e._index++,this._updatePrevNext(t,s),this._updatePrevNext(s,e),this._poly.fire("editstart")},o=function(){s.off("dragstart",n,this),s.off("dragend",o,this),s.off("touchmove",n,this),this._createMiddleMarker(t,s),this._createMiddleMarker(s,e)},i=function(){n.call(this),o.call(this),this._fireEdit()},s.on("click",i,this).on("dragstart",n,this).on("dragend",o,this).on("touchmove",n,this),this._markerGroup.addLayer(s)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,n=i.project(t.getLatLng()),o=i.project(e.getLatLng());return i.unproject(n._add(o)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this,this.options.poly),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,i=this._resizeMarkers.length;i>e;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(t){var e=t.target;e.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(t){var e=t.target;e.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),"function"==typeof this._getCorners){var e=this._getCorners(),i=t.target,n=i._cornerIndex;i.setOpacity(0),this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)}this._shape.fire("editstart")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),n=t.target;return n===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),!1},_onTouchEnd:function(t){var e=t.target;e.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds(),e=t.getCenter();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;i>e;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target,n=i._cornerIndex;this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)},_onMarkerDragEnd:function(t){var e,i,n=t.target;n===this._moveMarker&&(e=this._shape.getBounds(),i=e.getCenter(),n.setLatLng(i)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape.getLatLngs(),n=this._shape.getBounds(),o=n.getCenter(),r=[],s=0,a=i.length;a>s;s++)e=[i[s].lat-o.lat,i[s].lng-o.lng],r.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(r),this._repositionCornerMarkers(),this._map.fire("draw:editmove",{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire("draw:editresize",{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds(),e=t.getNorthWest(),i=t.getNorthEast(),n=t.getSouthEast(),o=t.getSouthWest();return[e,i,n,o]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;i>e;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;i>e;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_move:function(t){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e),this._shape.setLatLng(t),this._map.fire("draw:editmove",{layer:this._shape})},_resize:function(t){var e=this._moveMarker.getLatLng(),i=e.distanceTo(t);this._shape.setRadius(i),this._map.fire("draw:editresize",{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart),L.DomEvent.off(this._container,"touchend",this._onTouchEnd),L.DomEvent.off(this._container,"touchmove",this._onTouchMove),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDowm",this._onTouchStart),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave))},_touchEvent:function(t,e){var i={};if("undefined"!=typeof t.touches){if(!t.touches.length)return;i=t.touches[0]}else{if("touch"!==t.pointerType)return;if(i=t,!this._filterClick(t))return}var n=this._map.mouseEventToContainerPoint(i),o=this._map.mouseEventToLayerPoint(i),r=this._map.layerPointToLatLng(o);this._map.fire(e,{latlng:r,layerPoint:o,containerPoint:n,pageX:i.pageX,pageY:i.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,i=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return i&&i>100&&500>i||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){if(this._map._loaded){var e="touchstart";this._touchEvent(t,e)}},_onTouchEnd:function(t){if(this._map._loaded){var e="touchend";this._touchEvent(t,e)}},_onTouchCancel:function(t){if(this._map._loaded){var e="touchcancel";this._detectIE()&&(e="pointercancel"),this._touchEvent(t,e)}},_onTouchLeave:function(t){if(this._map._loaded){var e="touchleave";this._touchEvent(t,e)}},_onTouchMove:function(t){if(this._map._loaded){var e="touchmove";this._touchEvent(t,e)}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);var n=e.indexOf("Trident/");if(n>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var r=e.indexOf("Edge/");return r>0?parseInt(e.substring(r+5,e.indexOf(".",r)),10):!1}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?e.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):e.concat(["touchcancel"]),L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this),L.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)L.DomEvent.on(t,e[i],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);var n=e.indexOf("Trident/");if(n>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var r=e.indexOf("Edge/");return r>0?parseInt(e.substring(r+5,e.indexOf(".",r)),10):!1}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,i,n=t.length,o=0,r=L.LatLng.DEG_TO_RAD;if(n>2){for(var s=0;n>s;s++)e=t[s],i=t[(s+1)%n],o+=(i.lng-e.lng)*r*(2+Math.sin(e.lat*r)+Math.sin(i.lat*r));o=6378137*o*6378137/2}return Math.abs(o)},readableArea:function(t,e){var i;return e?i=t>=1e4?(1e-4*t).toFixed(2)+" ha":t.toFixed(2)+" m&sup2;":(t/=.836127,i=t>=3097600?(t/3097600).toFixed(2)+" mi&sup2;":t>=4840?(t/4840).toFixed(2)+" acres":Math.ceil(t)+" yd&sup2;"),i},readableDistance:function(t,e,i){var n;if(e)n=t>1e3?(t/1e3).toFixed(2)+" km":Math.ceil(t)+" m";else if(t*=1.09361,t>1760)n=(t/1760).toFixed(2)+" miles";else{var o=" yd";i&&(t=3*t,o=" ft"),n=Math.ceil(t)+o}return n}}),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,n){return this._checkCounterclockwise(t,i,n)!==this._checkCounterclockwise(e,i,n)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,n)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,i,n=this._originalPoints,o=n?n.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=o-1;t>=3;t--)if(e=n[t-1],i=n[t],this._lineSegmentsIntersectsRange(e,i,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(t),e):!1},newPointIntersects:function(t,e){var i=this._originalPoints,n=i?i.length:0,o=i?i[n-1]:null,r=n-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(o,t,r,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._originalPoints,i=e?e.length:0;return i+=t||0,!this._originalPoints||3>=i},_lineSegmentsIntersectsRange:function(t,e,i,n){var o,r,s=this._originalPoints;n=n||0;for(var a=i;a>n;a--)if(o=s[a-1],r=s[a],L.LineUtil.segmentsIntersect(t,e,o,r))return!0;return!1}}),L.Polygon.include({intersects:function(){var t,e,i,n,o,r=this._originalPoints;return this._tooFewPointsForIntersection()?!1:(t=L.Polyline.prototype.intersects.call(this))?!0:(e=r.length,i=r[0],n=r[e-1],o=e-2,this._lineSegmentsIntersectsRange(n,i,o,1))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,t);var e;this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,i=L.DomUtil.create("div","leaflet-draw"),n=!1,o="leaflet-draw-toolbar-top";for(var r in this._toolbars)this._toolbars.hasOwnProperty(r)&&(e=this._toolbars[r].addToolbar(t),e&&(n||(L.DomUtil.hasClass(e,o)||L.DomUtil.addClass(e.childNodes[0],o),n=!0),i.appendChild(e)));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var i in this._toolbars)this._toolbars[i]!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create("div","leaflet-draw-section"),n=0,o=this._toolbarClass||"",r=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<r.length;e++)r[e].enabled&&this._initModeHandler(r[e].handler,this._toolbarContainer,n++,o,r[e].title);return n?(this._lastButtonIndex=--n,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),
i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i):void 0},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;i>e;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,n,o){var r=t.type;this._modes[r]={},this._modes[r].handler=t,this._modes[r].button=this._createButton({type:r,title:o,className:n+"-"+r,container:e,callback:this._modes[r].handler.enable,context:this._modes[r].handler}),this._modes[r].buttonIndex=i,this._modes[r].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container);return e.href="#",t.text&&(e.innerHTML=t.text),t.title&&(e.title=t.title),L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,"click",t.callback,t.context),e},_disposeButton:function(t,e){L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,"click",e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,i,n,o,r=this._actionsContainer,s=this.getActions(t),a=s.length;for(i=0,n=this._actionButtons.length;n>i;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];r.firstChild;)r.removeChild(r.firstChild);for(var h=0;a>h;h++)"enabled"in s[h]&&!s[h].enabled||(e=L.DomUtil.create("li","",r),o=this._createButton({title:s[h].title,text:s[h].text,container:e,callback:s[h].callback,context:s[h].context}),this._actionButtons.push({button:o,callback:s[h].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}}),L.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(i.style.visibility="inherit",L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){L.setOptions(this,t);for(var e in this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&("undefined"==typeof t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=this.options.featureGroup,i=0!==e.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,i?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,i?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:editstart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:editstop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on("click",this._editStyle,this).on("draw:editvertex",this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off("click",this._editStyle,this).off("draw:editvertex",this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer(function(e){e.edited&&(t.addLayer(e),e.edited=!1)}),this._map.fire("draw:edited",{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:t instanceof L.Marker&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):t instanceof L.Marker&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire("revert-edited",{layer:t}))},_enableLayerEdit:function(t){var e,i,n=t.layer||t.target||t;this._backupLayer(n),this.options.poly&&(i=L.Util.extend({},this.options.poly),n.options.poly=i),this.options.selectedPathOptions&&(e=L.Util.extend({},this.options.selectedPathOptions),e.maintainColor&&(e.color=n.options.color,e.fillColor=n.options.fillColor),n.options.original=L.extend({},n.options),n.options.editing=e),this.isMarker?(n.dragging.enable(),n.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):n.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing.disable(),delete e.options.editing,delete e.options.original,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],i=this._map.mouseEventToLayerPoint(e),n=this._map.layerPointToLatLng(i);t.target.setLatLng(n)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:deletestart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:deletestop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t),t.fire("revert-deleted",{layer:t})},this)},save:function(){this._map.fire("draw:deleted",{layers:this._deletedLayers})},_enableLayerDelete:function(t){var e=t.layer||t.target||t;e.on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire("deleted")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document),function(t,e){"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports&&(module.exports=t(require("leaflet"))),"undefined"!=typeof e&&e.L&&(e.L.Control.MiniMap=t(L),e.L.control.minimap=function(t,i){return new e.L.Control.MiniMap(t,i)})}(function(t){var e=t.Control.extend({options:{position:"bottomright",toggleDisplay:!1,zoomLevelOffset:-5,zoomLevelFixed:!1,zoomAnimation:!1,autoToggleDisplay:!1,width:150,height:150,collapsedWidth:19,collapsedHeight:19,aimingRectOptions:{color:"#ff7800",weight:1,clickable:!1},shadowRectOptions:{color:"#000000",weight:1,clickable:!1,opacity:0,fillOpacity:0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"}},initialize:function(e,i){t.Util.setOptions(this,i),this.options.aimingRectOptions.clickable=!1,this.options.shadowRectOptions.clickable=!1,this._layer=e},onAdd:function(e){return this._mainMap=e,this._container=t.DomUtil.create("div","leaflet-control-minimap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",t.DomEvent.disableClickPropagation(this._container),t.DomEvent.on(this._container,"mousewheel",t.DomEvent.stopPropagation),this._miniMap=new t.Map(this._container,{attributionControl:!1,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:!this._isZoomLevelFixed(),scrollWheelZoom:!this._isZoomLevelFixed(),doubleClickZoom:!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed(),crs:e.options.crs}),this._miniMap.addLayer(this._layer),this._mainMapMoving=!1,this._miniMapMoving=!1,this._userToggledDisplay=!1,this._minimized=!1,this.options.toggleDisplay&&this._addToggleButton(),this._miniMap.whenReady(t.Util.bind(function(){this._aimingRect=t.rectangle(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._miniMap),this._shadowRect=t.rectangle(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._miniMap),this._mainMap.on("moveend",this._onMainMapMoved,this),this._mainMap.on("move",this._onMainMapMoving,this),this._miniMap.on("movestart",this._onMiniMapMoveStarted,this),this._miniMap.on("move",this._onMiniMapMoving,this),this._miniMap.on("moveend",this._onMiniMapMoved,this)},this)),this._container},addTo:function(e){return t.Control.prototype.addTo.call(this,e),this._miniMap.setView(this._mainMap.getCenter(),this._decideZoom(!0)),this._setDisplay(this._decideMinimized()),this},onRemove:function(t){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this),this._miniMap.off("moveend",this._onMiniMapMoved,this),this._miniMap.removeLayer(this._layer)},changeLayer:function(t){this._miniMap.removeLayer(this._layer),this._layer=t,this._miniMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?this._createButton("",this.options.strings.hideText,"leaflet-control-minimap-toggle-display leaflet-control-minimap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0,this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px",this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_createButton:function(e,i,n,o,r,s){var a=t.DomUtil.create("a",n,o);a.innerHTML=e,a.href="#",a.title=i;var h=t.DomEvent.stopPropagation;return t.DomEvent.on(a,"click",h).on(a,"mousedown",h).on(a,"dblclick",h).on(a,"click",t.DomEvent.preventDefault).on(a,"click",r,s),a},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0,this._minimized?(this._restore(),this._toggleDisplayButton.title=this.options.strings.hideText):(this._minimize(),this._toggleDisplayButton.title=this.options.strings.showText)},_setDisplay:function(t){t!=this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+"px",this._container.style.height=this.options.collapsedHeight+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position):this._container.style.display="none",this._minimized=!0},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,"")):this._container.style.display="block",this._minimized=!1},_onMainMapMoved:function(t){this._miniMapMoving?this._miniMapMoving=!1:(this._mainMapMoving=!0,this._miniMap.setView(this._mainMap.getCenter(),this._decideZoom(!0)),this._setDisplay(this._decideMinimized())),this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(t){this._aimingRect.setBounds(this._mainMap.getBounds())},_onMiniMapMoveStarted:function(t){var e=this._aimingRect.getBounds(),i=this._miniMap.latLngToContainerPoint(e.getSouthWest()),n=this._miniMap.latLngToContainerPoint(e.getNorthEast());this._lastAimingRectPosition={sw:i,ne:n}},_onMiniMapMoving:function(e){!this._mainMapMoving&&this._lastAimingRectPosition&&(this._shadowRect.setBounds(new t.LatLngBounds(this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,fillOpacity:.3}))},_onMiniMapMoved:function(t){this._mainMapMoving?this._mainMapMoving=!1:(this._miniMapMoving=!0,this._mainMap.setView(this._miniMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){var t=this.options.zoomLevelFixed;return this._isDefined(t)&&this._isInteger(t)},_decideZoom:function(t){if(this._isZoomLevelFixed())return t?this.options.zoomLevelFixed:this._mainMap.getZoom();if(t)return this._mainMap.getZoom()+this.options.zoomLevelOffset;var e,i=this._miniMap.getZoom()-this._mainMap.getZoom(),n=this._miniMap.getZoom()-this.options.zoomLevelOffset;return i>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._miniMap.getMinZoom()-this.options.zoomLevelOffset?this._miniMap.getZoom()>this._lastMiniMapZoom?(e=this._mainMap.getZoom()+1,this._miniMap.setZoom(this._miniMap.getZoom()-1)):e=this._mainMap.getZoom():e=n,this._lastMiniMapZoom=this._miniMap.getZoom(),e},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:this.options.autoToggleDisplay?this._mainMap.getBounds().contains(this._miniMap.getBounds())?!0:!1:this._minimized},_isInteger:function(t){return"number"==typeof t},_isDefined:function(t){return"undefined"!=typeof t}});return t.Map.mergeOptions({miniMapControl:!1}),t.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=(new e).addTo(this))}),e},window),function(t,e,i){"use strict";function n(t,e,i){var n,o=t.runtimeStyle&&t.runtimeStyle[e],r=t.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(i)&&/^-?\d/.test(i)&&(n=r.left,o&&(t.runtimeStyle.left=t.currentStyle.left),r.left="fontSize"===e?"1em":i||0,i=r.pixelLeft+"px",r.left=n,o&&(t.runtimeStyle.left=o)),/^(thin|medium|thick)$/i.test(i)?i:Math.round(parseFloat(i))+"px"}function o(t){return parseInt(t,10)}function r(t,e,o,r){if(t=(t||"").split(","),t=t[r||0]||t[0]||"auto",t=c.Util.trimText(t).split(" "),"backgroundSize"!==o||t[0]&&!t[0].match(/cover|contain|auto/)){if(t[0]=-1===t[0].indexOf("%")?n(e,o+"X",t[0]):t[0],t[1]===i){if("backgroundSize"===o)return t[1]="auto",t;t[1]=t[0]}t[1]=-1===t[1].indexOf("%")?n(e,o+"Y",t[1]):t[1]}else;return t}function s(t,e,i,n,o,r){var s,a,h,l,u=c.Util.getCSS(e,t,o);if(1===u.length&&(l=u[0],u=[],u[0]=l,u[1]=l),-1!==u[0].toString().indexOf("%"))h=parseFloat(u[0])/100,a=i.width*h,"backgroundSize"!==t&&(a-=(r||n).width*h);else if("backgroundSize"===t)if("auto"===u[0])a=n.width;else if(/contain|cover/.test(u[0])){var d=c.Util.resizeBounds(n.width,n.height,i.width,i.height,u[0]);a=d.width,s=d.height}else a=parseInt(u[0],10);else a=parseInt(u[0],10);return"auto"===u[1]?s=a/n.width*n.height:-1!==u[1].toString().indexOf("%")?(h=parseFloat(u[1])/100,s=i.height*h,"backgroundSize"!==t&&(s-=(r||n).height*h)):s=parseInt(u[1],10),[a,s]}function a(t,e){var i=[];return{storage:i,width:t,height:e,clip:function(){i.push({type:"function",name:"clip",arguments:arguments})},translate:function(){i.push({type:"function",name:"translate",arguments:arguments})},fill:function(){i.push({type:"function",name:"fill",arguments:arguments})},save:function(){i.push({type:"function",name:"save",arguments:arguments})},restore:function(){i.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){i.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){i.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var t=[];return i.push({type:"function",name:"drawShape",arguments:t}),{moveTo:function(){t.push({name:"moveTo",arguments:arguments})},lineTo:function(){t.push({name:"lineTo",arguments:arguments})},arcTo:function(){t.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){t.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){t.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){i.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){i.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(t,e){return i.push({type:"variable",name:t,arguments:e}),e}}}function h(t){return{zindex:t,children:[]}}var l,u,c={};c.Util={},c.Util.log=function(e){c.logging&&t.console&&t.console.log&&t.console.log(e)},c.Util.trimText=function(t){return function(e){return t?t.apply(e):((e||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),c.Util.asFloat=function(t){return parseFloat(t)},function(){var t=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,e=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;c.Util.parseTextShadows=function(i){if(!i||"none"===i)return[];for(var n=i.match(t),o=[],r=0;n&&r<n.length;r++){var s=n[r].match(e);o.push({color:s[0],offsetX:s[1]?s[1].replace("px",""):0,offsetY:s[2]?s[2].replace("px",""):0,blur:s[3]?s[3].replace("px",""):0})}return o}}(),c.Util.parseBackgroundImage=function(t){var e,i,n,o,r,s,a,h,l=" \r\n	",u=[],c=0,d=0,p=function(){e&&('"'===i.substr(0,1)&&(i=i.substr(1,i.length-2)),i&&h.push(i),"-"===e.substr(0,1)&&(o=e.indexOf("-",1)+1)>0&&(n=e.substr(0,o),e=e.substr(o)),u.push({prefix:n,method:e.toLowerCase(),value:r,args:h})),h=[],e=n=i=r=""};p();for(var f=0,m=t.length;m>f;f++)if(s=t[f],!(0===c&&l.indexOf(s)>-1)){switch(s){case'"':a?a===s&&(a=null):a=s;break;case"(":if(a)break;if(0===c){c=1,r+=s;continue}d++;break;case")":if(a)break;if(1===c){if(0===d){c=0,r+=s,p();continue}d--}break;case",":if(a)break;if(0===c){p();continue}if(1===c&&0===d&&!e.match(/^url$/i)){h.push(i),i="",r+=s;continue}}r+=s,0===c?e+=s:i+=s}return p(),u},c.Util.Bounds=function(t){var e,i={};return t.getBoundingClientRect&&(e=t.getBoundingClientRect(),i.top=Math.floor(e.top),i.bottom=Math.floor(e.bottom||e.top+e.height),i.left=Math.floor(e.left),i.width=Math.floor(t.offsetWidth),i.height=Math.floor(t.offsetHeight)),i},c.Util.OffsetBounds=function(t){var e=t.offsetParent?c.Util.OffsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},c.Util.getCSS=function(t,i,n){l!==t&&(u=e.defaultView.getComputedStyle(t,null));var s=u[i];if(/^background(Size|Position)$/.test(i))return r(s,t,i,n);if(/border(Top|Bottom)(Left|Right)Radius/.test(i)){var a=s.split(" ");return a.length<=1&&(a[1]=a[0]),a.map(o)}return s},c.Util.resizeBounds=function(t,e,i,n,o){var r,s,a=i/n,h=t/e;return o&&"auto"!==o?h>a^"contain"===o?(s=n,r=n*h):(r=i,s=i/h):(r=i,s=n),{width:r,height:s}},c.Util.BackgroundPosition=function(t,e,i,n,o){var r=s("backgroundPosition",t,e,i,n,o);return{left:r[0],top:r[1]}},c.Util.BackgroundSize=function(t,e,i,n){var o=s("backgroundSize",t,e,i,n);return{width:o[0],height:o[1]}},c.Util.Extend=function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},c.Util.Children=function(t){var e;try{e=t.nodeName&&"IFRAME"===t.nodeName.toUpperCase()?t.contentDocument||t.contentWindow.document:function(t){var e=[];return null!==t&&!function(t,e){var n=t.length,o=0;if("number"==typeof e.length)for(var r=e.length;r>o;o++)t[n++]=e[o];else for(;e[o]!==i;)t[n++]=e[o++];return t.length=n,t}(e,t),e}(t.childNodes)}catch(n){c.Util.log("html2canvas.Util.Children failed with exception: "+n.message),e=[]}return e},c.Util.isTransparent=function(t){return"transparent"===t||"rgba(0, 0, 0, 0)"===t},c.Util.Font=function(){var t={};return function(e,n,o){if(t[e+"-"+n]!==i)return t[e+"-"+n];var r,s,a,h=o.createElement("div"),l=o.createElement("img"),u=o.createElement("span"),c="Hidden Text";return h.style.visibility="hidden",h.style.fontFamily=e,h.style.fontSize=n,h.style.margin=0,h.style.padding=0,o.body.appendChild(h),l.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",l.width=1,l.height=1,l.style.margin=0,l.style.padding=0,l.style.verticalAlign="baseline",u.style.fontFamily=e,u.style.fontSize=n,u.style.margin=0,u.style.padding=0,u.appendChild(o.createTextNode(c)),h.appendChild(u),h.appendChild(l),r=l.offsetTop-u.offsetTop+1,h.removeChild(u),h.appendChild(o.createTextNode(c)),h.style.lineHeight="normal",l.style.verticalAlign="super",s=l.offsetTop-h.offsetTop+1,a={baseline:r,lineWidth:1,middle:s},t[e+"-"+n]=a,o.body.removeChild(h),a}}(),function(){function t(t){return function(e){try{t.addColorStop(e.stop,e.color)}catch(n){i.log(["failed to add color stop: ",n,"; tried to add: ",e])}}}var i=c.Util,n={};c.Generate=n;var o=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];n.parseGradient=function(t,e){var i,n,r,s,a,h,l,u,c,d,p,f,m=o.length;for(n=0;m>n&&!(r=t.match(o[n]));n+=1);if(r)switch(r[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(i={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},a=r[2].match(/\w+/g))for(h=a.length,n=0;h>n;n+=1)switch(a[n]){case"top":i.y0=0,i.y1=e.height;break;case"right":i.x0=e.width,i.x1=0;break;case"bottom":i.y0=e.height,i.y1=0;break;case"left":i.x0=0,i.x1=e.width}if(null===i.x0&&null===i.x1&&(i.x0=i.x1=e.width/2),null===i.y0&&null===i.y1&&(i.y0=i.y1=e.height/2),a=r[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(h=a.length,l=1/Math.max(h-1,1),n=0;h>n;n+=1)u=a[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),u[2]?(s=parseFloat(u[2]),s/="%"===u[3]?100:e.width):s=n*l,i.colorStops.push({color:u[1],stop:s});break;case"-webkit-gradient":if(i={type:"radial"===r[2]?"circle":r[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},a=r[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),a&&(i.x0=a[1]*e.width/100,i.y0=a[2]*e.height/100,i.x1=a[3]*e.width/100,i.y1=a[4]*e.height/100),a=r[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(h=a.length,n=0;h>n;n+=1)u=a[n].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),
s=parseFloat(u[2]),"from"===u[1]&&(s=0),"to"===u[1]&&(s=1),i.colorStops.push({color:u[3],stop:s});break;case"-moz-linear-gradient":if(i={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},a=r[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),a&&(i.x0=a[1]*e.width/100,i.y0=a[2]*e.height/100,i.x1=e.width-i.x0,i.y1=e.height-i.y0),a=r[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(h=a.length,l=1/Math.max(h-1,1),n=0;h>n;n+=1)u=a[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),u[2]?(s=parseFloat(u[2]),u[3]&&(s/=100)):s=n*l,i.colorStops.push({color:u[1],stop:s});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(i={type:"circle",x0:0,y0:0,x1:e.width,y1:e.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},a=r[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),a&&(i.cx=a[1]*e.width/100,i.cy=a[2]*e.height/100),a=r[3].match(/\w+/),u=r[4].match(/[a-z\-]*/),a&&u)switch(u[0]){case"farthest-corner":case"cover":case"":c=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.cy,2)),d=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.y1-i.cy,2)),p=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.y1-i.cy,2)),f=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.cy,2)),i.rx=i.ry=Math.max(c,d,p,f);break;case"closest-corner":c=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.cy,2)),d=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.y1-i.cy,2)),p=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.y1-i.cy,2)),f=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.cy,2)),i.rx=i.ry=Math.min(c,d,p,f);break;case"farthest-side":"circle"===a[0]?i.rx=i.ry=Math.max(i.cx,i.cy,i.x1-i.cx,i.y1-i.cy):(i.type=a[0],i.rx=Math.max(i.cx,i.x1-i.cx),i.ry=Math.max(i.cy,i.y1-i.cy));break;case"closest-side":case"contain":"circle"===a[0]?i.rx=i.ry=Math.min(i.cx,i.cy,i.x1-i.cx,i.y1-i.cy):(i.type=a[0],i.rx=Math.min(i.cx,i.x1-i.cx),i.ry=Math.min(i.cy,i.y1-i.cy))}if(a=r[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(h=a.length,l=1/Math.max(h-1,1),n=0;h>n;n+=1)u=a[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),u[2]?(s=parseFloat(u[2]),s/="%"===u[3]?100:e.width):s=n*l,i.colorStops.push({color:u[1],stop:s})}return i},n.Gradient=function(i,n){if(0!==n.width&&0!==n.height){var o,r,s=e.createElement("canvas"),a=s.getContext("2d");if(s.width=n.width,s.height=n.height,o=c.Generate.parseGradient(i,n))switch(o.type){case"linear":r=a.createLinearGradient(o.x0,o.y0,o.x1,o.y1),o.colorStops.forEach(t(r)),a.fillStyle=r,a.fillRect(0,0,n.width,n.height);break;case"circle":r=a.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.rx),o.colorStops.forEach(t(r)),a.fillStyle=r,a.fillRect(0,0,n.width,n.height);break;case"ellipse":var h=e.createElement("canvas"),l=h.getContext("2d"),u=Math.max(o.rx,o.ry),d=2*u;h.width=h.height=d,r=l.createRadialGradient(o.rx,o.ry,0,o.rx,o.ry,u),o.colorStops.forEach(t(r)),l.fillStyle=r,l.fillRect(0,0,d,d),a.fillStyle=o.colorStops[o.colorStops.length-1].color,a.fillRect(0,0,s.width,s.height),a.drawImage(h,o.cx-o.rx,o.cy-o.ry,2*o.rx,2*o.ry)}return s}},n.ListAlpha=function(t){var e,i="";do e=t%26,i=String.fromCharCode(e+64)+i,t/=26;while(26*t>26);return i},n.ListRoman=function(t){var e,i=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],n=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],o="",r=i.length;if(0>=t||t>=4e3)return t;for(e=0;r>e;e+=1)for(;t>=n[e];)t-=n[e],o+=i[e];return o}}(),c.Parse=function(n,o){function r(){return Math.max(Math.max(ut.body.scrollWidth,ut.documentElement.scrollWidth),Math.max(ut.body.offsetWidth,ut.documentElement.offsetWidth),Math.max(ut.body.clientWidth,ut.documentElement.clientWidth))}function s(){return Math.max(Math.max(ut.body.scrollHeight,ut.documentElement.scrollHeight),Math.max(ut.body.offsetHeight,ut.documentElement.offsetHeight),Math.max(ut.body.clientHeight,ut.documentElement.clientHeight))}function l(t,e){var i=parseInt(mt(t,e),10);return isNaN(i)?0:i}function u(t,e,i,n,o,r){"transparent"!==r&&(t.setVariable("fillStyle",r),t.fillRect(e,i,n,o),lt+=1)}function d(t,e,i){return t.length>0?e+i.toUpperCase():void 0}function p(t,e){switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,d);case"uppercase":return t.toUpperCase();default:return t}}function f(t){return/^(normal|none|0px)$/.test(t)}function m(t,e,i,n){null!==t&&ct.trimText(t).length>0&&(n.fillText(t,e,i),lt+=1)}function g(t,e,i,n){var o=!1,r=mt(e,"fontWeight"),s=mt(e,"fontFamily"),a=mt(e,"fontSize"),h=ct.parseTextShadows(mt(e,"textShadow"));switch(parseInt(r,10)){case 401:r="bold";break;case 400:r="normal"}return t.setVariable("fillStyle",n),t.setVariable("font",[mt(e,"fontStyle"),mt(e,"fontVariant"),r,a,s].join(" ")),t.setVariable("textAlign",o?"right":"left"),h.length&&(t.setVariable("shadowColor",h[0].color),t.setVariable("shadowOffsetX",h[0].offsetX),t.setVariable("shadowOffsetY",h[0].offsetY),t.setVariable("shadowBlur",h[0].blur)),"none"!==i?ct.Font(s,a,ut):void 0}function v(t,e,i,n,o){switch(e){case"underline":u(t,i.left,Math.round(i.top+n.baseline+n.lineWidth),i.width,1,o);break;case"overline":u(t,i.left,Math.round(i.top),i.width,1,o);break;case"line-through":u(t,i.left,Math.ceil(i.top+n.middle+n.lineWidth),i.width,1,o)}}function _(t,e,i,n,o){var r;if(dt.rangeBounds&&!o)("none"!==i||0!==ct.trimText(e).length)&&(r=y(e,t.node,t.textOffset)),t.textOffset+=e.length;else if(t.node&&"string"==typeof t.node.nodeValue){var s=n?t.node.splitText(e.length):null;r=w(t.node,o),t.node=s}return r}function y(t,e,i){var n=ut.createRange();return n.setStart(e,i),n.setEnd(e,i+t.length),n.getBoundingClientRect()}function w(t,e){var i=t.parentNode,n=ut.createElement("wrapper"),o=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),i.replaceChild(n,t);var r=e?ct.OffsetBounds(n):ct.Bounds(n);return i.replaceChild(o,n),r}function b(t,e,i){var n,r,s=i.ctx,a=mt(t,"color"),h=mt(t,"textDecoration"),l=mt(t,"textAlign"),u={node:e,textOffset:0};ct.trimText(e.nodeValue).length>0&&(e.nodeValue=p(e.nodeValue,mt(t,"textTransform")),l=l.replace(["-webkit-auto"],["auto"]),r=!o.letterRendering&&/^(left|right|justify|auto)$/.test(l)&&f(mt(t,"letterSpacing"))?e.nodeValue.split(/(\b| )/):e.nodeValue.split(""),n=g(s,t,h,a),o.chinese&&r.forEach(function(t,e){/.*[\u4E00-\u9FA5].*$/.test(t)&&(t=t.split(""),t.unshift(e,1),r.splice.apply(r,t))}),r.forEach(function(t,e){var o=_(u,t,h,e<r.length-1,i.transform.matrix);o&&(m(t,o.left,o.bottom,s),v(s,h,o,n,a))}))}function L(t,e){var i,n,o=ut.createElement("boundelement");return o.style.display="inline",i=t.style.listStyleType,t.style.listStyleType="none",o.appendChild(ut.createTextNode(e)),t.insertBefore(o,t.firstChild),n=ct.Bounds(o),t.removeChild(o),t.style.listStyleType=i,n}function x(t){var e=-1,i=1,n=t.parentNode.childNodes;if(t.parentNode){for(;n[++e]!==t;)1===n[e].nodeType&&i++;return i}return-1}function k(t,e){var i,n=x(t);switch(e){case"decimal":i=n;break;case"decimal-leading-zero":i=1===n.toString().length?n="0"+n.toString():n.toString();break;case"upper-roman":i=c.Generate.ListRoman(n);break;case"lower-roman":i=c.Generate.ListRoman(n).toLowerCase();break;case"lower-alpha":i=c.Generate.ListAlpha(n).toLowerCase();break;case"upper-alpha":i=c.Generate.ListAlpha(n)}return i+". "}function E(t,e,i){var n,o,r,s=e.ctx,a=mt(t,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(a)){if(o=k(t,a),r=L(t,o),g(s,t,"none",mt(t,"color")),"inside"!==mt(t,"listStylePosition"))return;s.setVariable("textAlign","left"),n=i.left,m(o,n,r.bottom,s)}}function P(t){var e=n[t];return e&&e.succeeded===!0?e.img:!1}function M(t,e){var i=Math.max(t.left,e.left),n=Math.max(t.top,e.top),o=Math.min(t.left+t.width,e.left+e.width),r=Math.min(t.top+t.height,e.top+e.height);return{left:i,top:n,width:o-i,height:r-n}}function C(t,e,i){var n,o="static"!==e.cssPosition,r=o?mt(t,"zIndex"):"auto",s=mt(t,"opacity"),a="none"!==mt(t,"cssFloat");e.zIndex=n=h(r),n.isPositioned=o,n.isFloated=a,n.opacity=s,n.ownStacking="auto"!==r||1>s,i&&i.zIndex.children.push(e)}function T(t,e,i,n,o){var r=l(e,"paddingLeft"),s=l(e,"paddingTop"),a=l(e,"paddingRight"),h=l(e,"paddingBottom");j(t,i,0,0,i.width,i.height,n.left+r+o[3].width,n.top+s+o[0].width,n.width-(o[1].width+o[3].width+r+a),n.height-(o[0].width+o[2].width+s+h))}function S(t){return["Top","Right","Bottom","Left"].map(function(e){return{width:l(t,"border"+e+"Width"),color:mt(t,"border"+e+"Color")}})}function D(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(e){return mt(t,"border"+e+"Radius")})}function O(t,e,i,n){var o=function(t,e,i){return{x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}};return{start:t,startControl:e,endControl:i,end:n,subdivide:function(r){var s=o(t,e,r),a=o(e,i,r),h=o(i,n,r),l=o(s,a,r),u=o(a,h,r),c=o(l,u,r);return[O(t,s,l,c),O(c,u,h,n)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,i.x,i.y,n.x,n.y])},curveToReversed:function(n){n.push(["bezierCurve",i.x,i.y,e.x,e.y,t.x,t.y])}}}function A(t,e,i,n,o,r,s){e[0]>0||e[1]>0?(t.push(["line",n[0].start.x,n[0].start.y]),n[0].curveTo(t),n[1].curveTo(t)):t.push(["line",r,s]),(i[0]>0||i[1]>0)&&t.push(["line",o[0].start.x,o[0].start.y])}function I(t,e,i,n,o,r,s){var a=[];return e[0]>0||e[1]>0?(a.push(["line",n[1].start.x,n[1].start.y]),n[1].curveTo(a)):a.push(["line",t.c1[0],t.c1[1]]),i[0]>0||i[1]>0?(a.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(a),a.push(["line",s[0].end.x,s[0].end.y]),s[0].curveToReversed(a)):(a.push(["line",t.c2[0],t.c2[1]]),a.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(a.push(["line",o[1].end.x,o[1].end.y]),o[1].curveToReversed(a)):a.push(["line",t.c4[0],t.c4[1]]),a}function R(t,e,i){var n=t.left,o=t.top,r=t.width,s=t.height,a=e[0][0],h=e[0][1],l=e[1][0],u=e[1][1],c=e[2][0],d=e[2][1],p=e[3][0],f=e[3][1],m=r-l,g=s-d,v=r-c,_=s-f;return{topLeftOuter:_t(n,o,a,h).topLeft.subdivide(.5),topLeftInner:_t(n+i[3].width,o+i[0].width,Math.max(0,a-i[3].width),Math.max(0,h-i[0].width)).topLeft.subdivide(.5),topRightOuter:_t(n+m,o,l,u).topRight.subdivide(.5),topRightInner:_t(n+Math.min(m,r+i[3].width),o+i[0].width,m>r+i[3].width?0:l-i[3].width,u-i[0].width).topRight.subdivide(.5),bottomRightOuter:_t(n+v,o+g,c,d).bottomRight.subdivide(.5),bottomRightInner:_t(n+Math.min(v,r+i[3].width),o+Math.min(g,s+i[0].width),Math.max(0,c-i[1].width),Math.max(0,d-i[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:_t(n,o+_,p,f).bottomLeft.subdivide(.5),bottomLeftInner:_t(n+i[3].width,o+_,Math.max(0,p-i[3].width),Math.max(0,f-i[2].width)).bottomLeft.subdivide(.5)}}function z(t,e,i,n,o){var r=mt(t,"backgroundClip"),s=[];switch(r){case"content-box":case"padding-box":A(s,n[0],n[1],e.topLeftInner,e.topRightInner,o.left+i[3].width,o.top+i[0].width),A(s,n[1],n[2],e.topRightInner,e.bottomRightInner,o.left+o.width-i[1].width,o.top+i[0].width),A(s,n[2],n[3],e.bottomRightInner,e.bottomLeftInner,o.left+o.width-i[1].width,o.top+o.height-i[2].width),A(s,n[3],n[0],e.bottomLeftInner,e.topLeftInner,o.left+i[3].width,o.top+o.height-i[2].width);break;default:A(s,n[0],n[1],e.topLeftOuter,e.topRightOuter,o.left,o.top),A(s,n[1],n[2],e.topRightOuter,e.bottomRightOuter,o.left+o.width,o.top),A(s,n[2],n[3],e.bottomRightOuter,e.bottomLeftOuter,o.left+o.width,o.top+o.height),A(s,n[3],n[0],e.bottomLeftOuter,e.topLeftOuter,o.left,o.top+o.height)}return s}function U(t,e,i){var n,o,r,s,a,h,l=e.left,u=e.top,c=e.width,d=e.height,p=D(t),f=R(e,p,i),m={clip:z(t,f,i,p,e),borders:[]};for(n=0;4>n;n++)if(i[n].width>0){switch(o=l,r=u,s=c,a=d-i[2].width,n){case 0:a=i[0].width,h=I({c1:[o,r],c2:[o+s,r],c3:[o+s-i[1].width,r+a],c4:[o+i[3].width,r+a]},p[0],p[1],f.topLeftOuter,f.topLeftInner,f.topRightOuter,f.topRightInner);break;case 1:o=l+c-i[1].width,s=i[1].width,h=I({c1:[o+s,r],c2:[o+s,r+a+i[2].width],c3:[o,r+a],c4:[o,r+i[0].width]},p[1],p[2],f.topRightOuter,f.topRightInner,f.bottomRightOuter,f.bottomRightInner);break;case 2:r=r+d-i[2].width,a=i[2].width,h=I({c1:[o+s,r+a],c2:[o,r+a],c3:[o+i[3].width,r],c4:[o+s-i[3].width,r]},p[2],p[3],f.bottomRightOuter,f.bottomRightInner,f.bottomLeftOuter,f.bottomLeftInner);break;case 3:s=i[3].width,h=I({c1:[o,r+a+i[2].width],c2:[o,r],c3:[o+s,r+i[0].width],c4:[o+s,r+a]},p[3],p[0],f.bottomLeftOuter,f.bottomLeftInner,f.topLeftOuter,f.topLeftInner)}m.borders.push({args:h,color:i[n].color})}return m}function B(t,e){var i=t.drawShape();return e.forEach(function(t,e){i[0===e?"moveTo":t[0]+"To"].apply(null,t.slice(1))}),i}function N(t,e,i){"transparent"!==i&&(t.setVariable("fillStyle",i),B(t,e),t.fill(),lt+=1)}function F(t,e,i){var n,o,r=ut.createElement("valuewrap"),s=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];s.forEach(function(e){try{r.style[e]=mt(t,e)}catch(i){ct.log("html2canvas: Parse: Exception caught in renderFormValue: "+i.message)}}),r.style.borderColor="black",r.style.borderStyle="solid",r.style.display="block",r.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(t.type)||"SELECT"===t.nodeName)&&(r.style.lineHeight=mt(t,"height")),r.style.top=e.top+"px",r.style.left=e.left+"px",n="SELECT"===t.nodeName?(t.options[t.selectedIndex]||0).text:t.value,n||(n=t.placeholder),o=ut.createTextNode(n),r.appendChild(o),ft.appendChild(r),b(t,o,i),ft.removeChild(r)}function j(t){t.drawImage.apply(t,Array.prototype.slice.call(arguments,1)),lt+=1}function Z(i,n){var o=t.getComputedStyle(i,n);if(o&&o.content&&"none"!==o.content&&"-moz-alt-content"!==o.content&&"none"!==o.display){var r=o.content+"",s=r.substr(0,1);s===r.substr(r.length-1)&&s.match(/'|"/)&&(r=r.substr(1,r.length-2));var a="url"===r.substr(0,3),h=e.createElement(a?"img":"span");return h.className=gt+"-before "+gt+"-after",Object.keys(o).filter(H).forEach(function(t){try{h.style[t]=o[t]}catch(e){ct.log(["Tried to assign readonly property ",t,"Error:",e])}}),a?h.src=ct.parseBackgroundImage(r)[0].args[0]:h.innerHTML=r,h}}function H(e){return isNaN(t.parseInt(e,10))}function V(t,e){var i=Z(t,":before"),n=Z(t,":after");(i||n)&&(i&&(t.className+=" "+gt+"-before",t.parentNode.insertBefore(i,t),rt(i,e,!0),t.parentNode.removeChild(i),t.className=t.className.replace(gt+"-before","").trim()),n&&(t.className+=" "+gt+"-after",t.appendChild(n),rt(n,e,!0),t.removeChild(n),t.className=t.className.replace(gt+"-after","").trim()))}function W(t,e,i,n){var o=Math.round(n.left+i.left),r=Math.round(n.top+i.top);t.createPattern(e),t.translate(o,r),t.fill(),t.translate(-o,-r)}function G(t,e,i,n,o,r,s,a){var h=[];h.push(["line",Math.round(o),Math.round(r)]),h.push(["line",Math.round(o+s),Math.round(r)]),h.push(["line",Math.round(o+s),Math.round(a+r)]),h.push(["line",Math.round(o),Math.round(a+r)]),B(t,h),t.save(),t.clip(),W(t,e,i,n),t.restore()}function q(t,e,i){u(t,e.left,e.top,e.width,e.height,i)}function Y(t,e,i,n,o){var r=ct.BackgroundSize(t,e,n,o),s=ct.BackgroundPosition(t,e,n,o,r),a=mt(t,"backgroundRepeat").split(",").map(ct.trimText);switch(n=$(n,r),a=a[o]||a[0]){case"repeat-x":G(i,n,s,e,e.left,e.top+s.top,99999,n.height);break;case"repeat-y":G(i,n,s,e,e.left+s.left,e.top,n.width,99999);break;case"no-repeat":G(i,n,s,e,e.left+s.left,e.top+s.top,n.width,n.height);break;default:W(i,n,s,{top:e.top,left:e.left,width:n.width,height:n.height})}}function J(t,e,i){for(var n,o=mt(t,"backgroundImage"),r=ct.parseBackgroundImage(o),s=r.length;s--;)if(o=r[s],o.args&&0!==o.args.length){var a="url"===o.method?o.args[0]:o.value;n=P(a),n?Y(t,e,i,n,s):ct.log("html2canvas: Error loading background:",o)}}function $(t,e){if(t.width===e.width&&t.height===e.height)return t;var i,n=ut.createElement("canvas");return n.width=e.width,n.height=e.height,i=n.getContext("2d"),j(i,t,0,0,t.width,t.height,0,0,e.width,e.height),n}function K(t,e,i){return t.setVariable("globalAlpha",mt(e,"opacity")*(i?i.opacity:1))}function Q(t){return t.replace("px","")}function X(t,e){var i=mt(t,"transform")||mt(t,"-webkit-transform")||mt(t,"-moz-transform")||mt(t,"-ms-transform")||mt(t,"-o-transform"),n=mt(t,"transform-origin")||mt(t,"-webkit-transform-origin")||mt(t,"-moz-transform-origin")||mt(t,"-ms-transform-origin")||mt(t,"-o-transform-origin")||"0px 0px";n=n.split(" ").map(Q).map(ct.asFloat);var o;if(i&&"none"!==i){var r=i.match(yt);if(r)switch(r[1]){case"matrix":o=r[2].split(",").map(ct.trimText).map(ct.asFloat)}}return{origin:n,matrix:o}}function tt(t,e,i,n){var h=a(e?i.width:r(),e?i.height:s()),l={ctx:h,opacity:K(h,t,e),cssPosition:mt(t,"position"),borders:S(t),transform:n,clip:e&&e.clip?ct.Extend({},e.clip):null};return C(t,l,e),o.useOverflow===!0&&/(hidden|scroll|auto)/.test(mt(t,"overflow"))===!0&&/(BODY)/i.test(t.nodeName)===!1&&(l.clip=l.clip?M(l.clip,i):i),l}function et(t,e,i){var n={left:e.left+t[3].width,top:e.top+t[0].width,width:e.width-(t[1].width+t[3].width),height:e.height-(t[0].width+t[2].width)};return i&&(n=M(n,i)),n}function it(t,e){var i=e.matrix?ct.OffsetBounds(t):ct.Bounds(t);return e.origin[0]+=i.left,e.origin[1]+=i.top,i}function nt(t,e,i,n){var o,r=X(t,e),s=it(t,r),a=tt(t,e,s,r),h=a.borders,l=a.ctx,u=et(h,s,a.clip),c=U(t,s,h),d=pt.test(t.nodeName)?"#efefef":mt(t,"backgroundColor");switch(B(l,c.clip),l.save(),l.clip(),u.height>0&&u.width>0&&!n?(q(l,s,d),J(t,u,l)):n&&(a.backgroundColor=d),l.restore(),c.borders.forEach(function(t){N(l,t.args,t.color)}),i||V(t,a),t.nodeName){case"IMG":(o=P(t.getAttribute("src")))?T(l,t,o,s,h):ct.log("html2canvas: Error loading <img>:"+t.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(t.type)&&(t.value||t.placeholder||"").length>0&&F(t,s,a);break;case"TEXTAREA":(t.value||t.placeholder||"").length>0&&F(t,s,a);break;case"SELECT":(t.options||t.placeholder||"").length>0&&F(t,s,a);break;case"LI":E(t,a,u);break;case"CANVAS":T(l,t,t,s,h)}return a}function ot(t){return"none"!==mt(t,"display")&&"hidden"!==mt(t,"visibility")&&!t.hasAttribute("data-html2canvas-ignore")}function rt(t,e,i){ot(t)&&(e=nt(t,e,i,!1)||e,pt.test(t.nodeName)||st(t,e,i))}function st(t,e,i){ct.Children(t).forEach(function(n){n.nodeType===n.ELEMENT_NODE?rt(n,e,i):n.nodeType===n.TEXT_NODE&&b(t,n,e)})}function at(){var t=mt(e.documentElement,"backgroundColor"),i=ct.isTransparent(t)&&ht===e.body,n=nt(ht,null,!1,i);return st(ht,n),i&&(t=n.backgroundColor),ft.removeChild(vt),{backgroundColor:t,stack:n}}t.scroll(0,0);var ht=o.elements===i?e.body:o.elements[0],lt=0,ut=ht.ownerDocument,ct=c.Util,dt=ct.Support(o,ut),pt=new RegExp("("+o.ignoreElements+")"),ft=ut.body,mt=ct.getCSS,gt="___html2canvas___pseudoelement",vt=ut.createElement("style");vt.innerHTML="."+gt+'-before:before { content: "" !important; display: none !important; }.'+gt+'-after:after { content: "" !important; display: none !important; }',ft.appendChild(vt),n=n||{};var _t=function(t){return function(e,i,n,o){var r=n*t,s=o*t,a=e+n,h=i+o;return{topLeft:O({x:e,y:h},{x:e,y:h-s},{x:a-r,y:i},{x:a,y:i}),topRight:O({x:e,y:i},{x:e+r,y:i},{x:a,y:h-s},{x:a,y:h}),bottomRight:O({x:a,y:i},{x:a,y:i+s},{x:e+r,y:h},{x:e,y:h}),bottomLeft:O({x:a,y:h},{x:a-r,y:h},{x:e,y:i+s},{x:e,y:i})}}}(4*((Math.sqrt(2)-1)/3)),yt=/(matrix)\((.+)\)/;return at()},c.Preload=function(n){function o(t){P.href=t,P.href=P.href;var e=P.protocol+P.host;return e===m}function r(){w.log("html2canvas: start: images: "+y.numLoaded+" / "+y.numTotal+" (failed: "+y.numFailed+")"),!y.firstRun&&y.numLoaded>=y.numTotal&&(w.log("Finished loading images: # "+y.numTotal+" (failed: "+y.numFailed+")"),"function"==typeof n.complete&&n.complete(y))}function s(e,o,s){var a,h,l=n.proxy;P.href=e,e=P.href,a="html2canvas_"+b++,s.callbackname=a,l+=l.indexOf("?")>-1?"&":"?",l+="url="+encodeURIComponent(e)+"&callback="+a,h=x.createElement("script"),t[a]=function(e){"error:"===e.substring(0,6)?(s.succeeded=!1,y.numLoaded++,y.numFailed++,r()):(f(o,s),o.src=e),t[a]=i;try{delete t[a]}catch(n){}h.parentNode.removeChild(h),h=null,delete s.script,delete s.callbackname},h.setAttribute("type","text/javascript"),h.setAttribute("src",l),s.script=h,t.document.body.appendChild(h)}function a(e,i){var n=t.getComputedStyle(e,i),o=n.content;"url"===o.substr(0,3)&&g.loadImage(c.Util.parseBackgroundImage(o)[0].args[0]),d(n.backgroundImage,e)}function h(t){a(t,":before"),a(t,":after")}function l(t,e){var n=c.Generate.Gradient(t,e);n!==i&&(y[t]={img:n,succeeded:!0},y.numTotal++,y.numLoaded++,r())}function u(t){return t&&t.method&&t.args&&t.args.length>0}function d(t,e){var n;c.Util.parseBackgroundImage(t).filter(u).forEach(function(t){"url"===t.method?g.loadImage(t.args[0]):t.method.match(/\-?gradient$/)&&(n===i&&(n=c.Util.Bounds(e)),l(t.value,n))})}function p(t){var e=!1;try{w.Children(t).forEach(p)}catch(n){}try{e=t.nodeType}catch(o){e=!1,w.log("html2canvas: failed to access some element's nodeType - Exception: "+o.message)}if(1===e||e===i){h(t);try{d(w.getCSS(t,"backgroundImage"),t)}catch(n){w.log("html2canvas: failed to get background-image - Exception: "+n.message)}d(t)}}function f(e,o){e.onload=function(){o.timer!==i&&t.clearTimeout(o.timer),y.numLoaded++,o.succeeded=!0,e.onerror=e.onload=null,r()},e.onerror=function(){if("anonymous"===e.crossOrigin&&(t.clearTimeout(o.timer),n.proxy)){var i=e.src;return e=new Image,o.img=e,e.src=i,void s(e.src,e,o)}y.numLoaded++,y.numFailed++,o.succeeded=!1,e.onerror=e.onload=null,r()}}var m,g,v,_,y={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},w=c.Util,b=0,L=n.elements[0]||e.body,x=L.ownerDocument,k=L.getElementsByTagName("img"),E=k.length,P=x.createElement("a"),M=function(t){return t.crossOrigin!==i}(new Image);for(P.href=t.location.href,m=P.protocol+P.host,g={loadImage:function(t){var e,r;t&&y[t]===i&&(e=new Image,t.match(/data:image\/.*;base64,/i)?(e.src=t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),r=y[t]={img:e},y.numTotal++,f(e,r)):o(t)||n.allowTaint===!0?(r=y[t]={img:e},y.numTotal++,f(e,r),e.src=t):M&&!n.allowTaint&&n.useCORS?(e.crossOrigin="anonymous",r=y[t]={img:e},y.numTotal++,f(e,r),e.src=t):n.proxy&&(r=y[t]={img:e},y.numTotal++,s(t,e,r)))},cleanupDOM:function(o){var s,a;if(!y.cleanupDone){o&&"string"==typeof o?w.log("html2canvas: Cleanup because: "+o):w.log("html2canvas: Cleanup after timeout: "+n.timeout+" ms.");for(a in y)if(y.hasOwnProperty(a)&&(s=y[a],"object"==typeof s&&s.callbackname&&s.succeeded===i)){t[s.callbackname]=i;try{delete t[s.callbackname]}catch(h){}s.script&&s.script.parentNode&&(s.script.setAttribute("src","about:blank"),s.script.parentNode.removeChild(s.script)),y.numLoaded++,y.numFailed++,w.log("html2canvas: Cleaned up failed img: '"+a+"' Steps: "+y.numLoaded+" / "+y.numTotal)}t.stop!==i?t.stop():e.execCommand!==i&&e.execCommand("Stop",!1),e.close!==i&&e.close(),y.cleanupDone=!0,o&&"string"==typeof o||r()}},renderingDone:function(){_&&t.clearTimeout(_)}},n.timeout>0&&(_=t.setTimeout(g.cleanupDOM,n.timeout)),w.log("html2canvas: Preload starts: finding background-images"),y.firstRun=!0,p(L),w.log("html2canvas: Preload: Finding images"),v=0;E>v;v+=1)g.loadImage(k[v].getAttribute("src"));return y.firstRun=!1,w.log("html2canvas: Preload: Done."),y.numTotal===y.numLoaded&&r(),g},c.Renderer=function(t,n){function o(t){function e(t){Object.keys(t).sort().forEach(function(i){var n=[],r=[],s=[],a=[];t[i].forEach(function(t){t.node.zIndex.isPositioned||t.node.zIndex.opacity<1?s.push(t):t.node.zIndex.isFloated?r.push(t):n.push(t)}),function h(t){t.forEach(function(t){a.push(t),t.children&&h(t.children)})}(n.concat(r,s)),a.forEach(function(t){t.context?e(t.context):o.push(t.node)})})}var n,o=[];return n=function(t){function e(t,n,o){var r="auto"===n.zIndex.zindex?0:Number(n.zIndex.zindex),s=t,a=n.zIndex.isPositioned,h=n.zIndex.isFloated,l={node:n},u=o;n.zIndex.ownStacking?(s=l.context={"!":[{node:n,children:[]}]},u=i):(a||h)&&(u=l.children=[]),0===r&&o?o.push(l):(t[r]||(t[r]=[]),t[r].push(l)),n.zIndex.children.forEach(function(t){e(s,t,u)})}var n={};return e(n,t),n}(t),e(n),o}function r(t){var e;if("string"==typeof n.renderer&&c.Renderer[t]!==i)e=c.Renderer[t](n);else{if("function"!=typeof t)throw new Error("Unknown renderer");e=t(n)}if("function"!=typeof e)throw new Error("Invalid renderer defined");return e}return r(n.renderer)(t,n,e,o(t.stack),c)},c.Util.Support=function(t,e){function n(){var t=new Image,n=e.createElement("canvas"),o=n.getContext===i?!1:n.getContext("2d");if(o===!1)return!1;n.width=n.height=10,t.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{o.drawImage(t,0,0),n.toDataURL()}catch(r){return!1}return c.Util.log("html2canvas: Parse: SVG powered rendering available"),!0}function o(){var t,i,n,o,r=!1;return e.createRange&&(t=e.createRange(),t.getBoundingClientRect&&(i=e.createElement("boundtest"),i.style.height="123px",i.style.display="block",e.body.appendChild(i),t.selectNode(i),n=t.getBoundingClientRect(),o=n.height,123===o&&(r=!0),e.body.removeChild(i))),r}return{rangeBounds:o(),svgRendering:t.svgRendering&&n()}},t.html2canvas=function(e,i){e=e.length?e:[e];var n,o,r={logging:!1,elements:e,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return r=c.Util.Extend(i,r),c.logging=r.logging,r.complete=function(t){("function"!=typeof r.onpreloaded||r.onpreloaded(t)!==!1)&&(n=c.Parse(t,r),("function"!=typeof r.onparsed||r.onparsed(n)!==!1)&&(o=c.Renderer(n,r),"function"==typeof r.onrendered&&r.onrendered(o)))},t.setTimeout(function(){c.Preload(r)},0),{render:function(t,e){return c.Renderer(t,c.Util.Extend(e,r))},parse:function(t,e){return c.Parse(t,c.Util.Extend(e,r))},preload:function(t){return c.Preload(c.Util.Extend(t,r))},log:c.Util.log}},t.html2canvas.log=c.Util.log,t.html2canvas.Renderer={Canvas:i},c.Renderer.Canvas=function(t){function n(t,e){t.beginPath(),e.forEach(function(e){t[e.name].apply(t,e.arguments)}),t.closePath()}function o(t){if(-1===a.indexOf(t.arguments[0].src)){l.drawImage(t.arguments[0],0,0);try{l.getImageData(0,0,1,1)}catch(e){return h=s.createElement("canvas"),l=h.getContext("2d"),!1}a.push(t.arguments[0].src)}return!0}function r(e,i){switch(i.type){case"variable":e[i.name]=i.arguments;break;case"function":switch(i.name){case"createPattern":if(i.arguments[0].width>0&&i.arguments[0].height>0)try{e.fillStyle=e.createPattern(i.arguments[0],"repeat")}catch(r){u.log("html2canvas: Renderer: Error creating pattern",r.message)}break;case"drawShape":n(e,i.arguments);break;case"drawImage":i.arguments[8]>0&&i.arguments[7]>0&&(!t.taintTest||t.taintTest&&o(i))&&e.drawImage.apply(e,i.arguments);break;default:e[i.name].apply(e,i.arguments)}}}t=t||{};var s=e,a=[],h=e.createElement("canvas"),l=h.getContext("2d"),u=c.Util,d=t.canvas||s.createElement("canvas");return function(t,e,n,o,s){var a,h,l,c=d.getContext("2d"),p=t.stack;return d.width=d.style.width=e.width||p.ctx.width,d.height=d.style.height=e.height||p.ctx.height,l=c.fillStyle,c.fillStyle=u.isTransparent(p.backgroundColor)&&e.background!==i?e.background:t.backgroundColor,c.fillRect(0,0,d.width,d.height),c.fillStyle=l,o.forEach(function(t){c.textBaseline="bottom",c.save(),t.transform.matrix&&(c.translate(t.transform.origin[0],t.transform.origin[1]),c.transform.apply(c,t.transform.matrix),c.translate(-t.transform.origin[0],-t.transform.origin[1])),t.clip&&(c.beginPath(),c.rect(t.clip.left,t.clip.top,t.clip.width,t.clip.height),c.clip()),t.ctx.storage&&t.ctx.storage.forEach(function(t){r(c,t)}),c.restore()}),u.log("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),1===e.elements.length&&"object"==typeof e.elements[0]&&"BODY"!==e.elements[0].nodeName?(h=s.Util.Bounds(e.elements[0]),a=n.createElement("canvas"),a.width=Math.ceil(h.width),a.height=Math.ceil(h.height),c=a.getContext("2d"),c.drawImage(d,h.left,h.top,h.width,h.height,0,0,h.width,h.height),d=null,a):d}}}(window,document),function(){"use strict";var t=function(t){this.options=this.extend({template:' <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">  <div class="locator {{ (noGenerate.controlsOpen) ? \'controls-open\' : \'controls-closed\' }} {{ options.superClass }}">  <section class="locator-display">  <div class="locator-map-wrapper">  <div class="locator-display-inner">  <div class="locator-map">  <div class="locator-map-attribution {{#options.embedAttribution}}enabled{{/}}">  {{#options.overrideAttribution}}  {{{ options.overrideAttribution }}}  {{/}}  {{^options.overrideAttribution}}  {{{ options.tilesets[options.tileset].attribution }}}  {{/}}  </div>  </div>   <div class="locator-map-help">  Move the marker by dragging the base.   {{#options.drawing}}  Use the buttons to draw shapes on the map.  {{/drawing}}   {{#(options.tilesets[options.tileset] && options.tilesets[options.tileset].attribution)}}  Required attribution for this map: <br>  <span class="attribution">{{{ options.tilesets[options.tileset].attribution }}}</span>  {{/()}}  </div>  </div>  </div>  </section>    <section class="locator-controls">  <div class="minor-controls">  <div class="toggle-controls" on-tap="toggle:\'noGenerate.controlsOpen\'"></div>   <button class="minor-button minor-generate" on-tap="generate" title="Generate"><i class="fa fa-download"></i></button>  </div>   <div class="locator-controls-wrapper">  <header>{{{ options.title }}}</header>   <div class="locator-input">  <div class="locator-history">  <button class="small inline action undo" disabled="{{ !canUndo }}" title="Undo" on-tap="undo"><i class="fa fa-rotate-left"></i></button>  <button class="small inline action redo" disabled="{{ !canRedo }}" title="Redo" on-tap="redo"><i class="fa fa-rotate-right"></i></button>  <button class="small inline destructive reset" title="Reset all options" on-tap="resetOptions"><i class="fa fa-refresh"></i></button>  </div>   {{^options.geocoder}}  <div class="config-option">  <label>Latitude and longitude location</label>   <br><input type="number" placeholder="Latitude" value="{{ options.lat }}" lazy>  <br><input type="number" placeholder="Longitude" value="{{ options.lng }}" lazy>  </div>  {{/options.geocoder}}   {{#options.geocoder}}  <div class="config-option">  <label>Search location by address</label>  <input type="text" placeholder="Address or place" value="{{ geocodeInput }}" lazy disabled="{{ isGeocoding }}">  </div>  {{/options.geocoder}}   <div class="markers {{^options.markers}}no-markers{{/}}">  <label class="no-markers-label">Markers</label>  <button class="add-marker action small inline" on-tap="add-marker" title="Add marker at center of map"><i class="fa fa-plus"></i></button>   <label class="markers-label">Markers.</label>  <div class="help">Use <code>&lt;br&gt;</code> to make line breaks.</div>   {{#options.markers:mi}}  <div class="marker" intro-outro="slide">  <div class="config-option">  <input type="text" placeholder="Marker label" value="{{ this.text }}" lazy>  </div>   <div class="marker-actions">  {{#options.markerToCenter}}  <button class="action small" on-tap="marker-to-center:{{ mi }}" title="Move marker to center of map"><i class="fa fa-compass"></i></button>  {{/}}   {{#options.centerToMarker}}  <button class="action small" on-tap="center-to-marker:{{ mi }}" title="Center map on marker"><i class="fa fa-plus-square-o"></i></button>  {{/}}   {{#(_.size(options.markerBackgrounds) > 1)}}  <div class="color-picker" title="Set marker background color">  {{#options.markerBackgrounds:bi}}  <div class="color-picker-item {{#(options.markers[mi] && options.markers[mi].background === this)}}active{{ else }}inactive{{/()}} {{#(this.indexOf(\'255, 255, 255\') !== -1 || this.indexOf(\'FFFFFF\') !== -1)}}is-white{{/()}}"  style="background-color: {{ this }}"  on-tap="setMarker:{{ mi }},\'background\',{{ this }}">  {{/}}  </div>  {{/}}   {{#(_.size(options.markerForegrounds) > 1)}}  <div class="color-picker" title="Set marker foreground color">  {{#options.markerForegrounds:bi}}  <div class="color-picker-item {{#(options.markers[mi] && options.markers[mi].foreground === this)}}active{{ else }}inactive{{/()}} {{#(this.indexOf(\'255, 255, 255\') !== -1 || this.indexOf(\'FFFFFF\') !== -1)}}is-white{{/()}}"  style="background-color: {{ this }}"  on-tap="setMarker:{{ mi }},\'foreground\',{{ this }}">  {{/}}  </div>  {{/}}   <button class="destructive small" on-tap="remove-marker:{{ mi }}" title="Remove marker"><i class="fa fa-close"></i></button>  </div>  </div>  {{/}}  </div>   {{#options.drawing}}  <div class="drawing">  <label class="markers-label">Drawing</label>  <div class="help">Use the buttons on the map to draw shapes.</div>   <div class="drawing-section">  <div class="drawing-option">  <input type="checkbox" checked="{{ options.drawingStyles.stroke }}" id="drawing-styles-stroke" lazy>  <label for="drawing-styles-stroke">Stroke</label>  </div>   {{#(_.size(options.drawingStrokes) > 1 && options.drawingStyles.stroke)}}  <div class="color-picker" title="Set drawing stroke color">  {{#options.drawingStrokes:di}}  <div class="color-picker-item {{#(options.drawingStyles.color === this)}}active{{ else }}inactive{{/()}} {{#(this.indexOf(\'255, 255, 255\') !== -1 || this.indexOf(\'FFFFFF\') !== -1)}}is-white{{/()}}"  style="background-color: {{ this }}"  on-tap="setDrawing:\'color\',{{ this }}">  {{/}}  </div>  {{/}}  </div>   <div class="drawing-section">  <div class="drawing-option">  <input type="checkbox" checked="{{ options.drawingStyles.fill }}" id="drawing-styles-fill" lazy>  <label for="drawing-styles-fill">Fill</label>  </div>   {{#(_.size(options.drawingStrokes) > 1 && options.drawingStyles.fill)}}  <div class="color-picker" title="Set drawing fill color">  {{#options.drawingFills:di}}  <div class="color-picker-item {{#(options.drawingStyles.fillColor === this)}}active{{ else }}inactive{{/()}} {{#(this.indexOf(\'255, 255, 255\') !== -1 || this.indexOf(\'FFFFFF\') !== -1)}}is-white{{/()}}"  style="background-color: {{ this }}"  on-tap="setDrawing:\'fillColor\',{{ this }}">  {{/}}  </div>  {{/}}  </div>  </div>  {{/options.drawing}}   {{#(_.size(options.tilesets) > 1)}}  <div class="config-option">  <label>Background map set</label>   <div class="image-picker images-{{ _.size(options.tilesets) }}">  {{#options.tilesets:i}}  <div class="image-picker-item {{ (options.tileset === i) ? \'active\' : \'inactive\' }}" style="background-image: url({{= preview }});" title="{{ i }}" on-tap="set:\'options.tileset\',{{ i }}"></div>  {{/options.tilesets}}  </div>  </div>  {{/()}}   {{#(_.size(options.widths) > 1)}}  <div class="config-option config-select">  <label>Map width</label>   <select value="{{ options.width }}">  {{#options.widths:i}}  <option value="{{ i }}">{{ i }}</option>  {{/options.widths}}  </select>  </div>  {{/()}}   {{#(_.size(options.ratios) > 1)}}  <div class="config-option config-select">  <label>Map aspect ratio</label>   <select value="{{ options.ratio }}">  {{#options.ratios:i}}  <option value="{{ i }}">{{ i }}</option>  {{/options.ratios}}  </select>  </div>  {{/()}}   <div class="config-option">  <label>Mini-map zoom</label>   <input type="range" min="-10" max="1" value="{{ options.miniZoomOffset }}" title="Adjust zoom level for map">  </div>   <div class="config-option">  <input type="checkbox" checked="{{ options.embedAttribution }}" id="config-embed-attribution" lazy>  <label for="config-embed-attribution">Embed attribution</label>   <input type="text" placeholder="Override attribution" value="{{ options.overrideAttribution }}" lazy>  </div>   <div class="config-action">  <button class="large additive generate-image" on-tap="generate">Generate <i class="fa fa-download"></i></button>  </div>   <div class="preview">  <h1>Preview</h1>  <img src="" /><br>  <a href="" class="download-link">Download</a>  </div>  </div>   <footer>  {{{ options.footer }}}  </footer>  </div>  </section> </div> ',
title:"Locator",footer:'Made by the <a href="//datanews.tumblr.com/" target="_blank">WNYC DataNews</a> team.  Locator only works in <a href="//google.com/chrome" target="_blank">Chrome</a> at the moment.  See how to <a href="//github.com/datanews/locator/" target="_blank">deploy Locator</a> for yourself or your organization.',tilesets:{"CartoDB Positron":{url:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a target="_blank" href="http://cartodb.com/attributions">CartoDB</a>'},"Stamen Toner":{url:"http://tile.stamen.com/toner/{z}/{x}/{y}.png",attribution:'Map tiles by <a target="_blank" href="http://stamen.com">Stamen Design</a>, under <a  target="_blank" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a  target="_blank" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_blank" href="http://www.openstreetmap.org/copyright">ODbL</a>'},"Mapbox Streets (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.np44bm6o/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>"},"Mapbox Satellite (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.oee0fah0/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>; &copy; <a target='_blank' href='https://www.digitalglobe.com/'>DigitalGlobe</a>"},"Mapbox Run, Bike, Hike (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.oee1c53c/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>"}},tileset:"CartoDB Positron",zoom:17,minZoom:1,maxZoom:18,lat:40.74844,lng:-73.98566,embedAttribution:!1,overrideAttribution:void 0,miniWidth:"15w",miniHeight:"15w",miniZoomOffset:-6,miniExtentStyles:{fill:!1,stroke:!0,color:"#000000",opacity:.9,weight:1.5},miniStyles:{backgroundColor:"#FFFFFF",padding:3,shadow:!0,shadowColor:"rgba(0, 0, 0, 0.65)",shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1},markers:[{text:"Empire State Building",lat:40.74844,lng:-73.98566}],markerDefaults:{text:"",background:"rgba(0, 0, 0, 0.9)",foreground:"rgba(255, 255, 255, 0.9)",radius:5,fontSize:16,font:'"Open Sans", Helvetica, Arial, sans-serif',labelDistance:20,labelWidth:3,padding:10},markerBackgrounds:["rgba(0, 0, 0, 0.9)","rgba(255, 255, 255, 0.9)","rgba(88, 88, 88, 0.9)","rgba(200, 200, 200, 0.9)","rgba(51, 102, 255, 0.9)","rgba(255, 51, 204, 0.9)","rgba(0, 245, 61, 0.9)","rgba(245, 0, 61, 0.9)","rgba(184, 0, 245, 0.9)"],markerForegrounds:["rgba(0, 0, 0, 0.9)","rgba(255, 255, 255, 0.9)"],draggableMarker:L.icon({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wwLFSU1meAbBQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAACOUlEQVR42u3bP0sjQRjH8W8S/wYVFEFR1LOxMaSxsrKQlPcaBH1bCvcSvMrCQhAsbE5FwcZ/hVUQQcQ7CLheMSPYqjOzzyS/DyzpdnZ/u5k8s/sERERERERERERERERERERERERERERExJCKkeOoA7PAFDANjABjQD/QAZ791vbbPfDS6wH2AfPAug/rsx6AI+AWeO2lAKtAA2gF3Oc+cAEU3R7gOLAZad9vwC/gsVsDbAHNBONcA7vdFuAGMJnwYj0B2ykGqiUYYwuYSDxVDPl59iT3ADdKCO/dIPADOM81wBawWHKZNuqDvItZUsT6tW1iwwowl1OA1Yilylf9zCnAhsEl6zCwlkOAfYFXGCE1cwhwHrsGYoQYOsB1bFu1HGCdrz1VSaluOcBZ7KsCC1YDnCIPy1YDnM4kwCWrAY7Qg0IGONaD5xx0Z/2ZBFixGmAnkwDfrAb4nEmAhQLs0juwnUmAVwrwey6tBnifyfx3YzXAF1y7hWV/TReVuF4Vy46tB3hrOLwOcGo9wFdco49FZ+bXhd5F6ForgH/AYS4BFrguKUv2Yu041ov1R1yXlAV/Ys7N1YgHvovrkipTGziIOUAtwdVv4PpTypj3dmIPkqK97QTXJTWa+M7bSTFQLdEJnfu7cCbRnPc71ZVK3SM9h2v0GY70ld1LXcyX9TeHNVybxUCgFcZZrDrPaoDvmrh2i/onK4LCPxg4jrE8yynAjxZwL72XPpRYFb+qKfznFe553g0iAvwHgeJXccwK1poAAAAASUVORK5CYII=",iconSize:[80,80],iconAnchor:[40,55],popupAnchor:[-75,0]}),drawing:!0,drawingStyles:{fill:!1,stroke:!0,color:"#00B8F5",opacity:.9,weight:5,fillOpacity:.3},geojson:!1,drawingStrokes:["#00B8F5","#F5003D","#F500B8","#F5B800","#00F53D","#FFFFFF","#000000"],drawingFills:["#00B8F5","#F5003D","#F500B8","#F5B800","#00F53D","#FFFFFF","#000000"],widths:{Small:400,Medium:600,Large:800},width:"Medium",ratios:{"1:1":1,"4:3":4/3,"16:9":16/9},ratio:"4:3",controlsOpen:!0,centerToMarker:!0,markerToCenter:!0,geocoder:this.defaultGeocoder,superClass:void 0},t),this.id=_.uniqueId("locator-"),this.el=this.options.el,this.updateOptions(),this.originalOptions=this.clone(this.options),this.options=this.load(this.options),this.history=[],this.historyIndex=0,this.save(!0),this.throttledDrawMaps=_.throttle(_.bind(this.drawMaps,this),500),_.isFunction(this.options.geocoder)&&(this.throttledGeocoder=_.throttle(_.bind(this.options.geocoder,this),500)),this.drawInterface()};_.extend(t.prototype,{drawInterface:function(){var t={controlsOpen:this.options.controlsOpen};this["interface"]=new Ractive({el:this.options.el,template:this.options.template,data:{options:this.options,noGenerate:t,isGeocoding:!1,geocodeInput:"",_:_}}),this["interface"].observe("options",_.bind(function(){this.ignoreObservers||(this.updateOptions(),this["interface"].update(),this.save(!this.ignoreHistory),this.ignoreHistory=!1,this.throttledDrawMaps())},this),{init:!1}),this["interface"].observe("geocodeInput",_.bind(function(t){_.isFunction(this.throttledGeocoder)&&this.throttledGeocoder(t,_.bind(function(t,e){t&&e&&(this.set("options.lat",t),this.set("options.lng",e))},this))},this),{init:!1}),this["interface"].on("undo",_.bind(function(){this.ignoreHistory=!0,this.undo(),this.set("options",this.options)},this)),this["interface"].on("redo",_.bind(function(){this.ignoreHistory=!0,this.redo(),this.set("options",this.options)},this)),this["interface"].on("generate",_.bind(this.generate,this)),this["interface"].on("resetOptions",_.bind(function(){this.reset(),this.set("options",this.options)},this)),this["interface"].on("toggle",_.bind(function(t,e){this.set(e,!this.get(e))},this)),this["interface"].on("set",_.bind(function(t,e,i){this.set(e,i)},this)),this["interface"].on("setMarker",_.bind(function(t,e,i,n){var o=this.get("options.markers."+e);o&&this.set("options.markers."+e+"."+i,n)},this)),this["interface"].on("setDrawing",_.bind(function(t,e,i){this.set("options.drawingStyles."+e,i)},this)),this["interface"].on("marker-to-center",_.bind(function(t,e){var i=this.map.getCenter(),n={};n["options.markers."+e+".lat"]=i.lat,n["options.markers."+e+".lng"]=i.lng,this.set(n)},this)),this["interface"].on("center-to-marker",_.bind(function(t,e){var i=this.get("options.markers."+e);i&&this.set({"options.lat":i.lat,"options.lng":i.lng})},this)),this["interface"].on("remove-marker",_.bind(function(t,e){this.options.markers.splice(e,1)},this)),this["interface"].on("add-marker",_.bind(function(){var t=this.map.getCenter(),e={lat:t.lat,lng:t.lng};this.get("options.markers").push(this.updateMarker(e))},this)),this.drawMaps()},set:function(t,e){this["interface"]&&this["interface"].set(t,e)},get:function(t){return this["interface"]?this["interface"].get(t):void 0},drawMaps:function(){this.drawMap(),this.drawGeoJSON(),this.drawMarkers(),this.drawMinimap(),this.drawDrawingLayer(),this.fixMapVerticalAlign()},updateOptions:function(){var t=this.options;return t=this.alterOptions("preDraw",this.options),_.each(t.markers,_.bind(function(e,i){t.markers[i]=this.updateMarker(t.markers[i])},this)),t.tilesets=this.parseTilesets(t.tilesets),t.drawingStylesInvisible=_.clone(t.drawingStyles),t.drawingStylesInvisible.opacity=0,t.drawingStylesInvisible.fillOpacity=0,t},alterOptions:function(t,e){return _.isFunction(this.options[t])?_.bind(this.options[t],this)(e):e},drawMap:function(t){t=_.isUndefined(t)?!0:t;var e,i,n,o=this.getEl(".locator-map");o.id=this.id+"-map",n=[this.options.lat,this.options.lng,this.options.zoom],this.map&&!t?(n[0]=this.map.getCenter().lat,n[1]=this.map.getCenter().lng,n[2]=this.map.getZoom(),this.map.remove()):this.map&&this.map.remove(),e=_.size(this.options.widths)?this.options.widths[this.options.width]:_.isNumber(this.options.width)?this.options.width:o.getBoundingClientRect().width,i=_.size(this.options.ratios)?e/this.options.ratios[this.options.ratio]:_.isNumber(this.options.ratio)?e/this.options.ratio:o.getBoundingClientRect().height,o.style.width=e+"px",o.style.height=i+"px",this.map=new L.Map(o.id,{minZoom:this.options.minZoom,maxZoom:this.options.maxZoom,attributionControl:!1}),this.map.setView([n[0],n[1]],n[2]),this.mapLayer=new L.TileLayer(this.options.tilesets[this.options.tileset].url,{zIndex:-100}),this.map.addLayer(this.mapLayer),this.map.on("moveend",_.bind(function(){var t=this.map.getCenter();this.isDrawing||this.set({"options.lat":t.lat,"options.lng":t.lng,"options.zoom":this.map.getZoom()})},this))},getGeoJSON:function(){var t=[];return this.drawLayer.eachLayer(function(e){e&&e.toGeoJSON&&t.push(e.toGeoJSON())}),this.options.geojson={type:"FeatureCollection",features:t},this.geojsonCanvasLayer&&this["interface"].update(),this.options.geojson},setGeoJSON:function(){this.drawLayer&&this.options.geojson&&(this.drawLayer.clearLayers(),L.geoJson(this.options.geojson,{style:_.clone(this.options.drawingStylesInvisible)}).eachLayer(_.bind(function(t){t.addTo(this.drawLayer)},this)))},drawDrawingLayer:function(){this.options.drawing&&(this.drawLayer=new L.FeatureGroup,this.map.addLayer(this.drawLayer),this.mapDraw=new L.Control.Draw({draw:{marker:!1,circle:!1,polyline:{metric:"en-us"!==navigator.language&&"en-US"!==navigator.language,shapeOptions:_.clone(this.options.drawingStyles)},polygon:{metric:"en-us"!==navigator.language&&"en-US"!==navigator.language,shapeOptions:_.clone(this.options.drawingStyles)},rectangle:{metric:"en-us"!==navigator.language&&"en-US"!==navigator.language,shapeOptions:_.clone(this.options.drawingStyles)}},edit:{featureGroup:this.drawLayer,edit:{selectedPathOptions:_.clone(this.options.drawingStyles)}}}),this.map.addControl(this.mapDraw),this.setGeoJSON(),this.map.on("draw:created",_.bind(function(t){t.layer.setStyle(_.clone(this.options.drawingStylesInvisible)),this.drawLayer.addLayer(t.layer),this.getGeoJSON()},this)),this.map.on("draw:edited",_.bind(this.getGeoJSON,this)),this.map.on("draw:deleted",_.bind(this.getGeoJSON,this)),this.map.on("draw:drawstart",_.bind(function(){this.isDrawing=!0},this)),this.map.on("draw:drawstop",_.bind(function(){this.isDrawing=!1},this)),this.map.on("draw:editstart",_.bind(function(){this.isDrawing=!0},this)),this.map.on("draw:editstop",_.bind(function(){this.isDrawing=!1},this)),this.map.on("draw:deletestart",_.bind(function(){this.isDrawing=!0},this)),this.map.on("draw:deletestop",_.bind(function(){this.isDrawing=!1},this)))},drawGeoJSON:function(){return this.geojsonCanvasLayer=L.tileLayer.canvas(),this.options.geojson?(this.geojsonCanvasLayer.drawTile=_.bind(this.drawGeoJSONTile,this),void this.map.addLayer(this.geojsonCanvasLayer)):this.geojsonCanvasLayer},drawMinimap:function(){var t,e=this.getEl(".locator-map").getBoundingClientRect().width,i=this.getEl(".locator-map").getBoundingClientRect().height,n=_.isNumber(this.options.miniWidth)?this.options.miniWidth:-1!==this.options.miniWidth.indexOf("w")?+this.options.miniWidth.replace("w","")/100*e:+this.options.miniWidth.replace("h","")/100*i,o=_.isNumber(this.options.miniHeight)?this.options.miniHeight:-1!==this.options.miniHeight.indexOf("w")?+this.options.miniHeight.replace("w","")/100*e:+this.options.miniHeight.replace("h","")/100*i;this.minimapLayer=new L.TileLayer(this.options.tilesets[this.options.tileset].url),this.miniMap=new L.Control.MiniMap(this.minimapLayer,{width:n,height:o,zoomLevelOffset:this.options.miniZoomOffset,aimingRectOptions:{fill:!1,stroke:!1}}),this.map.addControl(this.miniMap),this.miniMap._miniMap.addLayer(this.drawMiniCanvasLayer(this.options.miniExtentStyles)),t=this.getEl(".locator-map .leaflet-control-minimap"),_.each(this.miniStylesToCSS(this.options.miniStyles),function(e,i){t.style[i]=e})},drawMiniCanvasLayer:function(t){return this.miniCanvasLayer=L.tileLayer.canvas(),this.miniCanvasLayer.drawTile=_.bind(function(e,i,n){var o=e.getContext("2d");o.clearRect(0,0,e.width,e.height);var r={};r.nwPoint=i.multiplyBy(256),r.sePoint=r.nwPoint.add(new L.Point(256,256)),r.nwCoord=this.map.unproject(r.nwPoint,n,!0),r.seCoord=this.map.unproject(r.sePoint,n,!0),r.bCoord=L.latLngBounds([[r.nwCoord.lat,r.seCoord.lng],[r.seCoord.lat,r.nwCoord.lng]]),r.bPoint=[r.nwPoint,r.sePoint];var s=this.map.getBounds(),a=this.map.project(s.getNorthWest(),n,!0),h=this.map.project(s.getSouthEast(),n,!0);o.beginPath(),o.rect(a.x-r.nwPoint.x,a.y-r.nwPoint.y,h.x-a.x,h.y-a.y),o=this.leafletStylesToCanvas(t,o),o.closePath()},this),this.map.on("moveend",_.bind(function(){this.miniCanvasLayer.redraw()},this)),this.miniCanvasLayer},updateMarker:function(t){return _.extend(_.clone(this.options.markerDefaults),t)},drawMarkers:function(){this.markerCanvas&&this.map&&this.markerCanvas._map&&this.map.removeLayer(this.markerCanvas),this.markerCanvas=L.tileLayer.canvas(),this.markerCanvas.drawTile=_.bind(this.drawMarkerTile,this),this.markerCanvas.addTo(this.map),_.each(this.options.markers,_.bind(function(t,e){this.draggableMarker(this.options.markers[e],e)},this))},draggableMarker:function(t,e){this.draggableMarkers=this.draggableMarkers||{};var i=this.draggableMarkers[e];i&&this.map&&i._map&&(i.clearAllEventListeners(),this.map.removeLayer(i)),this.draggableMarkers[e]=i=L.marker(L.latLng(t.lat,t.lng),{icon:this.options.draggableMarker,draggable:!0,opacity:0,title:"Drag marker here"}).addTo(this.map),i.on("mouseover",function(t){i.isDragging||t.target.setOpacity(.3)}),i.on("mouseout",function(t){i.isDragging||t.target.setOpacity(0)}),i.on("dragstart",function(t){i.isDragging=!0,t.target.setOpacity(1)}),i.on("dragend",_.bind(function(e){i.isDragging=!1,e.target.setOpacity(0);var n=e.target.getLatLng();t.lat=n.lat,t.lng=n.lng,this["interface"].update("options.markers")},this))},drawMarkerTile:function(t,e,i){var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),_.each(this.options.markers,_.bind(function(n){this.drawMarker(n,t,e,i)},this))},drawMarker:function(t,e,i,n){var o,r,s,a=e.getContext("2d"),h=t.text.split("<br>");h=_.map(h,function(t){return t.trim()});var l=h.length,u=1.25,c=t.fontSize*u*l+2*t.padding,d={};d.nwPoint=i.multiplyBy(256),d.sePoint=d.nwPoint.add(new L.Point(256,256)),d.nwCoord=this.map.unproject(d.nwPoint,n,!0),d.seCoord=this.map.unproject(d.sePoint,n,!0),d.bCoord=L.latLngBounds([[d.nwCoord.lat,d.seCoord.lng],[d.seCoord.lat,d.nwCoord.lng]]),d.bPoint=[d.nwPoint,d.sePoint],d.locCoord=L.latLng(t.lat,t.lng),d.locPoint=this.map.project(d.locCoord,n,!0),o={x:d.locPoint.x-d.nwPoint.x,y:d.locPoint.y-d.nwPoint.y},a.beginPath(),a.translate(o.x-t.radius,o.y-t.radius),a.fillStyle=t.background,a.fillRect(0,0,2*t.radius,2*t.radius),a.setTransform(1,0,0,1,0,0),a.closePath(),a.beginPath(),a.translate(o.x-t.labelWidth/2,o.y-t.radius-t.labelDistance),a.fillStyle=t.background,a.fillRect(0,0,t.labelWidth,t.labelDistance),a.setTransform(1,0,0,1,0,0),a.closePath(),a.beginPath(),a.font=t.fontSize+"px "+t.font,a.fillStyle=t.foreground,a.textAlign="center",r=_.max(h,function(t){return a.measureText(t).width}),r=a.measureText(r).width,s=r+2*t.padding,a.closePath(),a.beginPath(),a.translate(o.x-s/2,o.y-t.radius-t.labelDistance-c),a.fillStyle=t.background,a.fillRect(0,0,s,c),a.setTransform(1,0,0,1,0,0),a.closePath(),_.each(h,_.bind(function(e,i){var n=1;a.beginPath(),a.translate(o.x,o.y-t.radius-t.labelDistance-c+t.padding+n+t.fontSize*u*i),a.font=t.fontSize+"px "+t.font,a.fillStyle=t.foreground,a.textAlign="center",a.textBaseline="top",a.fillText(e,0,0),a.setTransform(1,0,0,1,0,0),a.closePath()},this))},drawGeoJSONTile:function(t,e,i){var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);var o={};o.nwPoint=e.multiplyBy(256),o.sePoint=o.nwPoint.add(new L.Point(256,256)),o.nwCoord=this.map.unproject(o.nwPoint,i,!0),o.seCoord=this.map.unproject(o.sePoint,i,!0),o.bCoord=L.latLngBounds([[o.nwCoord.lat,o.seCoord.lng],[o.seCoord.lat,o.nwCoord.lng]]),o.bPoint=[o.nwPoint,o.sePoint],_.each(this.options.geojson.features,_.bind(function(t){var e=_.clone(this.options.drawingStyles);"Polygon"===t.geometry.type?(n.beginPath(),_.each(t.geometry.coordinates,_.bind(function(t){_.each(t,_.bind(function(t,e){var r=this.map.project([t[1],t[0]],i,!0);0===e?n.moveTo(r.x-o.nwPoint.x,r.y-o.nwPoint.y):n.lineTo(r.x-o.nwPoint.x,r.y-o.nwPoint.y)},this)),n.closePath(),n=this.leafletStylesToCanvas(e,n)},this))):"LineString"===t.geometry.type&&(e.fill=!1,n.beginPath(),_.each(t.geometry.coordinates,_.bind(function(t,r){var s=this.map.project([t[1],t[0]],i,!0);0===r?n.moveTo(s.x-o.nwPoint.x,s.y-o.nwPoint.y):n.lineTo(s.x-o.nwPoint.x,s.y-o.nwPoint.y),n=this.leafletStylesToCanvas(e,n)},this)))},this))},generate:function(){this.getEl(".locator-map .leaflet-control-zoom").style.display="none",this.getEl(".locator-map .leaflet-control-minimap").style.display="none",this.options.drawing&&(this.getEl(".locator-map .leaflet-draw").style.display="none"),_.delay(_.bind(function(){html2canvas(this.getEl(".locator-map"),{useCORS:!0,onrendered:_.bind(function(t){this.getEl(".locator-map .leaflet-control-zoom").style.display="block",this.getEl(".locator-map .leaflet-control-minimap").style.display="block",this.options.drawing&&(this.getEl(".locator-map .leaflet-draw").style.display="block"),html2canvas(this.getEl(".locator-map .leaflet-control-minimap"),{useCORS:!0,onrendered:_.bind(function(e){var i=this.drawCanvasMiniMap(t,e);this.preview(i),this["export"](i)},this)})},this)})},this),300)},drawCanvasMiniMap:function(t,e){var i=t.getContext("2d"),n=this.getEl(".locator-map .leaflet-control-minimap"),o=n.getBoundingClientRect().width,r=n.getBoundingClientRect().height,s=this.options.miniStyles,a=10,h=10;return i.beginPath(),i.fillStyle=s.backgroundColor,s.shadow&&(i.shadowColor=s.shadowColor,i.shadowBlur=s.shadowBlur,i.shadowOffsetX=s.shadowOffsetX,i.shadowOffsetY=s.shadowOffsetY),i.fillRect(i.canvas.width-a-o-2*s.padding,i.canvas.height-h-r-2*s.padding,o+2*s.padding,r+2*s.padding),i.closePath(),i.beginPath(),i.shadowColor=0,i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0,i.drawImage(e,i.canvas.width-a-o-s.padding,i.canvas.height-h-r-s.padding,o,r),i.closePath(),i},preview:function(t){this.getEl(".preview img").src=t.canvas.toDataURL()},"export":function(t){var e=this.options.markers&&this.options.markers[0]?this.options.markers[0].text:"",i=this.getEl(".download-link");i.href=t.canvas.toDataURL(),i.download=this.makeID(e)+".png",i.click()},getEl:function(t){return document.querySelector(this.el+" "+t)},miniStylesToCSS:function(t){var e={"background-color":t.backgroundColor,border:t.padding+"px solid "+t.backgroundColor};return t.shadow&&(e["box-shadow"]=t.shadowOffsetX+"px "+t.shadowOffsetY+"px "+t.shadowBlur+"px "+t.shadowColor),e},leafletStylesToCanvas:function(t,e){return t.fill&&(e.globalAlpha=_.isUndefined(t.fillOpacity)?1:t.fillOpacity,e.fillStyle=t.fillColor||t.color,e.fill(t.fillRule||"evenodd")),t.stroke&&0!==t.weight&&(e.globalAlpha=_.isUndefined(t.opacity)?1:t.opacity,e.strokeStyle=t.color,e.lineCap=t.lineCap||"round",e.lineJoin=t.lineJoin||"round",e.lineWidth=t.weight,e.stroke()),e},save:function(t){var e=this.clone(this.options);delete e.draggableMarker,delete e.template,_.each(e,function(t,i){_.isFunction(t)&&delete e[i]}),window.localStorage.setItem("options",JSON.stringify(e)),t&&(this.historyIndex>=0&&this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.push(this.clone(e)),this.historyIndex=this.history.length-1,this.canDo())},load:function(t){var e=window.localStorage.getItem("options");return e?(e=JSON.parse(e),this.extend(t,e)):t},reset:function(){this.options=this.extend(this.options,this.clone(this.originalOptions))},undo:function(){this.historyIndex>0&&(this.historyIndex=this.historyIndex-1,this.options=this.extend(this.options,this.clone(this.history[this.historyIndex]))),this.canDo()},redo:function(){this.historyIndex<this.history.length-1&&(this.historyIndex=this.historyIndex+1,this.options=this.extend(this.options,this.clone(this.history[this.historyIndex]))),this.canDo()},canDo:function(){this.set({canUndo:this.historyIndex>0,canRedo:this.historyIndex<this.history.length-1})},defaultGeocoder:function(t,e){var i=new XMLHttpRequest,n="https://maps.googleapis.com/maps/api/geocode/json?address="+encodeURIComponent(t),o=_.once(e);i.onreadystatechange=function(){var t;200===i.status&&i.responseText&&(t=JSON.parse(i.responseText),t&&t.results&&t.results.length&&o(t.results[0].geometry.location.lat,t.results[0].geometry.location.lng))},i.open("GET",n),i.send()},parseTilesets:function(t){return _.each(t,function(e,i){_.isString(e)&&(t[i]={url:e}),t[i].preview||(t[i].preview=t[i].url.replace("{s}","a").replace("{x}","301").replace("{y}","385").replace("{z}","10"))}),t},makeID:function(t){return t=t?t.toString():"",t=t.toLowerCase().trim().replace(/\W+/g,"-"),t=t?t:"locator",_.uniqueId(t+"-")},overflowed:function(t,e){return e?"y"===e?t.scrollHeight>t.clientHeight:"x"===e?t.scrollWidth>t.clientWidth:!1:t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth},fixMapVerticalAlign:function(){var t=this.getEl(".locator-display");this.overflowed(t,"y")?t.classList.add("overflowed-y"):t.classList.remove("overflowed-y")},extend:function(t,e){return _.isObject(t)||_.isObject(e)?(_.each(e,_.bind(function(i,n){e[n]&&e[n].constructor&&e[n].constructor===Object?(t[n]=t[n]||{},this.extend(t[n],e[n])):_.isArray(e[n])?(t[n]=[],_.each(e[n],_.bind(function(i,o){t[n][o]=this.extend(e[n][o])},this))):t[n]=e[n]},this)),t):t?t:e},clone:function(t){if(!t)return t;var e,i=[Number,String,Boolean],n=this;return i.forEach(function(i){t instanceof i&&(e=i(t))}),"undefined"==typeof e&&("[object Array]"===Object.prototype.toString.call(t)?(e=[],t.forEach(function(t,i){e[i]=n.clone(t)})):"object"==typeof t?t.nodeType&&"function"==typeof t.cloneNode?e=t.cloneNode(!0):t.prototype?e=t:t instanceof Date?e=new Date(t):(e={},_.each(t,function(i,o){e[o]=n.clone(t[o])})):e=t),e}}),window.Locator=t}();